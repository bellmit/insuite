var countTo=angular.module("countTo",[]).directive("countTo",["$timeout",function(a){return{replace:!1,scope:!0,link:function(b,c,d){var e,f,g,h,i,j,k,l=c[0],m=function(){f=30,i=0,b.timoutId=null,j=parseInt(d.countTo)||0,b.value=parseInt(d.value,10)||0,g=1e3*parseFloat(d.duration)||0,h=Math.ceil(g/f),k=(j-b.value)/h,e=b.value},n=function(){b.timoutId=a(function(){e+=k,i++,i>=h?(a.cancel(b.timoutId),e=j,l.textContent=j):(l.textContent=Math.round(e),n())},f)},o=function(){b.timoutId&&a.cancel(b.timoutId),m(),n()};return d.$observe("countTo",function(a){a&&o()}),d.$observe("value",function(a){o()}),!0}}}]);window.FileReader||(window.FileReader=function(){},FileReader=function(){},alert("Leider unterstützt Ihr Browser nicht die nötige Funktionalität!Bitte verwenden sie einen anderen Browser!")),void 0===FileReader.prototype.readAsBinaryString&&(FileReader.prototype.isSimulated=!0),angular.module("kvdttoasvApp",["mgo-angular-wizard","LocalStorageModule","checklist-model","indexedDB","oc.lazyLoad","angular-svg-round-progressbar","countTo"]).config(["$routeProvider","$httpProvider","$indexedDBProvider",function(a,b,c){b.defaults.useXDomain=!0,delete b.defaults.headers.common["X-Requested-With"],c.connection("asvSendDB").upgradeDatabase(1,function(a,b,c){var d=b.createObjectStore("asvData",{keyPath:"id",autoIncrement:!0});d.createIndex("abrech_ik_idx","abrech_ik",{unique:!1}),d.createIndex("dav_ik_idx","dav_ik",{unique:!1}),d.createIndex("email_idx","email",{unique:!1}),d.createIndex("ik_idx","ik",{unique:!1}),d.createIndex("kasse_idx","kasse",{unique:!1}),d.createIndex("name_idx","name",{unique:!1}),d.createIndex("zert_ik_idx","zert_ik",{unique:!1}),d=b.createObjectStore("asvSendData",{keyPath:"asvData_id"}),d.createIndex("asvData_id_idx","asvData_id",{unique:!0})}),a.when("/asv/kvdttoasv",{templateUrl:"views/asv/kvdttoasv.html",controller:"KvdtToAsvCtrl",controllerAs:"KvdtToAsvCtrl"}).when("/asv/rsa-login",{templateUrl:"views/rsa-login.html",controller:"RsaLoginCtrl"}).when("/asv/consultancycontract",{templateUrl:"views/asv/consultancycontract.html",controller:"ConsultancyContractCtrl",controllerAs:"consultancycontract"}).when("/asv/contactform",{templateUrl:"views/asv/contactform.html",controller:"ContactFormCtrl",controllerAs:"contactform"}).when("/asv/login",{templateUrl:"views/asv/asv-login.html",controller:"ASVLoginCtrl",controllerAs:"asvLogin"}).when("/asv/user",{templateUrl:"views/user.html",controller:"UserCtrl",controllerAs:"user"}).when("/asv/errorDecrypt",{templateUrl:"views/asv/errorDecrypt.html",controller:"ErrordecryptCtrl",controllerAs:"errorDecryptCtrl"}).when("/asv/accounting",{templateUrl:"views/asv/accounting.html",controller:"AsvaccountingCtrl",controllerAs:"asvAccCtrl"}).when("/asv/",{templateUrl:"views/asv/asv-login.html",controller:"ASVLoginCtrl",controllerAs:"asvLogin"}).when("/asv/test-registry",{templateUrl:"views/asv/test-registry.html",controller:"ASVtestRegistryCtrl",controllerAs:"user"}).when("/asv/:docCirrusCon/:docCirrusUser",{templateUrl:"views/asv/asv-login.html",controller:"ASVLoginCtrl",controllerAs:"asvLogin"})}]).factory("certResource",["$resource","$location","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}},e={method:"GET",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}};return a(c.apiBase+"/de/api/index/kvCert",null,{update:d,query:e})}]).factory("ebmResource",["$resource","$location","config",function(a,b,c){var d={method:"GET",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}};return a(c.apiBase+"/de/api/index/ebmData",null,{query:d})}]).factory("gopResource",["$resource","$location","config",function(a,b,c){var d={method:"GET",isArray:!1,ignoreLoadingBar:!0,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}};return a(c.apiBase+"/de/api/index/gopData/type/:type",{type:"@type"},{query:d})}]).factory("lfdnrResource",["$resource","$location","config",function(a,b,c){var d={method:"GET",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}};return a(c.apiBase+"/de/api/index/asvLfdnr",null,{query:d})}]).factory("asvAccoundingStatusResource",["$resource","$location","config",function(a,b,c){var d={method:"PUT",ignoreLoadingBar:!0,isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}},e={method:"GET",ignoreLoadingBar:!0,isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}};return a(c.apiBase+"/de/api/index/asvAccoundingStatus",null,{query:e,update:d})}]).factory("providerResource",["$resource","$location","config",function(a,b,c){var d={method:"GET",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}};return a(c.apiBase+"/de/api/index/dataProvider",null,{query:d})}]).factory("sendAsvResource",["$resource","$location","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}},e={method:"GET",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}},f={method:"POST",isArray:!1,interceptor:{responseError:function(a){403===a.status&&b.path("/asv/login")}}};return a(c.apiBase+"/de/api/index/sendAsv",null,{update:d,query:e,post:f})}]),function(){var a=function(a,b){a.factory("httpInterceptor",["$q","$injector",function(a,b){return{response:function(b){return b||a.when(b)},responseError:function(c){return 401===c.status||403===c.status?(b.get("notify")({message:"Zugangsdaten nicht gültig oder Session abgelaufen.",position:"right",duration:"5000",classes:"alert-danger"}),b.get("AuthenticationService").ClearCredentials(),b.get("$location").path("/asv/login")):b.get("notify")({message:c.data.message,position:"right",duration:"5000",classes:"alert-danger"}),a.reject(c)}}}]),b.interceptors.push("httpInterceptor")};a.$inject=["$provide","$httpProvider"],angular.module("kvdttoasvApp").config(a)}(),window.onerror=function(a,b,c,d,e){alert(c)},Storage.prototype.setObj=function(a,b){return this.setItem(a,JSON.stringify(b))},Storage.prototype.getObj=function(a){return JSON.parse(this.getItem(a))},angular.module("frontendApp",["config","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","cgNotify","angular-loading-bar","angucomplete-alt","angularMoment","ngTable","smart-table","Authentication","ngDialog","mm.iban","kvdttoasvApp","frontendApp.errorData.controller","frontendApp.DocumentCtrl.controller"]).config(["$routeProvider","$locationProvider","cfpLoadingBarProvider","config","$provide",function(a,b,c,d,e){c.spinnerTemplate='<div class="modalLoadingBg modal-backdrop fade in" style="display: block;"><div class="loader">';for(var f=1;16>=f;f++)c.spinnerTemplate+='<span class="block-'+f+'"></span>';-1!==window.location.origin.indexOf("testprcs")&&e.constant(d,angular.extend(d,{apiBase:"https://dev3.sanakey-contract.de"})),c.spinnerTemplate+="</div></div>",a.when("/",{templateUrl:"views/init.html",controller:"InitCtrl",controllerAs:"init"}).when("/goae/login",{templateUrl:"views/goae-login.html",controller:"GOAELoginCtrl",controllerAs:"goaeLogin"}).when("/main",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/rsa-login",{templateUrl:"views/rsa-login.html",controller:"RsaLoginCtrl"}).when("/user",{templateUrl:"views/user.html",controller:"UserCtrl",controllerAs:"user"}).when("/user/:errorEdit",{templateUrl:"views/user.html",controller:"UserCtrl",controllerAs:"user"}).when("/patient",{templateUrl:"views/patient.html",controller:"PatientCtrl",controllerAs:"patCtrl"}).when("/addpatient",{templateUrl:"views/patientform.html",controller:"PatientformCtrl",controllerAs:"patientForm"}).when("/document",{templateUrl:"views/document.html",controller:"DocumentCtrl",controllerAs:"docCtrl"}).when("/patient/:patientId",{templateUrl:"views/patientform.html",controller:"PatientformCtrl",controllerAs:"patientForm"}).when("/patient/:patientId/:errorEdit",{templateUrl:"views/patientform.html",controller:"PatientformCtrl",controllerAs:"patientForm"}).when("/accounting",{templateUrl:"views/accounting.html",controller:"AccountingCtrl",controllerAs:"accountingCtrl"}).otherwise({redirectTo:"/login"}),b.html5Mode(!0)}]).run(["amMoment","$rootScope","$window","$location",function(a,b,c,d){a.changeLocale("de"),c.ga("create","UA-90437541-2","auto"),c.ga("set","anonymizeIp",!0),c.ga("send","pageview"),b.$on("$stateChangeSuccess",function(a){c.ga("send","pageview",d.path())})}]).factory("userResource",["$resource","$location","config","$injector",function(a,b,c,d){var e=function(a){403===a.status&&(1===parseInt(sessionStorage.getItem("loginModul"))?(d.get("AuthenticationService").ClearCredentials(),b.path("/asv/login")):(d.get("AuthenticationService").ClearCredentials(),b.path("/login")))},f={method:"PUT",isArray:!1,interceptor:{responseError:e}};return a(c.apiBase+"/de/api/index/user",null,{update:f,query:{method:"GET",isArray:!1,interceptor:{responseError:e}}})}]).factory("patientResource",["$resource","AuthenticationService","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:b.responseError},e={method:"GET",isArray:!1,interceptor:b.responseError};return a(c.apiBase+"/de/api/index/patient",null,{update:d,query:e})}]).factory("diagnoseResource",["$resource","AuthenticationService","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:b.responseError};return a(c.apiBase+"/de/api/index/diagnose",null,{update:d,query:{method:"GET",isArray:!0}})}]).factory("activityResource",["$resource","AuthenticationService","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:b.responseError};return a(c.apiBase+"/de/api/index/activitydata",null,{update:d,query:{method:"GET",isArray:!0}})}]).factory("zipResource",["$resource","AuthenticationService","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:b.responseError};return a(c.apiBase+"/de/api/index/zip",null,{update:d,query:{method:"GET",isArray:!1}})}]).factory("accountingResource",["$resource","AuthenticationService","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:b.responseError},e={method:"GET",isArray:!1,interceptor:b.responseError};return a(c.apiBase+"/de/api/index/accountingdata",null,{update:d,query:e})}]).factory("errorSuccsessResource",["$resource","AuthenticationService","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:b.responseError};return a(c.apiBase+"/de/api/index/errorSuccess",null,{update:d})}]).factory("authResource",["$resource","$location","config",function(a,b,c){var d={method:"PUT",isArray:!1,interceptor:{responseError:function(a){403===a.status&&(1===parseInt(sessionStorage.getItem("loginModul"))?b.path("/asv/login"):console.log("authResource"))}}};return a(c.apiBase+"/de/api/index/auth",null,{update:d,query:{method:"GET",isArray:!1}})}]).factory("sendIvResource",["$resource","AuthenticationService","config",function(a,b,c){var d={method:"POST",isArray:!1,interceptor:b.responseError},e={method:"PUT",isArray:!1,interceptor:b.responseError};return a(c.apiBase+"/de/api/index/sendIvData",null,{post:d,create:e})}]).filter("accFilter",["$filter",function(a){return function(a,b){if(!b)return a;if(b.timeRangeFrom&&b.timeRangeTo){for(var c=b.timeRangeFrom.split("."),d=b.timeRangeTo.split("."),e=parseInt(c[2]+c[1]+c[0]),f=parseInt(d[2]+d[1]+d[0]),g=[],h=a.length,i=0;h>i;i++){var j=parseInt(a[i].activity_date.replace(/-/g,""));j>=e&&f>=j&&g.push(a[i])}return g}if(b.timeRangeFrom&&!b.timeRangeTo);else if(!b.timeRangeFrom&&b.timeRangeTo);else{if(b.year&&!b.quartal){for(var k=parseInt(b.year),g=[],h=a.length,i=0;h>i;i++){var j=parseInt(a[i].activity_date.substr(0,4));j===k&&g.push(a[i])}return g}if(b.year&&b.quartal){var e=null,f=null,k=b.year;switch(b.quartal){case"1":e=k+"0101",f=k+"0331";break;case"2":e=k+"0401",f=k+"0630";break;case"3":e=k+"0701",f=k+"0930";break;case"4":e=k+"1001",f=k+"1231"}for(var e=parseInt(e),f=parseInt(f),g=[],h=a.length,i=0;h>i;i++){var j=parseInt(a[i].activity_date.replace(/-/g,""));j>=e&&f>=j&&g.push(a[i])}return g}}return a}}]).filter("typeFilter",["$filter",function(a){return function(b,c){return c&&"0"!==c?"2"===c?a("filter")(b,{can_send:"j"}):a("filter")(b,{can_send:"n"}):b}}]).filter("myStrictFilter",["$filter",function(a){return function(b,c){return a("filter")(b,c,!0)}}]).filter("unique",function(){return function(a,b){var c,d={},e=a.length,f=[];for(c=0;e>c;c+=1)d[a[c][b]]=a[c];for(c in d)f.push(d[c]);return f}}),function(){var a=function(a,b){a.factory("httpInterceptor",["$q","$injector",function(a,b){return{response:function(b){return b||a.when(b)},responseError:function(c){return 401===c.status||403===c.status?(b.get("notify")({message:"Zugangsdaten nicht gültig oder Session abgelaufen.",position:"right",duration:"5000",classes:"alert-danger"}),b.get("AuthenticationService").ClearCredentials(),b.get("$location").path("/login")):b.get("notify")({message:c.data.message,position:"right",duration:"5000",classes:"alert-danger"}),a.reject(c)}}}]),b.interceptors.push("httpInterceptor")};a.$inject=["$provide","$httpProvider"],angular.module("frontendApp").config(a)}(),angular.module("config",[]).constant("config",{apiBase:"https://paracelsus.sanakey-contract.de",helpLink:"https://www.sanakey.de",impressum:"http://www.sanakey.de/impressum/impressum-sanakey-portal/",datasecurity:"https://www.sanakey.de/datenschutzerklaerung/datenschutz-sanakey-portal/",release:"https://www.sanakey.de/portal-release/",isAsvExample:!1});var marginLeft=0,marginTop=0,opacityOnGrid=null,dataEasing=null,mobileEasing=null,height=0,width=0;!function(a){a.fn.camera=function(b,c){function d(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)?!0:void 0}function e(){var b=a(C).width();a("li",C).removeClass("camera_visThumb"),a("li",C).each(function(){var c=a(this).position(),d=a("ul",C).outerWidth(),e=a("ul",C).offset().left,f=a("> div",C).offset().left,g=f-e;g>0?a(".camera_prevThumbs",Z).removeClass("hideNav"):a(".camera_prevThumbs",Z).addClass("hideNav"),d-g>b?a(".camera_nextThumbs",Z).removeClass("hideNav"):a(".camera_nextThumbs",Z).addClass("hideNav");var h=c.left,i=c.left+a(this).width();b>=i-g&&h-g>=0&&a(this).addClass("camera_visThumb")})}function f(){function c(){if(q=m.width(),-1!=b.height.indexOf("%")){var c=Math.round(q/(100/parseFloat(b.height)));r=""!=b.minHeight&&c<parseFloat(b.minHeight)?parseFloat(b.minHeight):c,m.css({height:r})}else"auto"==b.height?r=m.height():(r=parseFloat(b.height),m.css({height:r}));a(".camerarelative",u).css({width:q,height:r}),a(".imgLoaded",u).each(function(){var c,d,e=a(this),f=e.attr("width"),g=e.attr("height"),h=(e.index(),e.attr("data-alignment")),i=e.attr("data-portrait");if(("undefined"==typeof h||h===!1||""===h)&&(h=b.alignment),("undefined"==typeof i||i===!1||""===i)&&(i=b.portrait),0==i||"false"==i)if(q/r>f/g){var j=q/f,k=.5*Math.abs(r-g*j);switch(h){case"topLeft":c=0;break;case"topCenter":c=0;break;case"topRight":c=0;break;case"centerLeft":c="-"+k+"px";break;case"center":c="-"+k+"px";break;case"centerRight":c="-"+k+"px";break;case"bottomLeft":c="-"+2*k+"px";break;case"bottomCenter":c="-"+2*k+"px";break;case"bottomRight":c="-"+2*k+"px"}e.css({height:g*j,"margin-left":0,"margin-right":0,"margin-top":c,position:"absolute",visibility:"visible",width:q})}else{var j=r/g,k=.5*Math.abs(q-f*j);switch(h){case"topLeft":d=0;break;case"topCenter":d="-"+k+"px";break;case"topRight":d="-"+2*k+"px";break;case"centerLeft":d=0;break;case"center":d="-"+k+"px";break;case"centerRight":d="-"+2*k+"px";break;case"bottomLeft":d=0;break;case"bottomCenter":d="-"+k+"px";break;case"bottomRight":d="-"+2*k+"px"}e.css({height:r,"margin-left":d,"margin-right":d,"margin-top":0,position:"absolute",visibility:"visible",width:f*j})}else if(q/r>f/g){var j=r/g,k=.5*Math.abs(q-f*j);switch(h){case"topLeft":d=0;break;case"topCenter":d=k+"px";break;case"topRight":d=2*k+"px";break;case"centerLeft":d=0;break;case"center":d=k+"px";break;case"centerRight":d=2*k+"px";break;case"bottomLeft":d=0;break;case"bottomCenter":d=k+"px";break;case"bottomRight":d=2*k+"px"}e.css({height:r,"margin-left":d,"margin-right":d,"margin-top":0,position:"absolute",visibility:"visible",width:f*j})}else{var j=q/f,k=.5*Math.abs(r-g*j);switch(h){case"topLeft":c=0;break;case"topCenter":c=0;break;case"topRight":c=0;break;case"centerLeft":c=k+"px";break;case"center":c=k+"px";break;case"centerRight":c=k+"px";break;case"bottomLeft":c=2*k+"px";break;case"bottomCenter":c=2*k+"px";break;case"bottomRight":c=2*k+"px"}e.css({height:g*j,"margin-left":0,"margin-right":0,"margin-top":c,position:"absolute",visibility:"visible",width:q})}})}var d;1==P?(clearTimeout(d),d=setTimeout(c,200)):c(),P=!0}function g(){a("iframe",n).each(function(){a(".camera_caption",n).show();var c=a(this),d=c.attr("data-src");c.attr("src",d);var e=b.imagePath+"blank.gif",f=new Image;if(f.src=e,-1!=b.height.indexOf("%")){var g=Math.round(q/(100/parseFloat(b.height)));r=""!=b.minHeight&&g<parseFloat(b.minHeight)?parseFloat(b.minHeight):g}else r="auto"==b.height?m.height():parseFloat(b.height);c.after(a(f).attr({"class":"imgFake",width:q,height:r}));var h=c.clone();c.remove(),a(f).bind("click",function(){"absolute"==a(this).css("position")?(a(this).remove(),-1!=d.indexOf("vimeo")||-1!=d.indexOf("youtube")?-1!=d.indexOf("?")?autoplay="&autoplay=1":autoplay="?autoplay=1":-1!=d.indexOf("dailymotion")&&(-1!=d.indexOf("?")?autoplay="&autoPlay=1":autoplay="?autoPlay=1"),h.attr("src",d+autoplay),W=!0):(a(this).css({position:"absolute",top:0,left:0,zIndex:10}).after(h),h.css({position:"absolute",top:0,left:0,zIndex:9}))})})}function h(a){for(var b,c,d=a.length;d;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function i(){if(a(C).length&&!a(B).length){var b,c=a(C).outerWidth(),d=(a("ul > li",C).outerWidth(),a("li.cameracurrent",C).length?a("li.cameracurrent",C).position():""),f=a("ul > li",C).length*a("ul > li",C).outerWidth(),g=a("ul",C).offset().left,h=a("> div",C).offset().left;b=0>g?"-"+(h-g):h-g,1==ea&&(a("ul",C).width(a("ul > li",C).length*a("ul > li",C).outerWidth()),a(C).length&&!a(B).lenght&&m.css({marginBottom:a(C).outerHeight()}),e(),a("ul",C).width(a("ul > li",C).length*a("ul > li",C).outerWidth()),a(C).length&&!a(B).lenght&&m.css({marginBottom:a(C).outerHeight()})),ea=!1;var i=a("li.cameracurrent",C).length?d.left:"",j=a("li.cameracurrent",C).length?d.left+a("li.cameracurrent",C).outerWidth():"";i<a("li.cameracurrent",C).outerWidth()&&(i=0),j-b>c?f>i+c?a("ul",C).animate({"margin-left":"-"+i+"px"},500,e):a("ul",C).animate({"margin-left":"-"+(a("ul",C).outerWidth()-c)+"px"},500,e):0>i-b?a("ul",C).animate({"margin-left":"-"+i+"px"},500,e):(a("ul",C).css({"margin-left":"auto","margin-right":"auto"}),setTimeout(e,100))}}function j(){aa=0;var c=a(".camera_bar_cont",Z).width(),d=a(".camera_bar_cont",Z).height();if("pie"!=p)switch(Y){case"leftToRight":a("#"+s).css({right:c});break;case"rightToLeft":a("#"+s).css({left:c});break;case"topToBottom":a("#"+s).css({bottom:d});break;case"bottomToTop":a("#"+s).css({top:d})}else ca.clearRect(0,0,b.pieDiameter,b.pieDiameter)}function k(c){t.addClass("camerasliding"),W=!1;var e=parseFloat(a("div.cameraSlide.cameracurrent",u).index());if(c>0)var l=c-1;else if(e==J-1)var l=0;else var l=e+1;var o=a(".cameraSlide:eq("+l+")",u),v=a(".cameraSlide:eq("+(l+1)+")",u).addClass("cameranext");if(e!=l+1&&v.hide(),a(".cameraContent",n).fadeOut(600),a(".camera_caption",n).show(),a(".camerarelative",o).append(a("> div ",t).eq(l).find("> div.camera_effected")),a(".camera_target_content .cameraContent:eq("+l+")",m).append(a("> div ",t).eq(l).find("> div")),a(".imgLoaded",o).length){if(D.length>l+1&&!a(".imgLoaded",v).length){var w=D[l+1],x=new Image;x.src=w+"?"+(new Date).getTime(),v.prepend(a(x).attr("class","imgLoaded").css("visibility","hidden")),x.onload=function(){ta=x.naturalWidth,ua=x.naturalHeight,a(x).attr("data-alignment",H[l+1]).attr("data-portrait",G[l+1]),a(x).attr("width",ta),a(x).attr("height",ua),f()}}b.onLoaded.call(this),a(".camera_loader",m).is(":visible")?a(".camera_loader",m).fadeOut(400):(a(".camera_loader",m).css({visibility:"hidden"}),a(".camera_loader",m).fadeOut(400,function(){a(".camera_loader",m).css({visibility:"visible"})}));var y,z,A,E,F,I=b.rows,K=b.cols,L=1,M=0,O=new Array("simpleFade","curtainTopLeft","curtainTopRight","curtainBottomLeft","curtainBottomRight","curtainSliceLeft","curtainSliceRight","blindCurtainTopLeft","blindCurtainTopRight","blindCurtainBottomLeft","blindCurtainBottomRight","blindCurtainSliceBottom","blindCurtainSliceTop","stampede","mosaic","mosaicReverse","mosaicRandom","mosaicSpiral","mosaicSpiralReverse","topLeftBottomRight","bottomRightTopLeft","bottomLeftTopRight","topRightBottomLeft","scrollLeft","scrollRight","scrollTop","scrollBottom","scrollHorz");marginLeft=0,marginTop=0,opacityOnGrid=0,opacityOnGrid=1==b.opacityOnGrid?0:1;var P=a(" > div",t).eq(l).attr("data-fx");if(E=d()&&""!=b.mobileFx&&"default"!=b.mobileFx?b.mobileFx:"undefined"!=typeof P&&P!==!1&&"default"!==P?P:b.fx,"random"==E?(E=h(O),E=E[0]):(E=E,E.indexOf(",")>0&&(E=E.replace(/ /g,""),E=E.split(","),E=h(E),E=E[0])),dataEasing=a(" > div",t).eq(l).attr("data-easing"),mobileEasing=a(" > div",t).eq(l).attr("data-mobileEasing"),F=d()&&""!=b.mobileEasing&&"default"!=b.mobileEasing?"undefined"!=typeof mobileEasing&&mobileEasing!==!1&&"default"!==mobileEasing?mobileEasing:b.mobileEasing:"undefined"!=typeof dataEasing&&dataEasing!==!1&&"default"!==dataEasing?dataEasing:b.easing,y=a(" > div",t).eq(l).attr("data-slideOn"),"undefined"!=typeof y&&y!==!1)Q=y;else if("random"==b.slideOn){var Q=new Array("next","prev");Q=h(Q),Q=Q[0]}else Q=b.slideOn;var T=a(" > div",t).eq(l).attr("data-time");z="undefined"!=typeof T&&T!==!1&&""!==T?parseFloat(T):b.time;var U=a(" > div",t).eq(l).attr("data-transPeriod");switch(A="undefined"!=typeof U&&U!==!1&&""!==U?parseFloat(U):b.transPeriod,a(t).hasClass("camerastarted")||(E="simpleFade",Q="next",F="",A=400,a(t).addClass("camerastarted")),E){case"simpleFade":K=1,I=1;break;case"curtainTopLeft":K=0==b.slicedCols?b.cols:b.slicedCols,I=1;break;case"curtainTopRight":K=0==b.slicedCols?b.cols:b.slicedCols,I=1;break;case"curtainBottomLeft":K=0==b.slicedCols?b.cols:b.slicedCols,I=1;break;case"curtainBottomRight":K=0==b.slicedCols?b.cols:b.slicedCols,I=1;break;case"curtainSliceLeft":K=0==b.slicedCols?b.cols:b.slicedCols,I=1;break;case"curtainSliceRight":K=0==b.slicedCols?b.cols:b.slicedCols,I=1;break;case"blindCurtainTopLeft":I=0==b.slicedRows?b.rows:b.slicedRows,K=1;break;case"blindCurtainTopRight":I=0==b.slicedRows?b.rows:b.slicedRows,K=1;break;case"blindCurtainBottomLeft":I=0==b.slicedRows?b.rows:b.slicedRows,K=1;break;case"blindCurtainBottomRight":I=0==b.slicedRows?b.rows:b.slicedRows,K=1;break;case"blindCurtainSliceTop":I=0==b.slicedRows?b.rows:b.slicedRows,K=1;break;case"blindCurtainSliceBottom":I=0==b.slicedRows?b.rows:b.slicedRows,K=1;break;case"stampede":M="-"+A;break;case"mosaic":M=b.gridDifference;break;case"mosaicReverse":M=b.gridDifference;break;case"mosaicRandom":break;case"mosaicSpiral":M=b.gridDifference,L=1.7;break;case"mosaicSpiralReverse":M=b.gridDifference,L=1.7;break;case"topLeftBottomRight":M=b.gridDifference,L=6;break;case"bottomRightTopLeft":M=b.gridDifference,L=6;break;case"bottomLeftTopRight":M=b.gridDifference,L=6;break;case"topRightBottomLeft":M=b.gridDifference,L=6;break;case"scrollLeft":K=1,I=1;break;case"scrollRight":K=1,I=1;break;case"scrollTop":K=1,I=1;break;case"scrollBottom":K=1,I=1;break;case"scrollHorz":K=1,I=1}for(var V,$,_=0,da=I*K,ea=q-Math.floor(q/K)*K,fa=r-Math.floor(r/I)*I,ga=0,ha=0,ia=new Array,ja=new Array,ka=new Array;da>_;){ia.push(_),ja.push(_),N.append('<div class="cameraappended" style="display:none; overflow:hidden; position:absolute; z-index:1000" />');var la=a(".cameraappended:eq("+_+")",u);"scrollLeft"==E||"scrollRight"==E||"scrollTop"==E||"scrollBottom"==E||"scrollHorz"==E?X.eq(l).clone().show().appendTo(la):"next"==Q?X.eq(l).clone().show().appendTo(la):X.eq(e).clone().show().appendTo(la),V=ea>_%K?1:0,_%K==0&&(ga=0),$=Math.floor(_/K)<fa?1:0,la.css({height:Math.floor(r/I+$+1),left:ga,top:ha,width:Math.floor(q/K+V+1)}),a("> .cameraSlide",la).css({height:r,"margin-left":"-"+ga+"px","margin-top":"-"+ha+"px",width:q}),ga=ga+la.width()-1,_%K==K-1&&(ha=ha+la.height()-1),_++}switch(E){case"curtainTopLeft":break;case"curtainBottomLeft":break;case"curtainSliceLeft":break;case"curtainTopRight":ia=ia.reverse();break;case"curtainBottomRight":ia=ia.reverse();break;case"curtainSliceRight":ia=ia.reverse();break;case"blindCurtainTopLeft":break;case"blindCurtainBottomLeft":ia=ia.reverse();break;case"blindCurtainSliceTop":break;case"blindCurtainTopRight":break;case"blindCurtainBottomRight":ia=ia.reverse();break;case"blindCurtainSliceBottom":ia=ia.reverse();break;case"stampede":ia=h(ia);break;case"mosaic":break;case"mosaicReverse":ia=ia.reverse();break;case"mosaicRandom":ia=h(ia);break;case"mosaicSpiral":var ma,na,oa,pa=I/2,qa=0;for(oa=0;pa>oa;oa++){for(na=oa,ma=oa;K-oa-1>ma;ma++)ka[qa++]=na*K+ma;for(ma=K-oa-1,na=oa;I-oa-1>na;na++)ka[qa++]=na*K+ma;for(na=I-oa-1,ma=K-oa-1;ma>oa;ma--)ka[qa++]=na*K+ma;for(ma=oa,na=I-oa-1;na>oa;na--)ka[qa++]=na*K+ma}ia=ka;break;case"mosaicSpiralReverse":var ma,na,oa,pa=I/2,qa=da-1;for(oa=0;pa>oa;oa++){for(na=oa,ma=oa;K-oa-1>ma;ma++)ka[qa--]=na*K+ma;for(ma=K-oa-1,na=oa;I-oa-1>na;na++)ka[qa--]=na*K+ma;for(na=I-oa-1,ma=K-oa-1;ma>oa;ma--)ka[qa--]=na*K+ma;for(ma=oa,na=I-oa-1;na>oa;na--)ka[qa--]=na*K+ma}ia=ka;break;case"topLeftBottomRight":for(var na=0;I>na;na++)for(var ma=0;K>ma;ma++)ka.push(ma+na);ja=ka;break;case"bottomRightTopLeft":for(var na=0;I>na;na++)for(var ma=0;K>ma;ma++)ka.push(ma+na);ja=ka.reverse();break;case"bottomLeftTopRight":for(var na=I;na>0;na--)for(var ma=0;K>ma;ma++)ka.push(ma+na);ja=ka;break;case"topRightBottomLeft":for(var na=0;I>na;na++)for(var ma=K;ma>0;ma--)ka.push(ma+na);ja=ka}a.each(ia,function(c,d){function f(){if(a(this).addClass("cameraeased"),a(".cameraeased",u).length>=0&&a(C).css({visibility:"visible"}),a(".cameraeased",u).length==da){i(),a(".moveFromLeft, .moveFromRight, .moveFromTop, .moveFromBottom, .fadeIn, .fadeFromLeft, .fadeFromRight, .fadeFromTop, .fadeFromBottom",n).each(function(){a(this).css("visibility","hidden")}),X.eq(l).show().css("z-index","999").removeClass("cameranext").addClass("cameracurrent"),X.eq(e).css("z-index","1").removeClass("cameracurrent"),a(".cameraContent",n).eq(l).addClass("cameracurrent"),e>=0&&a(".cameraContent",n).eq(e).removeClass("cameracurrent"),b.onEndTransition.call(this),"hide"!=a("> div",t).eq(l).attr("data-video")&&a(".cameraContent.cameracurrent .imgFake",n).length&&a(".cameraContent.cameracurrent .imgFake",n).click();var c=X.eq(l).find(".fadeIn").length,d=a(".cameraContent",n).eq(l).find(".moveFromLeft, .moveFromRight, .moveFromTop, .moveFromBottom, .fadeIn, .fadeFromLeft, .fadeFromRight, .fadeFromTop, .fadeFromBottom").length;0!=c&&a(".cameraSlide.cameracurrent .fadeIn",n).each(function(){if(""!=a(this).attr("data-easing"))var b=a(this).attr("data-easing");else var b=F;var d=a(this);if("undefined"==typeof d.attr("data-outerWidth")||d.attr("data-outerWidth")===!1||""===d.attr("data-outerWidth")){var e=d.outerWidth();d.attr("data-outerWidth",e)}else var e=d.attr("data-outerWidth");if("undefined"==typeof d.attr("data-outerHeight")||d.attr("data-outerHeight")===!1||""===d.attr("data-outerHeight")){var f=d.outerHeight();d.attr("data-outerHeight",f)}else var f=d.attr("data-outerHeight");var g=d.position(),h=(g.left,g.top,d.attr("class")),i=d.index();d.parents(".camerarelative").outerHeight(),d.parents(".camerarelative").outerWidth();-1!=h.indexOf("fadeIn")?d.animate({opacity:0},0).css("visibility","visible").delay(z/c*(.1*(i-1))).animate({opacity:1},z/c*.15,b):d.css("visibility","visible")}),a(".cameraContent.cameracurrent",n).show(),0!=d&&a(".cameraContent.cameracurrent .moveFromLeft, .cameraContent.cameracurrent .moveFromRight, .cameraContent.cameracurrent .moveFromTop, .cameraContent.cameracurrent .moveFromBottom, .cameraContent.cameracurrent .fadeIn, .cameraContent.cameracurrent .fadeFromLeft, .cameraContent.cameracurrent .fadeFromRight, .cameraContent.cameracurrent .fadeFromTop, .cameraContent.cameracurrent .fadeFromBottom",n).each(function(){if(""!=a(this).attr("data-easing"))var b=a(this).attr("data-easing");else var b=F;var c=a(this),e=c.position(),f=(e.left,e.top,c.attr("class")),g=c.index(),h=c.outerHeight();-1!=f.indexOf("moveFromLeft")?(c.css({left:"-"+q+"px",right:"auto"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({left:e.left},z/d*.15,b)):-1!=f.indexOf("moveFromRight")?(c.css({left:q+"px",right:"auto"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({left:e.left},z/d*.15,b)):-1!=f.indexOf("moveFromTop")?(c.css({top:"-"+r+"px",bottom:"auto"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({top:e.top},z/d*.15,b,function(){c.css({top:"auto",bottom:0})})):-1!=f.indexOf("moveFromBottom")?(c.css({top:r+"px",bottom:"auto"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({top:e.top},z/d*.15,b)):-1!=f.indexOf("fadeFromLeft")?(c.animate({opacity:0},0).css({left:"-"+q+"px",right:"auto"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({left:e.left,opacity:1},z/d*.15,b)):-1!=f.indexOf("fadeFromRight")?(c.animate({opacity:0},0).css({left:q+"px",right:"auto"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({left:e.left,opacity:1},z/d*.15,b)):-1!=f.indexOf("fadeFromTop")?(c.animate({opacity:0},0).css({top:"-"+r+"px",bottom:"auto"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({top:e.top,opacity:1},z/d*.15,b,function(){c.css({top:"auto",bottom:0})})):-1!=f.indexOf("fadeFromBottom")?(c.animate({opacity:0},0).css({bottom:"-"+h+"px"}),c.css("visibility","visible").delay(z/d*(.1*(g-1))).animate({bottom:"0",opacity:1},z/d*.15,b)):-1!=f.indexOf("fadeIn")?c.animate({opacity:0},0).css("visibility","visible").delay(z/d*(.1*(g-1))).animate({opacity:1},z/d*.15,b):c.css("visibility","visible")}),a(".cameraappended",u).remove(),t.removeClass("camerasliding"),X.eq(e).hide();var f,h=a(".camera_bar_cont",Z).width(),m=a(".camera_bar_cont",Z).height();f="pie"!=p?.05:.005,a("#"+s).animate({opacity:b.loaderOpacity},200),R=setInterval(function(){if(t.hasClass("stopped")&&clearInterval(R),"pie"!=p)switch(1.002>=aa&&!t.hasClass("stopped")&&!t.hasClass("paused")&&!t.hasClass("hovered")?aa+=f:1>=aa&&(t.hasClass("stopped")||t.hasClass("paused")||t.hasClass("stopped")||t.hasClass("hovered"))?aa=aa:t.hasClass("stopped")||t.hasClass("paused")||t.hasClass("hovered")||(clearInterval(R),g(),a("#"+s).animate({opacity:0},200,function(){clearTimeout(S),S=setTimeout(j,o),k(),b.onStartLoading.call(this)})),Y){case"leftToRight":a("#"+s).animate({right:h-h*aa},z*f,"linear");break;case"rightToLeft":a("#"+s).animate({left:h-h*aa},z*f,"linear");break;case"topToBottom":a("#"+s).animate({bottom:m-m*aa},z*f,"linear");break;case"bottomToTop":a("#"+s).animate({bottom:m-m*aa},z*f,"linear")}else ba=aa,ca.clearRect(0,0,b.pieDiameter,b.pieDiameter),ca.globalCompositeOperation="destination-over",ca.beginPath(),ca.arc(b.pieDiameter/2,b.pieDiameter/2,b.pieDiameter/2-b.loaderStroke,0,2*Math.PI,!1),ca.lineWidth=b.loaderStroke,ca.strokeStyle=b.loaderBgColor,ca.stroke(),ca.closePath(),ca.globalCompositeOperation="source-over",ca.beginPath(),ca.arc(b.pieDiameter/2,b.pieDiameter/2,b.pieDiameter/2-b.loaderStroke,0,2*Math.PI*ba,!1),ca.lineWidth=b.loaderStroke-2*b.loaderPadding,ca.strokeStyle=b.loaderColor,ca.stroke(),ca.closePath(),1.002>=aa&&!t.hasClass("stopped")&&!t.hasClass("paused")&&!t.hasClass("hovered")?aa+=f:1>=aa&&(t.hasClass("stopped")||t.hasClass("paused")||t.hasClass("hovered"))?aa=aa:t.hasClass("stopped")||t.hasClass("paused")||t.hasClass("hovered")||(clearInterval(R),
g(),a("#"+s+", .camera_canvas_wrap",Z).animate({opacity:0},200,function(){clearTimeout(S),S=setTimeout(j,o),k(),b.onStartLoading.call(this)}))},z*f)}}switch(V=ea>d%K?1:0,d%K==0&&(ga=0),$=Math.floor(d/K)<fa?1:0,E){case"simpleFade":height=r,width=q,opacityOnGrid=0;break;case"curtainTopLeft":height=0,width=Math.floor(q/K+V+1),marginTop="-"+Math.floor(r/I+$+1)+"px";break;case"curtainTopRight":height=0,width=Math.floor(q/K+V+1),marginTop="-"+Math.floor(r/I+$+1)+"px";break;case"curtainBottomLeft":height=0,width=Math.floor(q/K+V+1),marginTop=Math.floor(r/I+$+1)+"px";break;case"curtainBottomRight":height=0,width=Math.floor(q/K+V+1),marginTop=Math.floor(r/I+$+1)+"px";break;case"curtainSliceLeft":height=0,width=Math.floor(q/K+V+1),marginTop=d%2==0?Math.floor(r/I+$+1)+"px":"-"+Math.floor(r/I+$+1)+"px";break;case"curtainSliceRight":height=0,width=Math.floor(q/K+V+1),marginTop=d%2==0?Math.floor(r/I+$+1)+"px":"-"+Math.floor(r/I+$+1)+"px";break;case"blindCurtainTopLeft":height=Math.floor(r/I+$+1),width=0,marginLeft="-"+Math.floor(q/K+V+1)+"px";break;case"blindCurtainTopRight":height=Math.floor(r/I+$+1),width=0,marginLeft=Math.floor(q/K+V+1)+"px";break;case"blindCurtainBottomLeft":height=Math.floor(r/I+$+1),width=0,marginLeft="-"+Math.floor(q/K+V+1)+"px";break;case"blindCurtainBottomRight":height=Math.floor(r/I+$+1),width=0,marginLeft=Math.floor(q/K+V+1)+"px";break;case"blindCurtainSliceBottom":height=Math.floor(r/I+$+1),width=0,marginLeft=d%2==0?"-"+Math.floor(q/K+V+1)+"px":Math.floor(q/K+V+1)+"px";break;case"blindCurtainSliceTop":height=Math.floor(r/I+$+1),width=0,marginLeft=d%2==0?"-"+Math.floor(q/K+V+1)+"px":Math.floor(q/K+V+1)+"px";break;case"stampede":height=0,width=0,marginLeft=.2*q*(c%K-(K-Math.floor(K/2)))+"px",marginTop=.2*r*(Math.floor(c/K)+1-(I-Math.floor(I/2)))+"px";break;case"mosaic":height=0,width=0;break;case"mosaicReverse":height=0,width=0,marginLeft=Math.floor(q/K+V+1)+"px",marginTop=Math.floor(r/I+$+1)+"px";break;case"mosaicRandom":height=0,width=0,marginLeft=.5*Math.floor(q/K+V+1)+"px",marginTop=.5*Math.floor(r/I+$+1)+"px";break;case"mosaicSpiral":height=0,width=0,marginLeft=.5*Math.floor(q/K+V+1)+"px",marginTop=.5*Math.floor(r/I+$+1)+"px";break;case"mosaicSpiralReverse":height=0,width=0,marginLeft=.5*Math.floor(q/K+V+1)+"px",marginTop=.5*Math.floor(r/I+$+1)+"px";break;case"topLeftBottomRight":height=0,width=0;break;case"bottomRightTopLeft":height=0,width=0,marginLeft=Math.floor(q/K+V+1)+"px",marginTop=Math.floor(r/I+$+1)+"px";break;case"bottomLeftTopRight":height=0,width=0,marginLeft=0,marginTop=Math.floor(r/I+$+1)+"px";break;case"topRightBottomLeft":height=0,width=0,marginLeft=Math.floor(q/K+V+1)+"px",marginTop=0;break;case"scrollRight":height=r,width=q,marginLeft=-q;break;case"scrollLeft":height=r,width=q,marginLeft=q;break;case"scrollTop":height=r,width=q,marginTop=r;break;case"scrollBottom":height=r,width=q,marginTop=-r;break;case"scrollHorz":height=r,width=q,marginLeft=0==e&&l==J-1?-q:l>e||e==J-1&&0==l?q:-q}var h=a(".cameraappended:eq("+d+")",u);"undefined"!=typeof R&&(clearInterval(R),clearTimeout(S),S=setTimeout(j,A+M)),a(B).length&&(a(".camera_pag li",m).removeClass("cameracurrent"),a(".camera_pag li",m).eq(l).addClass("cameracurrent")),a(C).length&&(a("li",C).removeClass("cameracurrent"),a("li",C).eq(l).addClass("cameracurrent"),a("li",C).not(".cameracurrent").find("img").animate({opacity:.5},0),a("li.cameracurrent img",C).animate({opacity:1},0),a("li",C).hover(function(){a("img",this).stop(!0,!1).animate({opacity:1},150)},function(){a(this).hasClass("cameracurrent")||a("img",this).stop(!0,!1).animate({opacity:.5},150)}));var o=parseFloat(A)+parseFloat(M);"scrollLeft"==E||"scrollRight"==E||"scrollTop"==E||"scrollBottom"==E||"scrollHorz"==E?(b.onStartTransition.call(this),o=0,h.delay((A+M)/da*ja[c]*L*.5).css({display:"block",height:height,"margin-left":marginLeft,"margin-top":marginTop,width:width}).animate({height:Math.floor(r/I+$+1),"margin-top":0,"margin-left":0,width:Math.floor(q/K+V+1)},A-M,F,f),X.eq(e).delay((A+M)/da*ja[c]*L*.5).animate({"margin-left":-1*marginLeft,"margin-top":-1*marginTop},A-M,F,function(){a(this).css({"margin-top":0,"margin-left":0})})):(b.onStartTransition.call(this),o=parseFloat(A)+parseFloat(M),"next"==Q?h.delay((A+M)/da*ja[c]*L*.5).css({display:"block",height:height,"margin-left":marginLeft,"margin-top":marginTop,width:width,opacity:opacityOnGrid}).animate({height:Math.floor(r/I+$+1),"margin-top":0,"margin-left":0,opacity:1,width:Math.floor(q/K+V+1)},A-M,F,f):(X.eq(l).show().css("z-index","999").addClass("cameracurrent"),X.eq(e).css("z-index","1").removeClass("cameracurrent"),a(".cameraContent",n).eq(l).addClass("cameracurrent"),a(".cameraContent",n).eq(e).removeClass("cameracurrent"),h.delay((A+M)/da*ja[c]*L*.5).css({display:"block",height:Math.floor(r/I+$+1),"margin-top":0,"margin-left":0,opacity:1,width:Math.floor(q/K+V+1)}).animate({height:height,"margin-left":marginLeft,"margin-top":marginTop,width:width,opacity:opacityOnGrid},A-M,F,f)))})}else{var ra=D[l],sa=new Image;sa.src=ra+"?"+(new Date).getTime(),o.css("visibility","hidden"),o.prepend(a(sa).attr("class","imgLoaded").css("visibility","hidden"));var ta,ua;a(sa).get(0).complete&&"0"!=ta&&"0"!=ua&&"undefined"!=typeof ta&&ta!==!1&&"undefined"!=typeof ua&&ua!==!1||(a(".camera_loader",m).delay(500).fadeIn(400),sa.onload=function(){ta=sa.naturalWidth,ua=sa.naturalHeight,a(sa).attr("data-alignment",H[l]).attr("data-portrait",G[l]),a(sa).attr("width",ta),a(sa).attr("height",ua),u.find(".cameraSlide_"+l).hide().css("visibility","visible"),f(),k(l+1)})}}var l={alignment:"center",autoAdvance:!0,mobileAutoAdvance:!0,barDirection:"leftToRight",barPosition:"bottom",cols:6,easing:"easeInOutExpo",mobileEasing:"",fx:"random",mobileFx:"",gridDifference:250,height:"50%",imagePath:"images/",hover:!0,loader:"pie",loaderColor:"#eeeeee",loaderBgColor:"#222222",loaderOpacity:.8,loaderPadding:2,loaderStroke:7,minHeight:"200px",navigation:!0,navigationHover:!0,mobileNavHover:!0,opacityOnGrid:!1,overlayer:!0,pagination:!0,playPause:!0,pauseOnClick:!0,pieDiameter:38,piePosition:"rightTop",portrait:!1,rows:4,slicedCols:12,slicedRows:8,slideOn:"random",thumbnails:!1,time:7e3,transPeriod:1500,onEndTransition:function(){},onLoaded:function(){},onStartLoading:function(){},onStartTransition:function(){}};a.support.borderRadius=!1,a.each(["borderRadius","BorderRadius","MozBorderRadius","WebkitBorderRadius","OBorderRadius","KhtmlBorderRadius"],function(){void 0!==document.body.style[this]&&(a.support.borderRadius=!0)});var b=a.extend({},l,b),m=a(this).addClass("camera_wrap");m.wrapInner('<div class="camera_src" />').wrapInner('<div class="camera_fakehover" />');var n=a(".camera_fakehover",m),o=m;n.append('<div class="camera_target"></div>'),1==b.overlayer&&n.append('<div class="camera_overlayer"></div>'),n.append('<div class="camera_target_content"></div>');var p;p="pie"!=b.loader||a.support.borderRadius?b.loader:"bar","pie"==p?n.append('<div class="camera_pie"></div>'):"bar"==p?n.append('<div class="camera_bar"></div>'):n.append('<div class="camera_bar" style="display:none"></div>'),1==b.playPause&&n.append('<div class="camera_commands"></div>'),1==b.navigation&&n.append('<div class="camera_prev"><span></span></div>').append('<div class="camera_next"><span></span></div>'),1==b.thumbnails&&m.append('<div class="camera_thumbs_cont" />'),1==b.thumbnails&&1!=b.pagination&&a(".camera_thumbs_cont",m).wrap("<div />").wrap('<div class="camera_thumbs" />').wrap("<div />").wrap('<div class="camera_command_wrap" />'),1==b.pagination&&m.append('<div class="camera_pag"></div>'),m.append('<div class="camera_loader"></div>'),a(".camera_caption",m).each(function(){a(this).wrapInner("<div />")});var q,r,s="pie_"+m.index(),t=a(".camera_src",m),u=a(".camera_target",m),v=a(".camera_target_content",m),w=a(".camera_pie",m),x=a(".camera_bar",m),y=a(".camera_prev",m),z=a(".camera_next",m),A=a(".camera_commands",m),B=a(".camera_pag",m),C=a(".camera_thumbs_cont",m),D=new Array;a("> div",t).each(function(){D.push(a(this).attr("data-src"))});var E=new Array;a("> div",t).each(function(){a(this).attr("data-link")?E.push(a(this).attr("data-link")):E.push("")});var F=new Array;a("> div",t).each(function(){a(this).attr("data-target")?F.push(a(this).attr("data-target")):F.push("")});var G=new Array;a("> div",t).each(function(){a(this).attr("data-portrait")?G.push(a(this).attr("data-portrait")):G.push("")});var H=new Array;a("> div",t).each(function(){a(this).attr("data-alignment")?H.push(a(this).attr("data-alignment")):H.push("")});var I=new Array;a("> div",t).each(function(){a(this).attr("data-thumb")?I.push(a(this).attr("data-thumb")):I.push("")});var J=D.length;a(v).append('<div class="cameraContents" />');var K;for(K=0;J>K;K++)if(a(".cameraContents",v).append('<div class="cameraContent" />'),""!=E[K]){var L=a("> div ",t).eq(K).attr("data-box");L="undefined"!=typeof L&&L!==!1&&""!=L?'data-box="'+a("> div ",t).eq(K).attr("data-box")+'"':"",a(".camera_target_content .cameraContent:eq("+K+")",m).append('<a class="camera_link" href="'+E[K]+'" '+L+' target="'+F[K]+'"></a>')}a(".camera_caption",m).each(function(){var b=a(this).parent().index(),c=m.find(".cameraContent").eq(b);a(this).appendTo(c)}),u.append('<div class="cameraCont" />');var M,N=a(".cameraCont",m);for(M=0;J>M;M++){N.append('<div class="cameraSlide cameraSlide_'+M+'" />');var O=a("> div:eq("+M+")",t);u.find(".cameraSlide_"+M).clone(O)}a(window).bind("load resize pageshow",function(){i(),e()}),N.append('<div class="cameraSlide cameraSlide_'+M+'" />');var P;m.show();var Q,q=u.width(),r=u.height();a(window).bind("resize pageshow",function(){1==P&&f(),a("ul",C).animate({"margin-top":0},0,i),t.hasClass("paused")||(t.addClass("paused"),a(".camera_stop",Z).length?(a(".camera_stop",Z).hide(),a(".camera_play",Z).show(),"none"!=p&&a("#"+s).hide()):"none"!=p&&a("#"+s).hide(),clearTimeout(Q),Q=setTimeout(function(){t.removeClass("paused"),a(".camera_play",Z).length?(a(".camera_play",Z).hide(),a(".camera_stop",Z).show(),"none"!=p&&a("#"+s).fadeIn()):"none"!=p&&a("#"+s).fadeIn()},1500))});var R,S,T,U,A,B,V,W;if(T=d()&&""!=b.mobileAutoAdvance?b.mobileAutoAdvance:b.autoAdvance,0==T&&t.addClass("paused"),U=d()&&""!=b.mobileNavHover?b.mobileNavHover:b.navigationHover,0!=t.length){var X=a(".cameraSlide",u);X.wrapInner('<div class="camerarelative" />');var Y=b.barDirection,Z=m;a("iframe",n).each(function(){var b=a(this),c=b.attr("src");b.attr("data-src",c);var d=b.parent().index(".camera_src > div");a(".camera_target_content .cameraContent:eq("+d+")",m).append(b)}),g(),1==b.hover&&(d()||n.hover(function(){t.addClass("hovered")},function(){t.removeClass("hovered")})),1==U&&(a(y,m).animate({opacity:0},0),a(z,m).animate({opacity:0},0),a(A,m).animate({opacity:0},0),d()?(a(document).on("vmouseover",o,function(){a(y,m).animate({opacity:1},200),a(z,m).animate({opacity:1},200),a(A,m).animate({opacity:1},200)}),a(document).on("vmouseout",o,function(){a(y,m).delay(500).animate({opacity:0},200),a(z,m).delay(500).animate({opacity:0},200),a(A,m).delay(500).animate({opacity:0},200)})):n.hover(function(){a(y,m).animate({opacity:1},200),a(z,m).animate({opacity:1},200),a(A,m).animate({opacity:1},200)},function(){a(y,m).animate({opacity:0},200),a(z,m).animate({opacity:0},200),a(A,m).animate({opacity:0},200)})),Z.on("click",".camera_stop",function(){T=!1,t.addClass("paused"),a(".camera_stop",Z).length?(a(".camera_stop",Z).hide(),a(".camera_play",Z).show(),"none"!=p&&a("#"+s).hide()):"none"!=p&&a("#"+s).hide()}),Z.on("click",".camera_play",function(){T=!0,t.removeClass("paused"),a(".camera_play",Z).length?(a(".camera_play",Z).hide(),a(".camera_stop",Z).show(),"none"!=p&&a("#"+s).show()):"none"!=p&&a("#"+s).show()}),1==b.pauseOnClick&&a(".camera_target_content",n).mouseup(function(){T=!1,t.addClass("paused"),a(".camera_stop",Z).hide(),a(".camera_play",Z).show(),a("#"+s).hide()}),a(".cameraContent, .imgFake",n).hover(function(){V=!0},function(){V=!1}),a(".cameraContent, .imgFake",n).bind("click",function(){1==W&&1==V&&(T=!1,a(".camera_caption",n).hide(),t.addClass("paused"),a(".camera_stop",Z).hide(),a(".camera_play",Z).show(),a("#"+s).hide())})}if("pie"!=p){x.append('<span class="camera_bar_cont" />'),a(".camera_bar_cont",x).animate({opacity:b.loaderOpacity},0).css({position:"absolute",left:0,right:0,top:0,bottom:0,"background-color":b.loaderBgColor}).append('<span id="'+s+'" />'),a("#"+s).animate({opacity:0},0);var $=a("#"+s);switch($.css({position:"absolute","background-color":b.loaderColor}),b.barPosition){case"left":x.css({right:"auto",width:b.loaderStroke});break;case"right":x.css({left:"auto",width:b.loaderStroke});break;case"top":x.css({bottom:"auto",height:b.loaderStroke});break;case"bottom":x.css({top:"auto",height:b.loaderStroke})}switch(Y){case"leftToRight":$.css({left:0,right:0,top:b.loaderPadding,bottom:b.loaderPadding});break;case"rightToLeft":$.css({left:0,right:0,top:b.loaderPadding,bottom:b.loaderPadding});break;case"topToBottom":$.css({left:b.loaderPadding,right:b.loaderPadding,top:0,bottom:0});break;case"bottomToTop":$.css({left:b.loaderPadding,right:b.loaderPadding,top:0,bottom:0})}}else{w.append('<canvas id="'+s+'"></canvas>');var $=document.getElementById(s);$.setAttribute("width",b.pieDiameter),$.setAttribute("height",b.pieDiameter);var _;switch(b.piePosition){case"leftTop":_="left:0; top:0;";break;case"rightTop":_="right:0; top:0;";break;case"leftBottom":_="left:0; bottom:0;";break;case"rightBottom":_="right:0; bottom:0;"}$.setAttribute("style","position:absolute; z-index:1002; "+_);var aa,ba;if($&&$.getContext){var ca=$.getContext("2d");ca.rotate(1.5*Math.PI),ca.translate(-b.pieDiameter,0)}}if(("none"==p||0==T)&&(a("#"+s).hide(),a(".camera_canvas_wrap",Z).hide()),a(B).length){a(B).append('<ul class="camera_pag_ul" />');var da;for(da=0;J>da;da++)a(".camera_pag_ul",m).append('<li class="pag_nav_'+da+'" style="position:relative; z-index:1002"><span><span>'+da+"</span></span></li>");a(".camera_pag_ul li",m).hover(function(){if(a(this).addClass("camera_hover"),a(".camera_thumb",this).length){var b=a(".camera_thumb",this).outerWidth(),c=a(".camera_thumb",this).outerHeight(),d=a(this).outerWidth();a(".camera_thumb",this).show().css({top:"-"+c+"px",left:"-"+(b-d)/2+"px"}).animate({opacity:1,"margin-top":"-3px"},200),a(".thumb_arrow",this).show().animate({opacity:1,"margin-top":"-3px"},200)}},function(){a(this).removeClass("camera_hover"),a(".camera_thumb",this).animate({"margin-top":"-20px",opacity:0},200,function(){a(this).css({marginTop:"5px"}).hide()}),a(".thumb_arrow",this).animate({"margin-top":"-20px",opacity:0},200,function(){a(this).css({marginTop:"5px"}).hide()})})}if(a(C).length){a(B).length?(a.each(I,function(b,c){if(""!=a("> div",t).eq(b).attr("data-thumb")){var d=a("> div",t).eq(b).attr("data-thumb"),e=new Image;e.src=d,a("li.pag_nav_"+b,B).append(a(e).attr("class","camera_thumb").css({position:"absolute"}).animate({opacity:0},0)),a("li.pag_nav_"+b+" > img",B).after('<div class="thumb_arrow" />'),a("li.pag_nav_"+b+" > .thumb_arrow",B).animate({opacity:0},0)}}),m.css({marginBottom:a(B).outerHeight()})):(a(C).append("<div />"),a(C).before('<div class="camera_prevThumbs hideNav"><div></div></div>').before('<div class="camera_nextThumbs hideNav"><div></div></div>'),a("> div",C).append("<ul />"),a.each(I,function(b,c){if(""!=a("> div",t).eq(b).attr("data-thumb")){var d=a("> div",t).eq(b).attr("data-thumb"),e=new Image;e.src=d,a("ul",C).append('<li class="pix_thumb pix_thumb_'+b+'" />'),a("li.pix_thumb_"+b,C).append(a(e).attr("class","camera_thumb"))}}))}else!a(C).length&&a(B).length&&m.css({marginBottom:a(B).outerHeight()});var ea=!0;a(A).length&&(a(A).append('<div class="camera_play"></div>').append('<div class="camera_stop"></div>'),1==T?(a(".camera_play",Z).hide(),a(".camera_stop",Z).show()):(a(".camera_stop",Z).hide(),a(".camera_play",Z).show())),j(),a(".moveFromLeft, .moveFromRight, .moveFromTop, .moveFromBottom, .fadeIn, .fadeFromLeft, .fadeFromRight, .fadeFromTop, .fadeFromBottom",n).each(function(){a(this).css("visibility","hidden")}),b.onStartLoading.call(this),k(),a(y).length&&a(y).click(function(){if(!t.hasClass("camerasliding")){var c=parseFloat(a(".cameraSlide.cameracurrent",u).index());clearInterval(R),g(),a("#"+s+", .camera_canvas_wrap",m).animate({opacity:0},0),j(),k(0!=c?c:J),b.onStartLoading.call(this)}}),a(z).length&&a(z).click(function(){if(!t.hasClass("camerasliding")){var c=parseFloat(a(".cameraSlide.cameracurrent",u).index());clearInterval(R),g(),a("#"+s+", .camera_canvas_wrap",Z).animate({opacity:0},0),j(),k(c==J-1?1:c+2),b.onStartLoading.call(this)}}),d()&&(n.bind("swipeleft",function(c){if(!t.hasClass("camerasliding")){var d=parseFloat(a(".cameraSlide.cameracurrent",u).index());clearInterval(R),g(),a("#"+s+", .camera_canvas_wrap",Z).animate({opacity:0},0),j(),k(d==J-1?1:d+2),b.onStartLoading.call(this)}}),n.bind("swiperight",function(c){if(!t.hasClass("camerasliding")){var d=parseFloat(a(".cameraSlide.cameracurrent",u).index());clearInterval(R),g(),a("#"+s+", .camera_canvas_wrap",Z).animate({opacity:0},0),j(),k(0!=d?d:J),b.onStartLoading.call(this)}})),a(B).length&&a(".camera_pag li",m).click(function(){if(!t.hasClass("camerasliding")){var c=parseFloat(a(this).index()),d=parseFloat(a(".cameraSlide.cameracurrent",u).index());c!=d&&(clearInterval(R),g(),a("#"+s+", .camera_canvas_wrap",Z).animate({opacity:0},0),j(),k(c+1),b.onStartLoading.call(this))}}),a(C).length&&(a(".pix_thumb img",C).click(function(){if(!t.hasClass("camerasliding")){var c=parseFloat(a(this).parents("li").index()),d=parseFloat(a(".cameracurrent",u).index());c!=d&&(clearInterval(R),g(),a("#"+s+", .camera_canvas_wrap",Z).animate({opacity:0},0),a(".pix_thumb",C).removeClass("cameracurrent"),a(this).parents("li").addClass("cameracurrent"),j(),k(c+1),i(),b.onStartLoading.call(this))}}),a(".camera_thumbs_cont .camera_prevThumbs",Z).hover(function(){a(this).stop(!0,!1).animate({opacity:1},250)},function(){a(this).stop(!0,!1).animate({opacity:.7},250)}),a(".camera_prevThumbs",Z).click(function(){var b=0,c=(a(C).outerWidth(),a("ul",C).offset().left),d=a("> div",C).offset().left,f=d-c;a(".camera_visThumb",C).each(function(){var c=a(this).outerWidth();b+=c}),f-b>0?a("ul",C).animate({"margin-left":"-"+(f-b)+"px"},500,e):a("ul",C).animate({"margin-left":0},500,e)}),a(".camera_thumbs_cont .camera_nextThumbs",Z).hover(function(){a(this).stop(!0,!1).animate({opacity:1},250)},function(){a(this).stop(!0,!1).animate({opacity:.7},250)}),a(".camera_nextThumbs",Z).click(function(){var b=0,c=a(C).outerWidth(),d=a("ul",C).outerWidth(),f=a("ul",C).offset().left,g=a("> div",C).offset().left,h=g-f;a(".camera_visThumb",C).each(function(){var c=a(this).outerWidth();b+=c}),d>h+b+b?a("ul",C).animate({"margin-left":"-"+(h+b)+"px"},500,e):a("ul",C).animate({"margin-left":"-"+(d-c)+"px"},500,e)}))}}(jQuery),function(a){a.fn.cameraStop=function(){var b=a(this),c=a(".camera_src",b);"pie_"+b.index();if(c.addClass("stopped"),a(".camera_showcommands").length){a(".camera_thumbs_wrap",b)}else;}}(jQuery),function(a){a.fn.cameraPause=function(){var b=a(this),c=a(".camera_src",b);c.addClass("paused")}}(jQuery),function(a){a.fn.cameraResume=function(){var b=a(this),c=a(".camera_src",b);("undefined"==typeof autoAdv||autoAdv!==!0)&&c.removeClass("paused")}}(jQuery),angular.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==b?0:a.length-b-1}function c(a,c){var d=c;void 0===d&&(d=Math.min(b(a),3));var e=Math.pow(10,d),f=(a*e|0)%e;return{v:d,f:f}}var d={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["vorm.","nachm."],DAY:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ERANAMES:["v. Chr.","n. Chr."],ERAS:["v. Chr.","n. Chr."],FIRSTDAYOFWEEK:0,MONTH:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],SHORTDAY:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],SHORTMONTH:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],STANDALONEMONTH:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d. MMMM y",longDate:"d. MMMM y",medium:"dd.MM.y HH:mm:ss",mediumDate:"dd.MM.y",mediumTime:"HH:mm:ss","short":"dd.MM.yy HH:mm",shortDate:"dd.MM.yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:"",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"de-de",localeID:"de_DE",pluralCat:function(a,b){var e=0|a,f=c(a,b);return 1==e&&0==f.v?d.ONE:d.OTHER}})}]),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*(2*Math.PI)/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(2==(b/=e/2))return c+d;if(g||(g=e*(.3*1.5)),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return 1>b?-.5*(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g))+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*(2*Math.PI)/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),(b/=e/2)<1?d/2*(b*b*(((f*=1.525)+1)*b-f))+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*(7.5625*b*b)+c:2/2.75>b?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:2.5/2.75>b?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return e/2>b?.5*jQuery.easing.easeInBounce(a,2*b,0,d,e)+c:.5*jQuery.easing.easeOutBounce(a,2*b-e,0,d,e)+.5*d+c}}),function(a,b){"function"==typeof define&&define.amd?define([],b):a.forge=b()}(this,function(){var a,b,c;return function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[],v=typeof c;if(f=f||a,"undefined"===v||"function"===v){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c?c.apply(q[a],u):void 0,a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){if("string"==typeof a)return p[a]?p[a](b):j(o(a,b).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!b)return;b.splice?(a=b,b=c,c=null):a=d}return b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n},n.config=function(a){return n(a)},a._defined=q,c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("node_modules/almond/almond",function(){}),function(){function a(a){function b(a){if(this.data="",this.read=0,"string"==typeof a)this.data=a;else if(d.isArrayBuffer(a)||d.isArrayBufferView(a)){var c=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,c)}catch(e){for(var f=0;f<c.length;++f)this.putByte(c[f])}}else(a instanceof b||"object"==typeof a&&"string"==typeof a.data&&"number"==typeof a.read)&&(this.data=a.data,this.read=a.read);this._constructedStringLength=0}function c(a,b){b=b||{},this.read=b.readOffset||0,this.growSize=b.growSize||1024;var c=d.isArrayBuffer(a),e=d.isArrayBufferView(a);return c||e?(c?this.data=new DataView(a):this.data=new DataView(a.buffer,a.byteOffset,a.byteLength),void(this.write="writeOffset"in b?b.writeOffset:this.data.byteLength)):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==a&&void 0!==a&&this.putBytes(a),void("writeOffset"in b&&(this.write=b.writeOffset)))}var d=a.util=a.util||{};!function(){function a(a){if(a.source===window&&a.data===b){a.stopPropagation();var d=c.slice();c.length=0,d.forEach(function(a){a()})}}if("undefined"!=typeof process&&process.nextTick)return d.nextTick=process.nextTick,void("function"==typeof setImmediate?d.setImmediate=setImmediate:d.setImmediate=d.nextTick);if("function"==typeof setImmediate)return d.setImmediate=setImmediate,void(d.nextTick=function(a){return setImmediate(a)});if(d.setImmediate=function(a){setTimeout(a,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var b="forge.setImmediate",c=[];d.setImmediate=function(a){c.push(a),1===c.length&&window.postMessage(b,"*")},window.addEventListener("message",a,!0)}if("undefined"!=typeof MutationObserver){var e=Date.now(),f=!0,g=document.createElement("div"),c=[];new MutationObserver(function(){var a=c.slice();c.length=0,a.forEach(function(a){a()})}).observe(g,{attributes:!0});var h=d.setImmediate;d.setImmediate=function(a){Date.now()-e>15?(e=Date.now(),h(a)):(c.push(a),1===c.length&&g.setAttribute("a",f=!f))}}d.nextTick=d.setImmediate}(),d.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},d.isArrayBuffer=function(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer},d.isArrayBufferView=function(a){return a&&d.isArrayBuffer(a.buffer)&&void 0!==a.byteLength},d.ByteBuffer=b,d.ByteStringBuffer=b;var e=4096;d.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a,this._constructedStringLength>e&&(this.data.substr(0,1),this._constructedStringLength=0)},d.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},d.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},d.ByteStringBuffer.prototype.putByte=function(a){return this.putBytes(String.fromCharCode(a))},d.ByteStringBuffer.prototype.fillWithByte=function(a,b){a=String.fromCharCode(a);for(var c=this.data;b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return this.data=c,this._optimizeConstructedString(b),this},d.ByteStringBuffer.prototype.putBytes=function(a){return this.data+=a,this._optimizeConstructedString(a.length),this},d.ByteStringBuffer.prototype.putString=function(a){return this.putBytes(d.encodeUtf8(a))},d.ByteStringBuffer.prototype.putInt16=function(a){return this.putBytes(String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},d.ByteStringBuffer.prototype.putInt24=function(a){return this.putBytes(String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},d.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},d.ByteStringBuffer.prototype.putInt16Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255))},d.ByteStringBuffer.prototype.putInt24Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255))},d.ByteStringBuffer.prototype.putInt32Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255))},d.ByteStringBuffer.prototype.putInt=function(a,b){var c="";do b-=8,c+=String.fromCharCode(a>>b&255);while(b>0);return this.putBytes(c)},d.ByteStringBuffer.prototype.putSignedInt=function(a,b){return 0>a&&(a+=2<<b-1),this.putInt(a,b)},d.ByteStringBuffer.prototype.putBuffer=function(a){return this.putBytes(a.getBytes())},d.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},d.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,a},d.ByteStringBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,a},d.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,
a},d.ByteStringBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,a},d.ByteStringBuffer.prototype.getInt24Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,a},d.ByteStringBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,a},d.ByteStringBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.charCodeAt(this.read++),a-=8;while(a>0);return b},d.ByteStringBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},d.ByteStringBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},d.ByteStringBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},d.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+a)},d.ByteStringBuffer.prototype.setAt=function(a,b){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1),this},d.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},d.ByteStringBuffer.prototype.copy=function(){var a=d.createBuffer(this.data);return a.read=this.read,a},d.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},d.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},d.ByteStringBuffer.prototype.truncate=function(a){var b=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,b),this.read=0,this},d.ByteStringBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);16>c&&(a+="0"),a+=c.toString(16)}return a},d.ByteStringBuffer.prototype.toString=function(){return d.decodeUtf8(this.bytes())},d.DataBuffer=c,d.DataBuffer.prototype.length=function(){return this.write-this.read},d.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},d.DataBuffer.prototype.accommodate=function(a,b){if(this.length()>=a)return this;b=Math.max(b||this.growSize,a);var c=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),d=new Uint8Array(this.length()+b);return d.set(c),this.data=new DataView(d.buffer),this},d.DataBuffer.prototype.putByte=function(a){return this.accommodate(1),this.data.setUint8(this.write++,a),this},d.DataBuffer.prototype.fillWithByte=function(a,b){this.accommodate(b);for(var c=0;b>c;++c)this.data.setUint8(a);return this},d.DataBuffer.prototype.putBytes=function(a,b){if(d.isArrayBufferView(a)){var c=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),e=c.byteLength-c.byteOffset;this.accommodate(e);var f=new Uint8Array(this.data.buffer,this.write);return f.set(c),this.write+=e,this}if(d.isArrayBuffer(a)){var c=new Uint8Array(a);this.accommodate(c.byteLength);var f=new Uint8Array(this.data.buffer);return f.set(c,this.write),this.write+=c.byteLength,this}if(a instanceof d.DataBuffer||"object"==typeof a&&"number"==typeof a.read&&"number"==typeof a.write&&d.isArrayBufferView(a.data)){var c=new Uint8Array(a.data.byteLength,a.read,a.length());this.accommodate(c.byteLength);var f=new Uint8Array(a.data.byteLength,this.write);return f.set(c),this.write+=c.byteLength,this}if(a instanceof d.ByteStringBuffer&&(a=a.data,b="binary"),b=b||"binary","string"==typeof a){var g;if("hex"===b)return this.accommodate(Math.ceil(a.length/2)),g=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.hex.decode(a,g,this.write),this;if("base64"===b)return this.accommodate(3*Math.ceil(a.length/4)),g=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.base64.decode(a,g,this.write),this;if("utf8"===b&&(a=d.encodeUtf8(a),b="binary"),"binary"===b||"raw"===b)return this.accommodate(a.length),g=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.raw.decode(g),this;if("utf16"===b)return this.accommodate(2*a.length),g=new Uint16Array(this.data.buffer,this.write),this.write+=d.text.utf16.encode(g),this;throw new Error("Invalid encoding: "+b)}throw Error("Invalid parameter: "+a)},d.DataBuffer.prototype.putBuffer=function(a){return this.putBytes(a),a.clear(),this},d.DataBuffer.prototype.putString=function(a){return this.putBytes(a,"utf16")},d.DataBuffer.prototype.putInt16=function(a){return this.accommodate(2),this.data.setInt16(this.write,a),this.write+=2,this},d.DataBuffer.prototype.putInt24=function(a){return this.accommodate(3),this.data.setInt16(this.write,a>>8&65535),this.data.setInt8(this.write,a>>16&255),this.write+=3,this},d.DataBuffer.prototype.putInt32=function(a){return this.accommodate(4),this.data.setInt32(this.write,a),this.write+=4,this},d.DataBuffer.prototype.putInt16Le=function(a){return this.accommodate(2),this.data.setInt16(this.write,a,!0),this.write+=2,this},d.DataBuffer.prototype.putInt24Le=function(a){return this.accommodate(3),this.data.setInt8(this.write,a>>16&255),this.data.setInt16(this.write,a>>8&65535,!0),this.write+=3,this},d.DataBuffer.prototype.putInt32Le=function(a){return this.accommodate(4),this.data.setInt32(this.write,a,!0),this.write+=4,this},d.DataBuffer.prototype.putInt=function(a,b){this.accommodate(b/8);do b-=8,this.data.setInt8(this.write++,a>>b&255);while(b>0);return this},d.DataBuffer.prototype.putSignedInt=function(a,b){return this.accommodate(b/8),0>a&&(a+=2<<b-1),this.putInt(a,b)},d.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},d.DataBuffer.prototype.getInt16=function(){var a=this.data.getInt16(this.read);return this.read+=2,a},d.DataBuffer.prototype.getInt24=function(){var a=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,a},d.DataBuffer.prototype.getInt32=function(){var a=this.data.getInt32(this.read);return this.read+=4,a},d.DataBuffer.prototype.getInt16Le=function(){var a=this.data.getInt16(this.read,!0);return this.read+=2,a},d.DataBuffer.prototype.getInt24Le=function(){var a=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,a},d.DataBuffer.prototype.getInt32Le=function(){var a=this.data.getInt32(this.read,!0);return this.read+=4,a},d.DataBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.getInt8(this.read++),a-=8;while(a>0);return b},d.DataBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},d.DataBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},d.DataBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},d.DataBuffer.prototype.at=function(a){return this.data.getUint8(this.read+a)},d.DataBuffer.prototype.setAt=function(a,b){return this.data.setUint8(a,b),this},d.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},d.DataBuffer.prototype.copy=function(){return new d.DataBuffer(this)},d.DataBuffer.prototype.compact=function(){if(this.read>0){var a=new Uint8Array(this.data.buffer,this.read),b=new Uint8Array(a.byteLength);b.set(a),this.data=new DataView(b),this.write-=this.read,this.read=0}return this},d.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},d.DataBuffer.prototype.truncate=function(a){return this.write=Math.max(0,this.length()-a),this.read=Math.min(this.read,this.write),this},d.DataBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.byteLength;++b){var c=this.data.getUint8(b);16>c&&(a+="0"),a+=c.toString(16)}return a},d.DataBuffer.prototype.toString=function(a){var b=new Uint8Array(this.data,this.read,this.length());if(a=a||"utf8","binary"===a||"raw"===a)return d.binary.raw.encode(b);if("hex"===a)return d.binary.hex.encode(b);if("base64"===a)return d.binary.base64.encode(b);if("utf8"===a)return d.text.utf8.decode(b);if("utf16"===a)return d.text.utf16.decode(b);throw new Error("Invalid encoding: "+a)},d.createBuffer=function(a,b){return b=b||"raw",void 0!==a&&"utf8"===b&&(a=d.encodeUtf8(a)),new d.ByteBuffer(a)},d.fillString=function(a,b){for(var c="";b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return c},d.xorBytes=function(a,b,c){for(var d="",e="",f="",g=0,h=0;c>0;--c,++g)e=a.charCodeAt(g)^b.charCodeAt(g),h>=10&&(d+=f,f="",h=0),f+=String.fromCharCode(e),++h;return d+=f},d.hexToBytes=function(a){var b="",c=0;for(a.length&!0&&(c=1,b+=String.fromCharCode(parseInt(a[0],16)));c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b},d.bytesToHex=function(a){return d.createBuffer(a).toHex()},d.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)};var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];d.encode64=function(a,b){for(var c,d,e,g="",h="",i=0;i<a.length;)c=a.charCodeAt(i++),d=a.charCodeAt(i++),e=a.charCodeAt(i++),g+=f.charAt(c>>2),g+=f.charAt((3&c)<<4|d>>4),isNaN(d)?g+="==":(g+=f.charAt((15&d)<<2|e>>6),g+=isNaN(e)?"=":f.charAt(63&e)),b&&g.length>b&&(h+=g.substr(0,b)+"\r\n",g=g.substr(b));return h+=g},d.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b,c,d,e,f="",h=0;h<a.length;)b=g[a.charCodeAt(h++)-43],c=g[a.charCodeAt(h++)-43],d=g[a.charCodeAt(h++)-43],e=g[a.charCodeAt(h++)-43],f+=String.fromCharCode(b<<2|c>>4),64!==d&&(f+=String.fromCharCode((15&c)<<4|d>>2),64!==e&&(f+=String.fromCharCode((3&d)<<6|e)));return f},d.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},d.decodeUtf8=function(a){return decodeURIComponent(escape(a))},d.binary={raw:{},hex:{},base64:{}},d.binary.raw.encode=function(a){return String.fromCharCode.apply(null,a)},d.binary.raw.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(a.length)),c=c||0;for(var e=c,f=0;f<a.length;++f)d[e++]=a.charCodeAt(f);return b?e-c:d},d.binary.hex.encode=d.bytesToHex,d.binary.hex.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(Math.ceil(a.length/2))),c=c||0;var e=0,f=c;for(1&a.length&&(e=1,d[f++]=parseInt(a[0],16));e<a.length;e+=2)d[f++]=parseInt(a.substr(e,2),16);return b?f-c:d},d.binary.base64.encode=function(a,b){for(var c,d,e,g="",h="",i=0;i<a.byteLength;)c=a[i++],d=a[i++],e=a[i++],g+=f.charAt(c>>2),g+=f.charAt((3&c)<<4|d>>4),isNaN(d)?g+="==":(g+=f.charAt((15&d)<<2|e>>6),g+=isNaN(e)?"=":f.charAt(63&e)),b&&g.length>b&&(h+=g.substr(0,b)+"\r\n",g=g.substr(b));return h+=g},d.binary.base64.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(3*Math.ceil(a.length/4))),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),c=c||0;for(var e,f,h,i,j=0,k=c;j<a.length;)e=g[a.charCodeAt(j++)-43],f=g[a.charCodeAt(j++)-43],h=g[a.charCodeAt(j++)-43],i=g[a.charCodeAt(j++)-43],d[k++]=e<<2|f>>4,64!==h&&(d[k++]=(15&f)<<4|h>>2,64!==i&&(d[k++]=(3&h)<<6|i));return b?k-c:d.subarray(0,k)},d.text={utf8:{},utf16:{}},d.text.utf8.encode=function(a,b,c){a=d.encodeUtf8(a);var e=b;e||(e=new Uint8Array(a.length)),c=c||0;for(var f=c,g=0;g<a.length;++g)e[f++]=a.charCodeAt(g);return b?f-c:e},d.text.utf8.decode=function(a){return d.decodeUtf8(String.fromCharCode.apply(null,a))},d.text.utf16.encode=function(a,b,c){var d=b;d||(d=new Uint8Array(2*a.length));var e=new Uint16Array(d.buffer);c=c||0;for(var f=c,g=c,h=0;h<a.length;++h)e[g++]=a.charCodeAt(h),f+=2;return b?f-c:d},d.text.utf16.decode=function(a){return String.fromCharCode.apply(null,new Uint16Array(a.buffer))},d.deflate=function(a,b,c){if(b=d.decode64(a.deflate(d.encode64(b)).rval),c){var e=2,f=b.charCodeAt(1);32&f&&(e=6),b=b.substring(e,b.length-4)}return b},d.inflate=function(a,b,c){var e=a.inflate(d.encode64(b)).rval;return null===e?null:d.decode64(e)};var h=function(a,b,c){if(!a)throw new Error("WebStorage not available.");var e;if(null===c?e=a.removeItem(b):(c=d.encode64(JSON.stringify(c)),e=a.setItem(b,c)),"undefined"!=typeof e&&e.rval!==!0){var f=new Error(e.error.message);throw f.id=e.error.id,f.name=e.error.name,f}},i=function(a,b){if(!a)throw new Error("WebStorage not available.");var c=a.getItem(b);if(a.init)if(null===c.rval){if(c.error){var e=new Error(c.error.message);throw e.id=c.error.id,e.name=c.error.name,e}c=null}else c=c.rval;return null!==c&&(c=JSON.parse(d.decode64(c))),c},j=function(a,b,c,d){var e=i(a,b);null===e&&(e={}),e[c]=d,h(a,b,e)},k=function(a,b,c){var d=i(a,b);return null!==d&&(d=c in d?d[c]:null),d},l=function(a,b,c){var d=i(a,b);if(null!==d&&c in d){delete d[c];var e=!0;for(var f in d){e=!1;break}e&&(d=null),h(a,b,d)}},m=function(a,b){h(a,b,null)},n=function(a,b,c){var d=null;"undefined"==typeof c&&(c=["web","flash"]);var e,f=!1,g=null;for(var h in c){e=c[h];try{if("flash"===e||"both"===e){if(null===b[0])throw new Error("Flash local storage not available.");d=a.apply(this,b),f="flash"===e}("web"===e||"both"===e)&&(b[0]=localStorage,d=a.apply(this,b),f=!0)}catch(i){g=i}if(f)break}if(!f)throw g;return d};d.setItem=function(a,b,c,d,e){n(j,arguments,e)},d.getItem=function(a,b,c,d){return n(k,arguments,d)},d.removeItem=function(a,b,c,d){n(l,arguments,d)},d.clearItems=function(a,b,c){n(m,arguments,c)},d.parseUrl=function(a){var b=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;b.lastIndex=0;var c=b.exec(a),d=null===c?null:{full:a,scheme:c[1],host:c[2],port:c[3],path:c[4]};return d&&(d.fullHost=d.host,d.port?80!==d.port&&"http"===d.scheme?d.fullHost+=":"+d.port:443!==d.port&&"https"===d.scheme&&(d.fullHost+=":"+d.port):"http"===d.scheme?d.port=80:"https"===d.scheme&&(d.port=443),d.full=d.scheme+"://"+d.fullHost),d};var o=null;d.getQueryVariables=function(a){var b,c=function(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e,f,g=c[d].indexOf("=");g>0?(e=c[d].substring(0,g),f=c[d].substring(g+1)):(e=c[d],f=null),e in b||(b[e]=[]),e in Object.prototype||null===f||b[e].push(unescape(f))}return b};return"undefined"==typeof a?(null===o&&(o="undefined"!=typeof window&&window.location&&window.location.search?c(window.location.search.substring(1)):{}),b=o):b=c(a),b},d.parseFragment=function(a){var b=a,c="",e=a.indexOf("?");e>0&&(b=a.substring(0,e),c=a.substring(e+1));var f=b.split("/");f.length>0&&""===f[0]&&f.shift();var g=""===c?{}:d.getQueryVariables(c);return{pathString:b,queryString:c,path:f,query:g}},d.makeRequest=function(a){var b=d.parseFragment(a),c={path:b.pathString,query:b.queryString,getPath:function(a){return"undefined"==typeof a?b.path:b.path[a]},getQuery:function(a,c){var d;return"undefined"==typeof a?d=b.query:(d=b.query[a],d&&"undefined"!=typeof c&&(d=d[c])),d},getQueryLast:function(a,b){var d,e=c.getQuery(a);return d=e?e[e.length-1]:b}};return c},d.makeLink=function(a,b,c){a=jQuery.isArray(a)?a.join("/"):a;var d=jQuery.param(b||{});return c=c||"",a+(d.length>0?"?"+d:"")+(c.length>0?"#"+c:"")},d.setPath=function(a,b,c){if("object"==typeof a&&null!==a)for(var d=0,e=b.length;e>d;){var f=b[d++];if(d==e)a[f]=c;else{var g=f in a;(!g||g&&"object"!=typeof a[f]||g&&null===a[f])&&(a[f]={}),a=a[f]}}},d.getPath=function(a,b,c){for(var d=0,e=b.length,f=!0;f&&e>d&&"object"==typeof a&&null!==a;){var g=b[d++];f=g in a,f&&(a=a[g])}return f?a:c},d.deletePath=function(a,b){if("object"==typeof a&&null!==a)for(var c=0,d=b.length;d>c;){var e=b[c++];if(c==d)delete a[e];else{if(!(e in a)||"object"!=typeof a[e]||null===a[e])break;a=a[e]}}},d.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},d.format=function(a){for(var b,c,d=/%./g,e=0,f=[],g=0;b=d.exec(a);){c=a.substring(g,d.lastIndex-2),c.length>0&&f.push(c),g=d.lastIndex;var h=b[0][1];switch(h){case"s":case"o":e<arguments.length?f.push(arguments[e++ +1]):f.push("<?>");break;case"%":f.push("%");break;default:f.push("<%"+h+"?>")}}return f.push(a.substring(g)),f.join("")},d.formatNumber=function(a,b,c,d){var e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0===c?",":c,h=void 0===d?".":d,i=0>e?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f),10)+"",k=j.length>3?j.length%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")},d.formatSize=function(a){return a=a>=1073741824?d.formatNumber(a/1073741824,2,".","")+" GiB":a>=1048576?d.formatNumber(a/1048576,2,".","")+" MiB":a>=1024?d.formatNumber(a/1024,0)+" KiB":d.formatNumber(a,0)+" bytes"},d.bytesFromIP=function(a){return-1!==a.indexOf(".")?d.bytesFromIPv4(a):-1!==a.indexOf(":")?d.bytesFromIPv6(a):null},d.bytesFromIPv4=function(a){if(a=a.split("."),4!==a.length)return null;for(var b=d.createBuffer(),c=0;c<a.length;++c){var e=parseInt(a[c],10);if(isNaN(e))return null;b.putByte(e)}return b.getBytes()},d.bytesFromIPv6=function(a){var b=0;a=a.split(":").filter(function(a){return 0===a.length&&++b,!0});for(var c=2*(8-a.length+b),e=d.createBuffer(),f=0;8>f;++f)if(a[f]&&0!==a[f].length){var g=d.hexToBytes(a[f]);g.length<2&&e.putByte(0),e.putBytes(g)}else e.fillWithByte(0,c),c=0;return e.getBytes()},d.bytesToIP=function(a){return 4===a.length?d.bytesToIPv4(a):16===a.length?d.bytesToIPv6(a):null},d.bytesToIPv4=function(a){if(4!==a.length)return null;for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b.join(".")},d.bytesToIPv6=function(a){if(16!==a.length)return null;for(var b=[],c=[],e=0,f=0;f<a.length;f+=2){for(var g=d.bytesToHex(a[f]+a[f+1]);"0"===g[0]&&"0"!==g;)g=g.substr(1);if("0"===g){var h=c[c.length-1],i=b.length;h&&i===h.end+1?(h.end=i,h.end-h.start>c[e].end-c[e].start&&(e=c.length-1)):c.push({start:i,end:i})}b.push(g)}if(c.length>0){var j=c[e];j.end-j.start>0&&(b.splice(j.start,j.end-j.start+1,""),0===j.start&&b.unshift(""),7===j.end&&b.push(""))}return b.join(":")},d.estimateCores=function(a,b){function c(a,h,i){if(0===h){var j=Math.floor(a.reduce(function(a,b){return a+b},0)/a.length);return d.cores=Math.max(1,j),URL.revokeObjectURL(g),b(null,d.cores)}e(i,function(b,d){a.push(f(i,d)),c(a,h-1,i)})}function e(a,b){for(var c=[],d=[],e=0;a>e;++e){var f=new Worker(g);f.addEventListener("message",function(e){if(d.push(e.data),d.length===a){for(var f=0;a>f;++f)c[f].terminate();b(null,d)}}),c.push(f)}for(var e=0;a>e;++e)c[e].postMessage(e)}function f(a,b){for(var c=[],d=0;a>d;++d)for(var e=b[d],f=c[d]=[],g=0;a>g;++g)if(d!==g){var h=b[g];(e.st>h.st&&e.st<h.et||h.st>e.st&&h.st<e.et)&&f.push(g)}return c.reduce(function(a,b){return Math.max(a,b.length)},0)}if("function"==typeof a&&(b=a,a={}),a=a||{},"cores"in d&&!a.update)return b(null,d.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return d.cores=navigator.hardwareConcurrency,b(null,d.cores);if("undefined"==typeof Worker)return d.cores=1,b(null,d.cores);if("undefined"==typeof Blob)return d.cores=2,b(null,d.cores);var g=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var b=Date.now(),c=b+4;Date.now()<c;);self.postMessage({st:b,et:c})})}.toString(),")()"],{type:"application/javascript"}));c([],5,16)}}var d="util";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/util",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.cipher=a.cipher||{},a.cipher.algorithms=a.cipher.algorithms||{},a.cipher.createCipher=function(b,c){var d=b;if("string"==typeof d&&(d=a.cipher.getAlgorithm(d),d&&(d=d())),!d)throw new Error("Unsupported algorithm: "+b);return new a.cipher.BlockCipher({algorithm:d,key:c,decrypt:!1})},a.cipher.createDecipher=function(b,c){var d=b;if("string"==typeof d&&(d=a.cipher.getAlgorithm(d),d&&(d=d())),!d)throw new Error("Unsupported algorithm: "+b);return new a.cipher.BlockCipher({algorithm:d,key:c,decrypt:!0})},a.cipher.registerAlgorithm=function(b,c){b=b.toUpperCase(),a.cipher.algorithms[b]=c},a.cipher.getAlgorithm=function(b){return b=b.toUpperCase(),b in a.cipher.algorithms?a.cipher.algorithms[b]:null};var b=a.cipher.BlockCipher=function(a){this.algorithm=a.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=a.decrypt,this.algorithm.initialize(a)};b.prototype.start=function(b){b=b||{};var c={};for(var d in b)c[d]=b[d];c.decrypt=this._decrypt,this._finish=!1,this._input=a.util.createBuffer(),this.output=b.output||a.util.createBuffer(),this.mode.start(c)},b.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},b.prototype.finish=function(a){!a||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(b){return a(this.blockSize,b,!1)},this.mode.unpad=function(b){return a(this.blockSize,b,!0)});var b={};return b.decrypt=this._decrypt,b.overflow=this._input.length()%this.blockSize,this._decrypt||!this.mode.pad||this.mode.pad(this._input,b)?(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,b)?!1:this.mode.afterFinish&&!this.mode.afterFinish(this.output,b)?!1:!0):!1}}var d="cipher";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipher",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b){if("string"==typeof b&&(b=a.util.createBuffer(b)),a.util.isArray(b)&&b.length>4){var c=b;b=a.util.createBuffer();for(var d=0;d<c.length;++d)b.putByte(c[d])}return a.util.isArray(b)||(b=[b.getInt32(),b.getInt32(),b.getInt32(),b.getInt32()]),b}function c(a){a[a.length-1]=a[a.length-1]+1&4294967295}function d(a){return[a/4294967296|0,4294967295&a]}a.cipher=a.cipher||{};var e=a.cipher.modes=a.cipher.modes||{};e.ecb=function(a){a=a||{},this.name="ECB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(a){},e.ecb.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},e.ecb.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},e.ecb.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},e.ecb.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return d>this.blockSize<<2?!1:(a.truncate(d),!0)},e.cbc=function(a){a=a||{},this.name="CBC",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(a){if(null===a.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._prev=this._iv.slice(0)}},e.cbc.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=this._prev[d]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._prev[d]^this._outBlock[d]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},e.cbc.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return d>this.blockSize<<2?!1:(a.truncate(d),!0)},e.cfb=function(b){b=b||{},this.name="CFB",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32()^this._outBlock[e],b.putInt32(this._inBlock[e]);else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32()^this._outBlock[e],this._partialOutput.putInt32(this._partialBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},e.cfb.prototype.decrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32(),b.putInt32(this._inBlock[e]^this._outBlock[e]);else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32(),this._partialOutput.putInt32(this._partialBlock[e]^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},e.ofb=function(b){b=b||{},this.name="OFB",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===a.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)b.putInt32(a.getInt32()^this._outBlock[e]),this._inBlock[e]=this._outBlock[e];else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialOutput.putInt32(a.getInt32()^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._outBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(b){b=b||{},this.name="CTR",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(a,b,d){var e=a.length();if(0===e)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&e>=this.blockSize)for(var f=0;f<this._ints;++f)b.putInt32(a.getInt32()^this._outBlock[f]);else{var g=(this.blockSize-e)%this.blockSize;g>0&&(g=this.blockSize-g),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(g>0&&(a.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),g>0&&!d)return b.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;b.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),this._partialBytes=0}c(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(b){b=b||{},this.name="GCM",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(b){if(!("iv"in b))throw new Error("Invalid IV parameter.");var e=a.util.createBuffer(b.iv);this._cipherLength=0;var f;if(f="additionalData"in b?a.util.createBuffer(b.additionalData):a.util.createBuffer(),"tagLength"in b?this._tagLength=b.tagLength:this._tagLength=128,this._tag=null,b.decrypt&&(this._tag=a.util.createBuffer(b.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var g=e.length();if(12===g)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(d(8*g)))}this._inBlock=this._j0.slice(0),c(this._inBlock),this._partialBytes=0,f=a.util.createBuffer(f),this._aDataLength=d(8*f.length());var h=f.length()%this.blockSize;for(h&&f.fillWithByte(0,this.blockSize-h),this._s=[0,0,0,0];f.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[f.getInt32(),f.getInt32(),f.getInt32(),f.getInt32()])},e.gcm.prototype.encrypt=function(a,b,d){var e=a.length();if(0===e)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&e>=this.blockSize){
for(var f=0;f<this._ints;++f)b.putInt32(this._outBlock[f]^=a.getInt32());this._cipherLength+=this.blockSize}else{var g=(this.blockSize-e)%this.blockSize;g>0&&(g=this.blockSize-g),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(0===g||d){if(d){var h=e%this.blockSize;this._cipherLength+=h,this._partialOutput.truncate(this.blockSize-h)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),g>0&&!d)return a.read-=this.blockSize,b.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;b.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),c(this._inBlock)},e.gcm.prototype.decrypt=function(a,b,d){var e=a.length();if(e<this.blockSize&&!(d&&e>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),c(this._inBlock),this._hashBlock[0]=a.getInt32(),this._hashBlock[1]=a.getInt32(),this._hashBlock[2]=a.getInt32(),this._hashBlock[3]=a.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)b.putInt32(this._outBlock[f]^this._hashBlock[f]);e<this.blockSize?this._cipherLength+=e%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(b,c){var e=!0;c.decrypt&&c.overflow&&b.truncate(this.blockSize-c.overflow),this.tag=a.util.createBuffer();var f=this._aDataLength.concat(d(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,f);var g=[];this.cipher.encrypt(this._j0,g);for(var h=0;h<this._ints;++h)this.tag.putInt32(this._s[h]^g[h]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(e=!1),e},e.gcm.prototype.multiply=function(a,b){for(var c=[0,0,0,0],d=b.slice(0),e=0;128>e;++e){var f=a[e/32|0]&1<<31-e%32;f&&(c[0]^=d[0],c[1]^=d[1],c[2]^=d[2],c[3]^=d[3]),this.pow(d,d)}return c},e.gcm.prototype.pow=function(a,b){for(var c=1&a[3],d=3;d>0;--d)b[d]=a[d]>>>1|(1&a[d-1])<<31;b[0]=a[0]>>>1,c&&(b[0]^=this._R)},e.gcm.prototype.tableMultiply=function(a){for(var b=[0,0,0,0],c=0;32>c;++c){var d=c/8|0,e=a[d]>>>4*(7-c%8)&15,f=this._m[c][e];b[0]^=f[0],b[1]^=f[1],b[2]^=f[2],b[3]^=f[3]}return b},e.gcm.prototype.ghash=function(a,b,c){return b[0]^=c[0],b[1]^=c[1],b[2]^=c[2],b[3]^=c[3],this.tableMultiply(b)},e.gcm.prototype.generateHashTable=function(a,b){for(var c=8/b,d=4*c,e=16*c,f=new Array(e),g=0;e>g;++g){var h=[0,0,0,0],i=g/d|0,j=(d-1-g%d)*b;h[i]=1<<b-1<<j,f[g]=this.generateSubHashTable(this.multiply(h,a),b)}return f},e.gcm.prototype.generateSubHashTable=function(a,b){var c=1<<b,d=c>>>1,e=new Array(c);e[d]=a.slice(0);for(var f=d>>>1;f>0;)this.pow(e[2*f],e[f]=[]),f>>=1;for(f=2;d>f;){for(var g=1;f>g;++g){var h=e[f],i=e[g];e[f+g]=[h[0]^i[0],h[1]^i[1],h[2]^i[2],h[3]^i[3]]}f*=2}for(e[0]=[0,0,0,0],f=d+1;c>f;++f){var j=e[f^d];e[f]=[a[0]^j[0],a[1]^j[1],a[2]^j[2],a[3]^j[3]]}return e}}var d="cipherModes";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipherModes",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c){var d=function(){return new a.aes.Algorithm(b,c)};a.cipher.registerAlgorithm(b,d)}function c(){l=!0,i=[0,1,2,4,8,16,32,64,128,27,54];for(var a=new Array(256),b=0;128>b;++b)a[b]=b<<1,a[b+128]=b+128<<1^283;g=new Array(256),h=new Array(256),j=new Array(4),k=new Array(4);for(var b=0;4>b;++b)j[b]=new Array(256),k[b]=new Array(256);for(var c,d,e,f,m,n,o,p=0,q=0,b=0;256>b;++b){f=q^q<<1^q<<2^q<<3^q<<4,f=f>>8^255&f^99,g[p]=f,h[f]=p,m=a[f],c=a[p],d=a[c],e=a[d],n=m<<24^f<<16^f<<8^(f^m),o=(c^d^e)<<24^(p^e)<<16^(p^d^e)<<8^(p^c^e);for(var r=0;4>r;++r)j[r][p]=n,k[r][f]=o,n=n<<24|n>>>8,o=o<<24|o>>>8;0===p?p=q=1:(p=c^a[a[a[c^e]]],q^=a[a[q]])}}function d(a,b){for(var c,d=a.slice(0),e=1,f=d.length,h=f+6+1,j=m*h,l=f;j>l;++l)c=d[l-1],l%f===0?(c=g[c>>>16&255]<<24^g[c>>>8&255]<<16^g[255&c]<<8^g[c>>>24]^i[e]<<24,e++):f>6&&l%f===4&&(c=g[c>>>24]<<24^g[c>>>16&255]<<16^g[c>>>8&255]<<8^g[255&c]),d[l]=d[l-f]^c;if(b){var n,o=k[0],p=k[1],q=k[2],r=k[3],s=d.slice(0);j=d.length;for(var l=0,t=j-m;j>l;l+=m,t-=m)if(0===l||l===j-m)s[l]=d[t],s[l+1]=d[t+3],s[l+2]=d[t+2],s[l+3]=d[t+1];else for(var u=0;m>u;++u)n=d[t+u],s[l+(3&-u)]=o[g[n>>>24]]^p[g[n>>>16&255]]^q[g[n>>>8&255]]^r[g[255&n]];d=s}return d}function e(a,b,c,d){var e,f,i,l,m,n=a.length/4-1;d?(e=k[0],f=k[1],i=k[2],l=k[3],m=h):(e=j[0],f=j[1],i=j[2],l=j[3],m=g);var o,p,q,r,s,t,u;o=b[0]^a[0],p=b[d?3:1]^a[1],q=b[2]^a[2],r=b[d?1:3]^a[3];for(var v=3,w=1;n>w;++w)s=e[o>>>24]^f[p>>>16&255]^i[q>>>8&255]^l[255&r]^a[++v],t=e[p>>>24]^f[q>>>16&255]^i[r>>>8&255]^l[255&o]^a[++v],u=e[q>>>24]^f[r>>>16&255]^i[o>>>8&255]^l[255&p]^a[++v],r=e[r>>>24]^f[o>>>16&255]^i[p>>>8&255]^l[255&q]^a[++v],o=s,p=t,q=u;c[0]=m[o>>>24]<<24^m[p>>>16&255]<<16^m[q>>>8&255]<<8^m[255&r]^a[++v],c[d?3:1]=m[p>>>24]<<24^m[q>>>16&255]<<16^m[r>>>8&255]<<8^m[255&o]^a[++v],c[2]=m[q>>>24]<<24^m[r>>>16&255]<<16^m[o>>>8&255]<<8^m[255&p]^a[++v],c[d?1:3]=m[r>>>24]<<24^m[o>>>16&255]<<16^m[p>>>8&255]<<8^m[255&q]^a[++v]}function f(b){b=b||{};var c,d=(b.mode||"CBC").toUpperCase(),e="AES-"+d;c=b.decrypt?a.cipher.createDecipher(e,b.key):a.cipher.createCipher(e,b.key);var f=c.start;return c.start=function(b,d){var e=null;d instanceof a.util.ByteBuffer&&(e=d,d={}),d=d||{},d.output=e,d.iv=b,f.call(c,d)},c}a.aes=a.aes||{},a.aes.startEncrypting=function(a,b,c,d){var e=f({key:a,output:c,decrypt:!1,mode:d});return e.start(b),e},a.aes.createEncryptionCipher=function(a,b){return f({key:a,output:null,decrypt:!1,mode:b})},a.aes.startDecrypting=function(a,b,c,d){var e=f({key:a,output:c,decrypt:!0,mode:d});return e.start(b),e},a.aes.createDecryptionCipher=function(a,b){return f({key:a,output:null,decrypt:!0,mode:b})},a.aes.Algorithm=function(a,b){l||c();var d=this;d.name=a,d.mode=new b({blockSize:16,cipher:{encrypt:function(a,b){return e(d._w,a,b,!1)},decrypt:function(a,b){return e(d._w,a,b,!0)}}}),d._init=!1},a.aes.Algorithm.prototype.initialize=function(b){if(!this._init){var c,e=b.key;if("string"!=typeof e||16!==e.length&&24!==e.length&&32!==e.length){if(a.util.isArray(e)&&(16===e.length||24===e.length||32===e.length)){c=e,e=a.util.createBuffer();for(var f=0;f<c.length;++f)e.putByte(c[f])}}else e=a.util.createBuffer(e);if(!a.util.isArray(e)){c=e,e=[];var g=c.length();if(16===g||24===g||32===g){g>>>=2;for(var f=0;g>f;++f)e.push(c.getInt32())}}if(!a.util.isArray(e)||4!==e.length&&6!==e.length&&8!==e.length)throw new Error("Invalid key parameter.");var h=this.mode.name,i=-1!==["CFB","OFB","CTR","GCM"].indexOf(h);this._w=d(e,b.decrypt&&!i),this._init=!0}},a.aes._expandKey=function(a,b){return l||c(),d(a,b)},a.aes._updateBlock=e,b("AES-ECB",a.cipher.modes.ecb),b("AES-CBC",a.cipher.modes.cbc),b("AES-CFB",a.cipher.modes.cfb),b("AES-OFB",a.cipher.modes.ofb),b("AES-CTR",a.cipher.modes.ctr),b("AES-GCM",a.cipher.modes.gcm);var g,h,i,j,k,l=!1,m=4}var d="aes";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.pki=a.pki||{};var b=a.pki.oids=a.oids=a.oids||{};b["1.2.840.113549.1.1.1"]="rsaEncryption",b.rsaEncryption="1.2.840.113549.1.1.1",b["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",b.md5WithRSAEncryption="1.2.840.113549.1.1.4",b["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",b.sha1WithRSAEncryption="1.2.840.113549.1.1.5",b["1.2.840.113549.1.1.7"]="RSAES-OAEP",b["RSAES-OAEP"]="1.2.840.113549.1.1.7",b["1.2.840.113549.1.1.8"]="mgf1",b.mgf1="1.2.840.113549.1.1.8",b["1.2.840.113549.1.1.9"]="pSpecified",b.pSpecified="1.2.840.113549.1.1.9",b["1.2.840.113549.1.1.10"]="RSASSA-PSS",b["RSASSA-PSS"]="1.2.840.113549.1.1.10",b["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",b.sha256WithRSAEncryption="1.2.840.113549.1.1.11",b["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",b.sha384WithRSAEncryption="1.2.840.113549.1.1.12",b["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",b.sha512WithRSAEncryption="1.2.840.113549.1.1.13",b["1.3.14.3.2.7"]="desCBC",b.desCBC="1.3.14.3.2.7",b["1.3.14.3.2.26"]="sha1",b.sha1="1.3.14.3.2.26",b["2.16.840.1.101.3.4.2.1"]="sha256",b.sha256="2.16.840.1.101.3.4.2.1",b["2.16.840.1.101.3.4.2.2"]="sha384",b.sha384="2.16.840.1.101.3.4.2.2",b["2.16.840.1.101.3.4.2.3"]="sha512",b.sha512="2.16.840.1.101.3.4.2.3",b["1.2.840.113549.2.5"]="md5",b.md5="1.2.840.113549.2.5",b["1.2.840.113549.1.7.1"]="data",b.data="1.2.840.113549.1.7.1",b["1.2.840.113549.1.7.2"]="signedData",b.signedData="1.2.840.113549.1.7.2",b["1.2.840.113549.1.7.3"]="envelopedData",b.envelopedData="1.2.840.113549.1.7.3",b["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",b.signedAndEnvelopedData="1.2.840.113549.1.7.4",b["1.2.840.113549.1.7.5"]="digestedData",b.digestedData="1.2.840.113549.1.7.5",b["1.2.840.113549.1.7.6"]="encryptedData",b.encryptedData="1.2.840.113549.1.7.6",b["1.2.840.113549.1.9.1"]="emailAddress",b.emailAddress="1.2.840.113549.1.9.1",b["1.2.840.113549.1.9.2"]="unstructuredName",b.unstructuredName="1.2.840.113549.1.9.2",b["1.2.840.113549.1.9.3"]="contentType",b.contentType="1.2.840.113549.1.9.3",b["1.2.840.113549.1.9.4"]="messageDigest",b.messageDigest="1.2.840.113549.1.9.4",b["1.2.840.113549.1.9.5"]="signingTime",b.signingTime="1.2.840.113549.1.9.5",b["1.2.840.113549.1.9.6"]="counterSignature",b.counterSignature="1.2.840.113549.1.9.6",b["1.2.840.113549.1.9.7"]="challengePassword",b.challengePassword="1.2.840.113549.1.9.7",b["1.2.840.113549.1.9.8"]="unstructuredAddress",b.unstructuredAddress="1.2.840.113549.1.9.8",b["1.2.840.113549.1.9.14"]="extensionRequest",b.extensionRequest="1.2.840.113549.1.9.14",b["1.2.840.113549.1.9.20"]="friendlyName",b.friendlyName="1.2.840.113549.1.9.20",b["1.2.840.113549.1.9.21"]="localKeyId",b.localKeyId="1.2.840.113549.1.9.21",b["1.2.840.113549.1.9.22.1"]="x509Certificate",b.x509Certificate="1.2.840.113549.1.9.22.1",b["1.2.840.113549.1.12.10.1.1"]="keyBag",b.keyBag="1.2.840.113549.1.12.10.1.1",b["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",b.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",b["1.2.840.113549.1.12.10.1.3"]="certBag",b.certBag="1.2.840.113549.1.12.10.1.3",b["1.2.840.113549.1.12.10.1.4"]="crlBag",b.crlBag="1.2.840.113549.1.12.10.1.4",b["1.2.840.113549.1.12.10.1.5"]="secretBag",b.secretBag="1.2.840.113549.1.12.10.1.5",b["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",b.safeContentsBag="1.2.840.113549.1.12.10.1.6",b["1.2.840.113549.1.5.13"]="pkcs5PBES2",b.pkcs5PBES2="1.2.840.113549.1.5.13",b["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",b.pkcs5PBKDF2="1.2.840.113549.1.5.12",b["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",b.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",b["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",b.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",b["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",b["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",b["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",b["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",b["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",b["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",b["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",b["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",b["1.2.840.113549.3.7"]="des-EDE3-CBC",b["des-EDE3-CBC"]="1.2.840.113549.3.7",b["2.16.840.1.101.3.4.1.2"]="aes128-CBC",b["aes128-CBC"]="2.16.840.1.101.3.4.1.2",b["2.16.840.1.101.3.4.1.22"]="aes192-CBC",b["aes192-CBC"]="2.16.840.1.101.3.4.1.22",b["2.16.840.1.101.3.4.1.42"]="aes256-CBC",b["aes256-CBC"]="2.16.840.1.101.3.4.1.42",b["2.5.4.3"]="commonName",b.commonName="2.5.4.3",b["2.5.4.5"]="serialName",b.serialName="2.5.4.5",b["2.5.4.6"]="countryName",b.countryName="2.5.4.6",b["2.5.4.7"]="localityName",b.localityName="2.5.4.7",b["2.5.4.8"]="stateOrProvinceName",b.stateOrProvinceName="2.5.4.8",b["2.5.4.10"]="organizationName",b.organizationName="2.5.4.10",b["2.5.4.11"]="organizationalUnitName",b.organizationalUnitName="2.5.4.11",b["2.16.840.1.113730.1.1"]="nsCertType",b.nsCertType="2.16.840.1.113730.1.1",b["2.5.29.1"]="authorityKeyIdentifier",b["2.5.29.2"]="keyAttributes",b["2.5.29.3"]="certificatePolicies",b["2.5.29.4"]="keyUsageRestriction",b["2.5.29.5"]="policyMapping",b["2.5.29.6"]="subtreesConstraint",b["2.5.29.7"]="subjectAltName",b["2.5.29.8"]="issuerAltName",b["2.5.29.9"]="subjectDirectoryAttributes",b["2.5.29.10"]="basicConstraints",b["2.5.29.11"]="nameConstraints",b["2.5.29.12"]="policyConstraints",b["2.5.29.13"]="basicConstraints",b["2.5.29.14"]="subjectKeyIdentifier",b.subjectKeyIdentifier="2.5.29.14",b["2.5.29.15"]="keyUsage",b.keyUsage="2.5.29.15",b["2.5.29.16"]="privateKeyUsagePeriod",b["2.5.29.17"]="subjectAltName",b.subjectAltName="2.5.29.17",b["2.5.29.18"]="issuerAltName",b.issuerAltName="2.5.29.18",b["2.5.29.19"]="basicConstraints",b.basicConstraints="2.5.29.19",b["2.5.29.20"]="cRLNumber",b["2.5.29.21"]="cRLReason",b["2.5.29.22"]="expirationDate",b["2.5.29.23"]="instructionCode",b["2.5.29.24"]="invalidityDate",b["2.5.29.25"]="cRLDistributionPoints",b["2.5.29.26"]="issuingDistributionPoint",b["2.5.29.27"]="deltaCRLIndicator",b["2.5.29.28"]="issuingDistributionPoint",b["2.5.29.29"]="certificateIssuer",b["2.5.29.30"]="nameConstraints",b["2.5.29.31"]="cRLDistributionPoints",b["2.5.29.32"]="certificatePolicies",b["2.5.29.33"]="policyMappings",b["2.5.29.34"]="policyConstraints",b["2.5.29.35"]="authorityKeyIdentifier",b["2.5.29.36"]="policyConstraints",b["2.5.29.37"]="extKeyUsage",b.extKeyUsage="2.5.29.37",b["2.5.29.46"]="freshestCRL",b["2.5.29.54"]="inhibitAnyPolicy",b["1.3.6.1.5.5.7.3.1"]="serverAuth",b.serverAuth="1.3.6.1.5.5.7.3.1",b["1.3.6.1.5.5.7.3.2"]="clientAuth",b.clientAuth="1.3.6.1.5.5.7.3.2",b["1.3.6.1.5.5.7.3.3"]="codeSigning",b.codeSigning="1.3.6.1.5.5.7.3.3",b["1.3.6.1.5.5.7.3.4"]="emailProtection",b.emailProtection="1.3.6.1.5.5.7.3.4",b["1.3.6.1.5.5.7.3.8"]="timeStamping",b.timeStamping="1.3.6.1.5.5.7.3.8"}var d="oids";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/oids",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1=a.asn1||{};b.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},b.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},b.create=function(b,c,d,e){if(a.util.isArray(e)){for(var f=[],g=0;g<e.length;++g)void 0!==e[g]&&f.push(e[g]);e=f}return{tagClass:b,type:c,constructed:d,composed:d||a.util.isArray(e),value:e}};var c=b.getBerValueLength=function(a){var b=a.getByte();if(128!==b){var c,d=128&b;return c=d?a.getInt((127&b)<<3):b}};b.fromDer=function(d,e){if(void 0===e&&(e=!0),"string"==typeof d&&(d=a.util.createBuffer(d)),d.length()<2){var f=new Error("Too few bytes to parse DER.");throw f.bytes=d.length(),f}var g=d.getByte(),h=192&g,i=31&g,j=c(d);if(d.length()<j){if(e){var f=new Error("Too few bytes to read ASN.1 value.");throw f.detail=d.length()+" < "+j,f}j=d.length()}var k,l=32===(32&g),m=l;if(!m&&h===b.Class.UNIVERSAL&&i===b.Type.BITSTRING&&j>1){var n=d.read,o=d.getByte();if(0===o){g=d.getByte();var p=192&g;if(p===b.Class.UNIVERSAL||p===b.Class.CONTEXT_SPECIFIC)try{var q=c(d);m=q===j-(d.read-n),m&&(++n,--j)}catch(r){}}d.read=n}if(m)if(k=[],void 0===j)for(;;){if(d.bytes(2)===String.fromCharCode(0,0)){d.getBytes(2);break}k.push(b.fromDer(d,e))}else for(var s=d.length();j>0;)k.push(b.fromDer(d,e)),j-=s-d.length(),s=d.length();else{if(void 0===j){if(e)throw new Error("Non-constructed ASN.1 object of indefinite length.");j=d.length()}if(i===b.Type.BMPSTRING){k="";for(var t=0;j>t;t+=2)k+=String.fromCharCode(d.getInt16())}else k=d.getBytes(j)}return b.create(h,i,l,k)},b.toDer=function(c){var d=a.util.createBuffer(),e=c.tagClass|c.type,f=a.util.createBuffer();if(c.composed){c.constructed?e|=32:f.putByte(0);for(var g=0;g<c.value.length;++g)void 0!==c.value[g]&&f.putBuffer(b.toDer(c.value[g]))}else if(c.type===b.Type.BMPSTRING)for(var g=0;g<c.value.length;++g)f.putInt16(c.value.charCodeAt(g));else f.putBytes(c.value);if(d.putByte(e),f.length()<=127)d.putByte(127&f.length());else{var h=f.length(),i="";do i+=String.fromCharCode(255&h),h>>>=8;while(h>0);d.putByte(128|i.length);for(var g=i.length-1;g>=0;--g)d.putByte(i.charCodeAt(g))}return d.putBuffer(f),d},b.oidToDer=function(b){var c=b.split("."),d=a.util.createBuffer();d.putByte(40*parseInt(c[0],10)+parseInt(c[1],10));for(var e,f,g,h,i=2;i<c.length;++i){e=!0,f=[],g=parseInt(c[i],10);do h=127&g,g>>>=7,e||(h|=128),f.push(h),e=!1;while(g>0);for(var j=f.length-1;j>=0;--j)d.putByte(f[j])}return d},b.derToOid=function(b){var c;"string"==typeof b&&(b=a.util.createBuffer(b));var d=b.getByte();c=Math.floor(d/40)+"."+d%40;for(var e=0;b.length()>0;)d=b.getByte(),e<<=7,128&d?e+=127&d:(c+="."+(e+d),e=0);return c},b.utcTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,2),10);c=c>=50?1900+c:2e3+c;var d=parseInt(a.substr(2,2),10)-1,e=parseInt(a.substr(4,2),10),f=parseInt(a.substr(6,2),10),g=parseInt(a.substr(8,2),10),h=0;if(a.length>11){var i=a.charAt(10),j=10;"+"!==i&&"-"!==i&&(h=parseInt(a.substr(10,2),10),j+=2)}if(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,0),j&&(i=a.charAt(j),"+"===i||"-"===i)){var k=parseInt(a.substr(j+1,2),10),l=parseInt(a.substr(j+4,2),10),m=60*k+l;m*=6e4,"+"===i?b.setTime(+b-m):b.setTime(+b+m)}return b},b.generalizedTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,4),10),d=parseInt(a.substr(4,2),10)-1,e=parseInt(a.substr(6,2),10),f=parseInt(a.substr(8,2),10),g=parseInt(a.substr(10,2),10),h=parseInt(a.substr(12,2),10),i=0,j=0,k=!1;"Z"===a.charAt(a.length-1)&&(k=!0);var l=a.length-5,m=a.charAt(l);if("+"===m||"-"===m){var n=parseInt(a.substr(l+1,2),10),o=parseInt(a.substr(l+4,2),10);j=60*n+o,j*=6e4,"+"===m&&(j*=-1),k=!0}return"."===a.charAt(14)&&(i=1e3*parseFloat(a.substr(14),10)),k?(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,i),b.setTime(+b+j)):(b.setFullYear(c,d,e),b.setHours(f,g,h,i)),b},b.dateToUtcTime=function(a){if("string"==typeof a)return a;var b="",c=[];c.push((""+a.getUTCFullYear()).substr(2)),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+="Z"},b.dateToGeneralizedTime=function(a){if("string"==typeof a)return a;var b="",c=[];c.push(""+a.getUTCFullYear()),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+="Z"},b.integerToDer=function(b){var c=a.util.createBuffer();if(b>=-128&&128>b)return c.putSignedInt(b,8);if(b>=-32768&&32768>b)return c.putSignedInt(b,16);if(b>=-8388608&&8388608>b)return c.putSignedInt(b,24);if(b>=-2147483648&&2147483648>b)return c.putSignedInt(b,32);var d=new Error("Integer too large; max is 32-bits.");throw d.integer=b,d},b.derToInteger=function(b){"string"==typeof b&&(b=a.util.createBuffer(b));var c=8*b.length();if(c>32)throw new Error("Integer too large; max is 32-bits.");return b.getSignedInt(c)},b.validate=function(c,d,e,f){var g=!1;if(c.tagClass!==d.tagClass&&"undefined"!=typeof d.tagClass||c.type!==d.type&&"undefined"!=typeof d.type)f&&(c.tagClass!==d.tagClass&&f.push("["+d.name+'] Expected tag class "'+d.tagClass+'", got "'+c.tagClass+'"'),c.type!==d.type&&f.push("["+d.name+'] Expected type "'+d.type+'", got "'+c.type+'"'));else if(c.constructed===d.constructed||"undefined"==typeof d.constructed){if(g=!0,d.value&&a.util.isArray(d.value))for(var h=0,i=0;g&&i<d.value.length;++i)g=d.value[i].optional||!1,c.value[h]&&(g=b.validate(c.value[h],d.value[i],e,f),g?++h:d.value[i].optional&&(g=!0)),!g&&f&&f.push("["+d.name+'] Tag class "'+d.tagClass+'", type "'+d.type+'" expected value length "'+d.value.length+'", got "'+c.value.length+'"');g&&e&&(d.capture&&(e[d.capture]=c.value),d.captureAsn1&&(e[d.captureAsn1]=c))}else f&&f.push("["+d.name+'] Expected constructed "'+d.constructed+'", got "'+c.constructed+'"');return g};var d=/[^\\u0000-\\u00ff]/;b.prettyPrint=function(c,e,f){var g="";e=e||0,f=f||2,e>0&&(g+="\n");for(var h="",i=0;e*f>i;++i)h+=" ";switch(g+=h+"Tag: ",c.tagClass){case b.Class.UNIVERSAL:g+="Universal:";break;case b.Class.APPLICATION:g+="Application:";break;case b.Class.CONTEXT_SPECIFIC:g+="Context-Specific:";break;case b.Class.PRIVATE:g+="Private:"}if(c.tagClass===b.Class.UNIVERSAL)switch(g+=c.type,c.type){case b.Type.NONE:g+=" (None)";break;case b.Type.BOOLEAN:g+=" (Boolean)";break;case b.Type.BITSTRING:g+=" (Bit string)";break;case b.Type.INTEGER:g+=" (Integer)";break;case b.Type.OCTETSTRING:g+=" (Octet string)";break;case b.Type.NULL:g+=" (Null)";break;case b.Type.OID:g+=" (Object Identifier)";break;case b.Type.ODESC:g+=" (Object Descriptor)";break;case b.Type.EXTERNAL:g+=" (External or Instance of)";break;case b.Type.REAL:g+=" (Real)";break;case b.Type.ENUMERATED:g+=" (Enumerated)";break;case b.Type.EMBEDDED:g+=" (Embedded PDV)";break;case b.Type.UTF8:g+=" (UTF8)";break;case b.Type.ROID:g+=" (Relative Object Identifier)";break;case b.Type.SEQUENCE:g+=" (Sequence)";break;case b.Type.SET:g+=" (Set)";break;case b.Type.PRINTABLESTRING:g+=" (Printable String)";break;case b.Type.IA5String:g+=" (IA5String (ASCII))";break;case b.Type.UTCTIME:g+=" (UTC time)";break;case b.Type.GENERALIZEDTIME:g+=" (Generalized time)";break;case b.Type.BMPSTRING:g+=" (BMP String)"}else g+=c.type;if(g+="\n",g+=h+"Constructed: "+c.constructed+"\n",c.composed){for(var j=0,k="",i=0;i<c.value.length;++i)void 0!==c.value[i]&&(j+=1,k+=b.prettyPrint(c.value[i],e+1,f),i+1<c.value.length&&(k+=","));g+=h+"Sub values: "+j+k}else{if(g+=h+"Value: ",c.type===b.Type.OID){var l=b.derToOid(c.value);g+=l,a.pki&&a.pki.oids&&l in a.pki.oids&&(g+=" ("+a.pki.oids[l]+") ")}if(c.type===b.Type.INTEGER)try{g+=b.derToInteger(c.value)}catch(m){g+="0x"+a.util.bytesToHex(c.value)}else c.type===b.Type.OCTETSTRING?(d.test(c.value)||(g+="("+c.value+") "),g+="0x"+a.util.bytesToHex(c.value)):g+=c.type===b.Type.UTF8?a.util.decodeUtf8(c.value):c.type===b.Type.PRINTABLESTRING||c.type===b.Type.IA5String?c.value:d.test(c.value)?"0x"+a.util.bytesToHex(c.value):0===c.value.length?"[null]":c.value}return g}}var d="asn1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/asn1",["require","module","./util","./oids"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){e=String.fromCharCode(128),e+=a.util.fillString(String.fromCharCode(0),64),f=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],g=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],h=new Array(64);for(var b=0;64>b;++b)h[b]=Math.floor(4294967296*Math.abs(Math.sin(b+1)));i=!0}function c(a,b,c){for(var d,e,i,j,k,l,m,n,o=c.length();o>=64;){for(e=a.h0,i=a.h1,j=a.h2,k=a.h3,n=0;16>n;++n)b[n]=c.getInt32Le(),l=k^i&(j^k),d=e+l+h[n]+b[n],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;for(;32>n;++n)l=j^k&(i^j),d=e+l+h[n]+b[f[n]],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;for(;48>n;++n)l=i^j^k,d=e+l+h[n]+b[f[n]],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;for(;64>n;++n)l=j^(i|~k),d=e+l+h[n]+b[f[n]],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;a.h0=a.h0+e|0,a.h1=a.h1+i|0,a.h2=a.h2+j|0,a.h3=a.h3+k|0,o-=64}}var d=a.md5=a.md5||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.md5=a.md.algorithms.md5=d,d.create=function(){i||b();var d=null,f=a.util.createBuffer(),g=new Array(16),h={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return h.start=function(){h.messageLength=0,h.fullMessageLength=h.messageLength64=[];for(var b=h.messageLengthSize/4,c=0;b>c;++c)h.fullMessageLength.push(0);return f=a.util.createBuffer(),d={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},h},h.start(),h.update=function(b,e){"utf8"===e&&(b=a.util.encodeUtf8(b));var i=b.length;h.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var j=h.fullMessageLength.length-1;j>=0;--j)h.fullMessageLength[j]+=i[1],i[1]=i[0]+(h.fullMessageLength[j]/4294967296>>>0),h.fullMessageLength[j]=h.fullMessageLength[j]>>>0,i[0]=i[1]/4294967296>>>0;return f.putBytes(b),c(d,g,f),(f.read>2048||0===f.length())&&f.compact(),h},h.digest=function(){var b=a.util.createBuffer();b.putBytes(f.bytes());var i=h.fullMessageLength[h.fullMessageLength.length-1]+h.messageLengthSize,j=i&h.blockLength-1;b.putBytes(e.substr(0,h.blockLength-j));for(var k,l=0,m=h.fullMessageLength.length-1;m>=0;--m)k=8*h.fullMessageLength[m]+l,l=k/4294967296>>>0,b.putInt32Le(k>>>0);var n={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3};c(n,g,b);var o=a.util.createBuffer();return o.putInt32Le(n.h0),o.putInt32Le(n.h1),o.putInt32Le(n.h2),o.putInt32Le(n.h3),o},h};var e=null,f=null,g=null,h=null,i=!1}var d="md5";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md5",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){e=String.fromCharCode(128),e+=a.util.fillString(String.fromCharCode(0),64),f=!0}function c(a,b,c){for(var d,e,f,g,h,i,j,k,l=c.length();l>=64;){for(e=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4,k=0;16>k;++k)d=c.getInt32(),b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;20>k;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;32>k;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;40>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;60>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f&g|h&(f^g),d=(e<<5|e>>>27)+j+i+2400959708+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;80>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+3395469782+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;a.h0=a.h0+e|0,a.h1=a.h1+f|0,a.h2=a.h2+g|0,a.h3=a.h3+h|0,a.h4=a.h4+i|0,l-=64}}var d=a.sha1=a.sha1||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha1=a.md.algorithms.sha1=d,d.create=function(){f||b();var d=null,g=a.util.createBuffer(),h=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var b=i.messageLengthSize/4,c=0;b>c;++c)i.fullMessageLength.push(0);return g=a.util.createBuffer(),d={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(b,e){"utf8"===e&&(b=a.util.encodeUtf8(b));var f=b.length;i.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var j=i.fullMessageLength.length-1;j>=0;--j)i.fullMessageLength[j]+=f[1],f[1]=f[0]+(i.fullMessageLength[j]/4294967296>>>0),i.fullMessageLength[j]=i.fullMessageLength[j]>>>0,f[0]=f[1]/4294967296>>>0;return g.putBytes(b),c(d,h,g),(g.read>2048||0===g.length())&&g.compact(),i},i.digest=function(){var b=a.util.createBuffer();b.putBytes(g.bytes());var f=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,j=f&i.blockLength-1;b.putBytes(e.substr(0,i.blockLength-j));for(var k,l,m=(a.util.createBuffer(),8*i.fullMessageLength[0]),n=0;n<i.fullMessageLength.length;++n)k=8*i.fullMessageLength[n+1],l=k/4294967296>>>0,m+=l,b.putInt32(m>>>0),m=k;var o={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4};c(o,h,b);var p=a.util.createBuffer();return p.putInt32(o.h0),p.putInt32(o.h1),p.putInt32(o.h2),p.putInt32(o.h3),p.putInt32(o.h4),p},i};var e=null,f=!1}var d="sha1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha1",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){e=String.fromCharCode(128),e+=a.util.fillString(String.fromCharCode(0),64),g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],
f=!0}function c(a,b,c){for(var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t=c.length();t>=64;){for(k=0;16>k;++k)b[k]=c.getInt32();for(;64>k;++k)d=b[k-2],d=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,e=b[k-15],e=(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3,b[k]=d+b[k-7]+e+b[k-16]|0;for(l=a.h0,m=a.h1,n=a.h2,o=a.h3,p=a.h4,q=a.h5,r=a.h6,s=a.h7,k=0;64>k;++k)h=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),i=r^p&(q^r),f=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),j=l&m|n&(l^m),d=s+h+i+g[k]+b[k],e=f+j,s=r,r=q,q=p,p=o+d|0,o=n,n=m,m=l,l=d+e|0;a.h0=a.h0+l|0,a.h1=a.h1+m|0,a.h2=a.h2+n|0,a.h3=a.h3+o|0,a.h4=a.h4+p|0,a.h5=a.h5+q|0,a.h6=a.h6+r|0,a.h7=a.h7+s|0,t-=64}}var d=a.sha256=a.sha256||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha256=a.md.algorithms.sha256=d,d.create=function(){f||b();var d=null,g=a.util.createBuffer(),h=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var b=i.messageLengthSize/4,c=0;b>c;++c)i.fullMessageLength.push(0);return g=a.util.createBuffer(),d={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(b,e){"utf8"===e&&(b=a.util.encodeUtf8(b));var f=b.length;i.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var j=i.fullMessageLength.length-1;j>=0;--j)i.fullMessageLength[j]+=f[1],f[1]=f[0]+(i.fullMessageLength[j]/4294967296>>>0),i.fullMessageLength[j]=i.fullMessageLength[j]>>>0,f[0]=f[1]/4294967296>>>0;return g.putBytes(b),c(d,h,g),(g.read>2048||0===g.length())&&g.compact(),i},i.digest=function(){var b=a.util.createBuffer();b.putBytes(g.bytes());var f=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,j=f&i.blockLength-1;b.putBytes(e.substr(0,i.blockLength-j));for(var k,l,m=(a.util.createBuffer(),8*i.fullMessageLength[0]),n=0;n<i.fullMessageLength.length;++n)k=8*i.fullMessageLength[n+1],l=k/4294967296>>>0,m+=l,b.putInt32(m>>>0),m=k;var o={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4,h5:d.h5,h6:d.h6,h7:d.h7};c(o,h,b);var p=a.util.createBuffer();return p.putInt32(o.h0),p.putInt32(o.h1),p.putInt32(o.h2),p.putInt32(o.h3),p.putInt32(o.h4),p.putInt32(o.h5),p.putInt32(o.h6),p.putInt32(o.h7),p},i};var e=null,f=!1,g=null}var d="sha256";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha256",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){f=String.fromCharCode(128),f+=a.util.fillString(String.fromCharCode(0),128),h=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],i={},i["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],i["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],i["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],i["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],g=!0}function c(a,b,c){for(var d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=c.length();N>=128;){for(G=0;16>G;++G)b[G][0]=c.getInt32()>>>0,b[G][1]=c.getInt32()>>>0;for(;80>G;++G)J=b[G-2],H=J[0],I=J[1],d=((H>>>19|I<<13)^(I>>>29|H<<3)^H>>>6)>>>0,e=((H<<13|I>>>19)^(I<<3|H>>>29)^(H<<26|I>>>6))>>>0,L=b[G-15],H=L[0],I=L[1],f=((H>>>1|I<<31)^(H>>>8|I<<24)^H>>>7)>>>0,g=((H<<31|I>>>1)^(H<<24|I>>>8)^(H<<25|I>>>7))>>>0,K=b[G-7],M=b[G-16],I=e+K[1]+g+M[1],b[G][0]=d+K[0]+f+M[0]+(I/4294967296>>>0)>>>0,b[G][1]=I>>>0;for(q=a[0][0],r=a[0][1],s=a[1][0],t=a[1][1],u=a[2][0],v=a[2][1],w=a[3][0],x=a[3][1],y=a[4][0],z=a[4][1],A=a[5][0],B=a[5][1],C=a[6][0],D=a[6][1],E=a[7][0],F=a[7][1],G=0;80>G;++G)k=((y>>>14|z<<18)^(y>>>18|z<<14)^(z>>>9|y<<23))>>>0,l=((y<<18|z>>>14)^(y<<14|z>>>18)^(z<<23|y>>>9))>>>0,m=(C^y&(A^C))>>>0,n=(D^z&(B^D))>>>0,i=((q>>>28|r<<4)^(r>>>2|q<<30)^(r>>>7|q<<25))>>>0,j=((q<<4|r>>>28)^(r<<30|q>>>2)^(r<<25|q>>>7))>>>0,o=(q&s|u&(q^s))>>>0,p=(r&t|v&(r^t))>>>0,I=F+l+n+h[G][1]+b[G][1],d=E+k+m+h[G][0]+b[G][0]+(I/4294967296>>>0)>>>0,e=I>>>0,I=j+p,f=i+o+(I/4294967296>>>0)>>>0,g=I>>>0,E=C,F=D,C=A,D=B,A=y,B=z,I=x+e,y=w+d+(I/4294967296>>>0)>>>0,z=I>>>0,w=u,x=v,u=s,v=t,s=q,t=r,I=e+g,q=d+f+(I/4294967296>>>0)>>>0,r=I>>>0;I=a[0][1]+r,a[0][0]=a[0][0]+q+(I/4294967296>>>0)>>>0,a[0][1]=I>>>0,I=a[1][1]+t,a[1][0]=a[1][0]+s+(I/4294967296>>>0)>>>0,a[1][1]=I>>>0,I=a[2][1]+v,a[2][0]=a[2][0]+u+(I/4294967296>>>0)>>>0,a[2][1]=I>>>0,I=a[3][1]+x,a[3][0]=a[3][0]+w+(I/4294967296>>>0)>>>0,a[3][1]=I>>>0,I=a[4][1]+z,a[4][0]=a[4][0]+y+(I/4294967296>>>0)>>>0,a[4][1]=I>>>0,I=a[5][1]+B,a[5][0]=a[5][0]+A+(I/4294967296>>>0)>>>0,a[5][1]=I>>>0,I=a[6][1]+D,a[6][0]=a[6][0]+C+(I/4294967296>>>0)>>>0,a[6][1]=I>>>0,I=a[7][1]+F,a[7][0]=a[7][0]+E+(I/4294967296>>>0)>>>0,a[7][1]=I>>>0,N-=128}}var d=a.sha512=a.sha512||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha512=a.md.algorithms.sha512=d;var e=a.sha384=a.sha512.sha384=a.sha512.sha384||{};e.create=function(){return d.create("SHA-384")},a.md.sha384=a.md.algorithms.sha384=e,a.sha512.sha256=a.sha512.sha256||{create:function(){return d.create("SHA-512/256")}},a.md["sha512/256"]=a.md.algorithms["sha512/256"]=a.sha512.sha256,a.sha512.sha224=a.sha512.sha224||{create:function(){return d.create("SHA-512/224")}},a.md["sha512/224"]=a.md.algorithms["sha512/224"]=a.sha512.sha224,d.create=function(d){if(g||b(),"undefined"==typeof d&&(d="SHA-512"),!(d in i))throw new Error("Invalid SHA-512 algorithm: "+d);for(var e=i[d],h=null,j=a.util.createBuffer(),k=new Array(80),l=0;80>l;++l)k[l]=new Array(2);var m={algorithm:d.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,fullMessageLength:null,messageLengthSize:16};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength128=[];for(var b=m.messageLengthSize/4,c=0;b>c;++c)m.fullMessageLength.push(0);j=a.util.createBuffer(),h=new Array(e.length);for(var c=0;c<e.length;++c)h[c]=e[c].slice(0);return m},m.start(),m.update=function(b,d){"utf8"===d&&(b=a.util.encodeUtf8(b));var e=b.length;m.messageLength+=e,e=[e/4294967296>>>0,e>>>0];for(var f=m.fullMessageLength.length-1;f>=0;--f)m.fullMessageLength[f]+=e[1],e[1]=e[0]+(m.fullMessageLength[f]/4294967296>>>0),m.fullMessageLength[f]=m.fullMessageLength[f]>>>0,e[0]=e[1]/4294967296>>>0;return j.putBytes(b),c(h,k,j),(j.read>2048||0===j.length())&&j.compact(),m},m.digest=function(){var b=a.util.createBuffer();b.putBytes(j.bytes());var e=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,g=e&m.blockLength-1;b.putBytes(f.substr(0,m.blockLength-g));for(var i,l,n=(a.util.createBuffer(),8*m.fullMessageLength[0]),o=0;o<m.fullMessageLength.length;++o)i=8*m.fullMessageLength[o+1],l=i/4294967296>>>0,n+=l,b.putInt32(n>>>0),n=i;for(var p=new Array(h.length),o=0;o<h.length;++o)p[o]=h[o].slice(0);c(p,k,b);var q,r=a.util.createBuffer();q="SHA-512"===d?p.length:"SHA-384"===d?p.length-2:p.length-4;for(var o=0;q>o;++o)r.putInt32(p[o][0]),(o!==q-1||"SHA-512/224"!==d)&&r.putInt32(p[o][1]);return r},m};var f=null,g=!1,h=null,i=null}var d="sha512";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha512",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.md=a.md||{},a.md.algorithms={md5:a.md5,sha1:a.sha1,sha256:a.sha256},a.md.md5=a.md5,a.md.sha1=a.sha1,a.md.sha256=a.sha256}var d="md";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md",["require","module","./md5","./sha1","./sha256","./sha512"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.hmac=a.hmac||{};b.create=function(){var b=null,c=null,d=null,e=null,f={};return f.start=function(f,g){if(null!==f)if("string"==typeof f){if(f=f.toLowerCase(),!(f in a.md.algorithms))throw new Error('Unknown hash algorithm "'+f+'"');c=a.md.algorithms[f].create()}else c=f;if(null===g)g=b;else{if("string"==typeof g)g=a.util.createBuffer(g);else if(a.util.isArray(g)){var h=g;g=a.util.createBuffer();for(var i=0;i<h.length;++i)g.putByte(h[i])}var j=g.length();j>c.blockLength&&(c.start(),c.update(g.bytes()),g=c.digest()),d=a.util.createBuffer(),e=a.util.createBuffer(),j=g.length();for(var i=0;j>i;++i){var h=g.at(i);d.putByte(54^h),e.putByte(92^h)}if(j<c.blockLength)for(var h=c.blockLength-j,i=0;h>i;++i)d.putByte(54),e.putByte(92);b=g,d=d.bytes(),e=e.bytes()}c.start(),c.update(d)},f.update=function(a){c.update(a)},f.getMac=function(){var a=c.digest().bytes();return c.start(),c.update(e),c.update(a),c.digest()},f.digest=f.getMac,f}}var d="hmac";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/hmac",["require","module","./md","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a){for(var b=a.name+": ",c=[],d=function(a,b){return" "+b},e=0;e<a.values.length;++e)c.push(a.values[e].replace(/^(\S+\r\n)/,d));b+=c.join(",")+"\r\n";for(var f=0,g=-1,e=0;e<b.length;++e,++f)if(f>65&&-1!==g){var h=b[g];","===h?(++g,b=b.substr(0,g)+"\r\n "+b.substr(g)):b=b.substr(0,g)+"\r\n"+h+b.substr(g+1),f=e-g-1,g=-1,++e}else(" "===b[e]||"	"===b[e]||","===b[e])&&(g=e);return b}function c(a){return a.replace(/^\s+/,"")}var d=a.pem=a.pem||{};d.encode=function(c,d){d=d||{};var e,f="-----BEGIN "+c.type+"-----\r\n";if(c.procType&&(e={name:"Proc-Type",values:[String(c.procType.version),c.procType.type]},f+=b(e)),c.contentDomain&&(e={name:"Content-Domain",values:[c.contentDomain]},f+=b(e)),c.dekInfo&&(e={name:"DEK-Info",values:[c.dekInfo.algorithm]},c.dekInfo.parameters&&e.values.push(c.dekInfo.parameters),f+=b(e)),c.headers)for(var g=0;g<c.headers.length;++g)f+=b(c.headers[g]);return c.procType&&(f+="\r\n"),f+=a.util.encode64(c.body,d.maxline||64)+"\r\n",f+="-----END "+c.type+"-----\r\n"},d.decode=function(b){for(var d,e=[],f=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,g=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/;;){if(d=f.exec(b),!d)break;var i={type:d[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(d[3])};if(e.push(i),d[2]){for(var j=d[2].split(h),k=0;d&&k<j.length;){for(var l=j[k].replace(/\s+$/,""),m=k+1;m<j.length;++m){var n=j[m];if(!/\s/.test(n[0]))break;l+=n,k=m}if(d=l.match(g)){for(var o={name:d[1],values:[]},p=d[2].split(","),q=0;q<p.length;++q)o.values.push(c(p[q]));if(i.procType)if(i.contentDomain||"Content-Domain"!==o.name)if(i.dekInfo||"DEK-Info"!==o.name)i.headers.push(o);else{if(0===o.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');i.dekInfo={algorithm:p[0],parameters:p[1]||null}}else i.contentDomain=p[0]||"";else{if("Proc-Type"!==o.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==o.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');i.procType={version:p[0],type:p[1]}}}++k}if("ENCRYPTED"===i.procType&&!i.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===e.length)throw new Error("Invalid PEM formatted message.");return e}}var d="pem";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pem",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c){var d=function(){return new a.des.Algorithm(b,c)};a.cipher.registerAlgorithm(b,d)}function c(a){for(var b,c=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],d=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],e=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],f=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],h=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],i=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],j=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],k=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],m=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],n=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],o=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],q=a.length()>8?3:1,r=[],s=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],t=0,u=0;q>u;u++){var v=a.getInt32(),w=a.getInt32();b=252645135&(v>>>4^w),w^=b,v^=b<<4,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=858993459&(v>>>2^w),w^=b,v^=b<<2,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=16711935&(w>>>8^v),v^=b,w^=b<<8,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=v<<8|w>>>20&240,v=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=b;for(var x=0;x<s.length;++x){s[x]?(v=v<<2|v>>>26,w=w<<2|w>>>26):(v=v<<1|v>>>27,w=w<<1|w>>>27),v&=-15,w&=-15;var y=c[v>>>28]|d[v>>>24&15]|e[v>>>20&15]|f[v>>>16&15]|g[v>>>12&15]|h[v>>>8&15]|i[v>>>4&15],z=j[w>>>28]|k[w>>>24&15]|l[w>>>20&15]|m[w>>>16&15]|n[w>>>12&15]|o[w>>>8&15]|p[w>>>4&15];b=65535&(z>>>16^y),r[t++]=y^b,r[t++]=z^b<<16}}return r}function d(a,b,c,d){var e,n=32===a.length?3:9;e=3===n?d?[30,-2,-2]:[0,32,2]:d?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,p=b[0],q=b[1];o=252645135&(p>>>4^q),q^=o,p^=o<<4,o=65535&(p>>>16^q),q^=o,p^=o<<16,o=858993459&(q>>>2^p),p^=o,q^=o<<2,o=16711935&(q>>>8^p),p^=o,q^=o<<8,o=1431655765&(p>>>1^q),q^=o,p^=o<<1,p=p<<1|p>>>31,q=q<<1|q>>>31;for(var r=0;n>r;r+=3){for(var s=e[r+1],t=e[r+2],u=e[r];u!=s;u+=t){var v=q^a[u],w=(q>>>4|q<<28)^a[u+1];o=p,p=q,q=o^(g[v>>>24&63]|i[v>>>16&63]|k[v>>>8&63]|m[63&v]|f[w>>>24&63]|h[w>>>16&63]|j[w>>>8&63]|l[63&w])}o=p,p=q,q=o}p=p>>>1|p<<31,q=q>>>1|q<<31,o=1431655765&(p>>>1^q),q^=o,p^=o<<1,o=16711935&(q>>>8^p),p^=o,q^=o<<8,o=858993459&(q>>>2^p),p^=o,q^=o<<2,o=65535&(p>>>16^q),q^=o,p^=o<<16,o=252645135&(p>>>4^q),q^=o,p^=o<<4,c[0]=p,c[1]=q}function e(b){b=b||{};var c,d=(b.mode||"CBC").toUpperCase(),e="DES-"+d;c=b.decrypt?a.cipher.createDecipher(e,b.key):a.cipher.createCipher(e,b.key);var f=c.start;return c.start=function(b,d){var e=null;d instanceof a.util.ByteBuffer&&(e=d,d={}),d=d||{},d.output=e,d.iv=b,f.call(c,d)},c}a.des=a.des||{},a.des.startEncrypting=function(a,b,c,d){var f=e({key:a,output:c,decrypt:!1,mode:d||(null===b?"ECB":"CBC")});return f.start(b),f},a.des.createEncryptionCipher=function(a,b){return e({key:a,output:null,decrypt:!1,mode:b})},a.des.startDecrypting=function(a,b,c,d){var f=e({key:a,output:c,decrypt:!0,mode:d||(null===b?"ECB":"CBC")});return f.start(b),f},a.des.createDecryptionCipher=function(a,b){return e({key:a,output:null,decrypt:!0,mode:b})},a.des.Algorithm=function(a,b){var c=this;c.name=a,c.mode=new b({blockSize:8,cipher:{encrypt:function(a,b){return d(c._keys,a,b,!1)},decrypt:function(a,b){return d(c._keys,a,b,!0)}}}),c._init=!1},a.des.Algorithm.prototype.initialize=function(b){if(!this._init){var d=a.util.createBuffer(b.key);if(0===this.name.indexOf("3DES")&&24!==d.length())throw new Error("Invalid Triple-DES key size: "+8*d.length());this._keys=c(d),this._init=!0}},b("DES-ECB",a.cipher.modes.ecb),b("DES-CBC",a.cipher.modes.cbc),b("DES-CFB",a.cipher.modes.cfb),b("DES-OFB",a.cipher.modes.ofb),b("DES-CTR",a.cipher.modes.ctr),b("3DES-ECB",a.cipher.modes.ecb),b("3DES-CBC",a.cipher.modes.cbc),b("3DES-CFB",a.cipher.modes.cfb),b("3DES-OFB",a.cipher.modes.ofb),b("3DES-CTR",a.cipher.modes.ctr);var f=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],g=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],h=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],i=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],j=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],k=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],l=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],m=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]}var d="des";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/des",["require","module","./cipher","./cipherModes","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var c,d=a.pkcs5=a.pkcs5||{},e="undefined"!=typeof process&&process.versions&&process.versions.node;e&&!a.disableNativeCode&&(c=b("crypto")),a.pbkdf2=d.pbkdf2=function(b,d,f,g,h,i){function j(){return u>n?i(null,t):(p.start(null,null),p.update(d),p.update(a.util.int32ToBytes(u)),q=s=p.digest().getBytes(),v=2,void k())}function k(){return f>=v?(p.start(null,null),p.update(s),r=p.digest().getBytes(),q=a.util.xorBytes(q,r,l),s=r,++v,a.util.setImmediate(k)):(t+=n>u?q:q.substr(0,o),++u,void j())}if("function"==typeof h&&(i=h,h=null),e&&!a.disableNativeCode&&c.pbkdf2&&(null===h||"object"!=typeof h)&&(c.pbkdf2Sync.length>4||!h||"sha1"===h))return"string"!=typeof h&&(h="sha1"),d=new Buffer(d,"binary"),i?4===c.pbkdf2Sync.length?c.pbkdf2(b,d,f,g,function(a,b){return a?i(a):void i(null,b.toString("binary"))}):c.pbkdf2(b,d,f,g,h,function(a,b){return a?i(a):void i(null,b.toString("binary"))}):4===c.pbkdf2Sync.length?c.pbkdf2Sync(b,d,f,g).toString("binary"):c.pbkdf2Sync(b,d,f,g,h).toString("binary");if(("undefined"==typeof h||null===h)&&(h=a.md.sha1.create()),"string"==typeof h){if(!(h in a.md.algorithms))throw new Error("Unknown hash algorithm: "+h);h=a.md[h].create()}var l=h.digestLength;if(g>4294967295*l){var m=new Error("Derived key is too long.");if(i)return i(m);throw m}var n=Math.ceil(g/l),o=g-(n-1)*l,p=a.hmac.create();p.start(h,b);var q,r,s,t="";if(!i){for(var u=1;n>=u;++u){p.start(null,null),p.update(d),p.update(a.util.int32ToBytes(u)),q=s=p.digest().getBytes();for(var v=2;f>=v;++v)p.start(null,null),p.update(s),r=p.digest().getBytes(),q=a.util.xorBytes(q,r,l),s=r;t+=n>u?q:q.substr(0,o)}return t}var v,u=1;j()}}var d="pbkdf2";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var c="undefined"!=typeof process&&process.versions&&process.versions.node,d=null;a.disableNativeCode||!c||process.versions["node-webkit"]||(d=b("crypto"));var e=a.prng=a.prng||{};e.create=function(b){function c(a){if(h.pools[0].messageLength>=32)return f(),a();var b=32-h.pools[0].messageLength<<5;h.seedFile(b,function(b,c){return b?a(b):(h.collect(c),f(),void a())})}function e(){if(h.pools[0].messageLength>=32)return f();var a=32-h.pools[0].messageLength<<5;h.collect(h.seedFileSync(a)),f()}function f(){var a=h.plugin.md.create();a.update(h.pools[0].digest().getBytes()),h.pools[0].start();for(var b=1,c=1;32>c;++c)b=31===b?2147483648:b<<2,b%h.reseeds===0&&(a.update(h.pools[c].digest().getBytes()),h.pools[c].start());var d=a.digest().getBytes();a.start(),a.update(d);var e=a.digest().getBytes();h.key=h.plugin.formatKey(d),h.seed=h.plugin.formatSeed(e),h.reseeds=4294967295===h.reseeds?0:h.reseeds+1,h.generated=0}function g(b){var c=null;if("undefined"!=typeof window){var d=window.crypto||window.msCrypto;d&&d.getRandomValues&&(c=function(a){return d.getRandomValues(a)})}var e=a.util.createBuffer();if(c)for(;e.length()<b;){var f=Math.max(1,Math.min(b-e.length(),65536)/4),g=new Uint32Array(Math.floor(f));try{c(g);for(var h=0;h<g.length;++h)e.putInt32(g[h])}catch(i){if(!("undefined"!=typeof QuotaExceededError&&i instanceof QuotaExceededError))throw i}}if(e.length()<b)for(var j,k,l,m=Math.floor(65536*Math.random());e.length()<b;){k=16807*(65535&m),j=16807*(m>>16),k+=(32767&j)<<16,k+=j>>15,k=(2147483647&k)+(k>>31),m=4294967295&k;for(var h=0;3>h;++h)l=m>>>(h<<3),l^=Math.floor(256*Math.random()),e.putByte(String.fromCharCode(255&l))}return e.getBytes(b)}for(var h={plugin:b,key:null,seed:null,time:null,reseeds:0,generated:0},i=b.md,j=new Array(32),k=0;32>k;++k)j[k]=i.create();return h.pools=j,h.pool=0,h.generate=function(b,d){function e(l){if(l)return d(l);if(k.length()>=b)return d(null,k.getBytes(b));if(h.generated>1048575&&(h.key=null),null===h.key)return a.util.nextTick(function(){c(e)});var m=f(h.key,h.seed);h.generated+=m.length,k.putBytes(m),h.key=i(f(h.key,g(h.seed))),h.seed=j(f(h.key,h.seed)),a.util.setImmediate(e)}if(!d)return h.generateSync(b);var f=h.plugin.cipher,g=h.plugin.increment,i=h.plugin.formatKey,j=h.plugin.formatSeed,k=a.util.createBuffer();h.key=null,e()},h.generateSync=function(b){var c=h.plugin.cipher,d=h.plugin.increment,f=h.plugin.formatKey,g=h.plugin.formatSeed;h.key=null;for(var i=a.util.createBuffer();i.length()<b;){h.generated>1048575&&(h.key=null),null===h.key&&e();var j=c(h.key,h.seed);h.generated+=j.length,i.putBytes(j),h.key=f(c(h.key,d(h.seed))),h.seed=g(c(h.key,h.seed))}return i.getBytes(b)},d?(h.seedFile=function(a,b){d.randomBytes(a,function(a,c){return a?b(a):void b(null,c.toString())})},h.seedFileSync=function(a){return d.randomBytes(a).toString()}):(h.seedFile=function(a,b){try{b(null,g(a))}catch(c){b(c)}},h.seedFileSync=g),h.collect=function(a){for(var b=a.length,c=0;b>c;++c)h.pools[h.pool].update(a.substr(c,1)),h.pool=31===h.pool?0:h.pool+1},h.collectInt=function(a,b){for(var c="",d=0;b>d;d+=8)c+=String.fromCharCode(a>>d&255);h.collect(c)},h.registerWorker=function(a){if(a===self)h.seedFile=function(a,b){function c(a){var d=a.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",c),b(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",c),self.postMessage({forge:{prng:{needed:a}}})};else{var b=function(b){var c=b.data;c.forge&&c.forge.prng&&h.seedFile(c.forge.prng.needed,function(b,c){a.postMessage({forge:{prng:{err:b,bytes:c}}})})};a.addEventListener("message",b)}},h}}var d="prng";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},
c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prng",["require","module","./md","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.random&&a.random.getBytes||!function(b){function c(){var b=a.prng.create(d);return b.getBytes=function(a,c){return b.generate(a,c)},b.getBytesSync=function(a){return b.generate(a)},b}var d={},e=new Array(4),f=a.util.createBuffer();d.formatKey=function(b){var c=a.util.createBuffer(b);return b=new Array(4),b[0]=c.getInt32(),b[1]=c.getInt32(),b[2]=c.getInt32(),b[3]=c.getInt32(),a.aes._expandKey(b,!1)},d.formatSeed=function(b){var c=a.util.createBuffer(b);return b=new Array(4),b[0]=c.getInt32(),b[1]=c.getInt32(),b[2]=c.getInt32(),b[3]=c.getInt32(),b},d.cipher=function(b,c){return a.aes._updateBlock(b,c,e,!1),f.putInt32(e[0]),f.putInt32(e[1]),f.putInt32(e[2]),f.putInt32(e[3]),f.getBytes()},d.increment=function(a){return++a[3],a},d.md=a.md.sha256;var g=c(),h="undefined"!=typeof process&&process.versions&&process.versions.node,i=null;if("undefined"!=typeof window){var j=window.crypto||window.msCrypto;j&&j.getRandomValues&&(i=function(a){return j.getRandomValues(a)})}if(a.disableNativeCode||!h&&!i){if("undefined"==typeof window||void 0===window.document,g.collectInt(+new Date,32),"undefined"!=typeof navigator){var k="";for(var l in navigator)try{"string"==typeof navigator[l]&&(k+=navigator[l])}catch(m){}g.collect(k),k=null}b&&(b().mousemove(function(a){g.collectInt(a.clientX,16),g.collectInt(a.clientY,16)}),b().keypress(function(a){g.collectInt(a.charCode,8)}))}if(a.random)for(var l in g)a.random[l]=g[l];else a.random=g;a.random.createInstance=c}("undefined"!=typeof jQuery?jQuery:null)}var d="random";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/random",["require","module","./aes","./md","./prng","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],c=[1,2,3,5],d=function(a,b){return a<<b&65535|(65535&a)>>16-b},e=function(a,b){return(65535&a)>>b|a<<16-b&65535};a.rc2=a.rc2||{},a.rc2.expandKey=function(c,d){"string"==typeof c&&(c=a.util.createBuffer(c)),d=d||128;var e,f=c,g=c.length(),h=d,i=Math.ceil(h/8),j=255>>(7&h);for(e=g;128>e;e++)f.putByte(b[f.at(e-1)+f.at(e-g)&255]);for(f.setAt(128-i,b[f.at(128-i)&j]),e=127-i;e>=0;e--)f.setAt(e,b[f.at(e+1)^f.at(e+i)]);return f};var f=function(b,f,g){var h,i,j,k,l=!1,m=null,n=null,o=null,p=[];for(b=a.rc2.expandKey(b,f),j=0;64>j;j++)p.push(b.getInt16Le());g?(h=function(a){for(j=0;4>j;j++)a[j]+=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),a[j]=d(a[j],c[j]),k++},i=function(a){for(j=0;4>j;j++)a[j]+=p[63&a[(j+3)%4]]}):(h=function(a){for(j=3;j>=0;j--)a[j]=e(a[j],c[j]),a[j]-=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),k--},i=function(a){for(j=3;j>=0;j--)a[j]-=p[63&a[(j+3)%4]]});var q=function(a){var b=[];for(j=0;4>j;j++){var c=m.getInt16Le();null!==o&&(g?c^=o.getInt16Le():o.putInt16Le(c)),b.push(65535&c)}k=g?0:63;for(var d=0;d<a.length;d++)for(var e=0;e<a[d][0];e++)a[d][1](b);for(j=0;4>j;j++)null!==o&&(g?o.putInt16Le(b[j]):b[j]^=o.getInt16Le()),n.putInt16Le(b[j])},r=null;return r={start:function(b,c){b&&"string"==typeof b&&(b=a.util.createBuffer(b)),l=!1,m=a.util.createBuffer(),n=c||new a.util.createBuffer,o=b,r.output=n},update:function(a){for(l||m.putBuffer(a);m.length()>=8;)q([[5,h],[1,i],[6,h],[1,i],[5,h]])},finish:function(a){var b=!0;if(g)if(a)b=a(8,m,!g);else{var c=8===m.length()?8:8-m.length();m.fillWithByte(c,c)}if(b&&(l=!0,r.update()),!g&&(b=0===m.length()))if(a)b=a(8,n,!g);else{var d=n.length(),e=n.at(d-1);e>d?b=!1:n.truncate(e)}return b}}};a.rc2.startEncrypting=function(b,c,d){var e=a.rc2.createEncryptionCipher(b,128);return e.start(c,d),e},a.rc2.createEncryptionCipher=function(a,b){return f(a,b,!0)},a.rc2.startDecrypting=function(b,c,d){var e=a.rc2.createDecryptionCipher(b,128);return e.start(c,d),e},a.rc2.createDecryptionCipher=function(a,b){return f(a,b,!1)}}var d="rc2";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rc2",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,c){this.data=[],null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function c(){return new b(null)}function d(a,b,c,d,e,f){for(;--f>=0;){var g=b*this.data[a++]+c.data[d]+e;e=Math.floor(g/67108864),c.data[d++]=67108863&g}return e}function e(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this.data[a],j=this.data[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c.data[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c.data[d++]=1073741823&i}return e}function f(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this.data[a],j=this.data[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c.data[d]+e,e=(i>>28)+(k>>14)+h*j,c.data[d++]=268435455&i}return e}function g(a){return fb.charAt(a)}function h(a,b){var c=gb[a.charCodeAt(b)];return null==c?-1:c}function i(a){for(var b=this.t-1;b>=0;--b)a.data[b]=this.data[b];a.t=this.t,a.s=this.s}function j(a){this.t=1,this.s=0>a?-1:0,a>0?this.data[0]=a:-1>a?this.data[0]=a+this.DV:this.t=0}function k(a){var b=c();return b.fromInt(a),b}function l(a,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(a,c);d=2}this.t=0,this.s=0;for(var e=a.length,f=!1,g=0;--e>=0;){var i=8==d?255&a[e]:h(a,e);0>i?"-"==a.charAt(e)&&(f=!0):(f=!1,0==g?this.data[this.t++]=i:g+d>this.DB?(this.data[this.t-1]|=(i&(1<<this.DB-g)-1)<<g,this.data[this.t++]=i>>this.DB-g):this.data[this.t-1]|=i<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&a[0])&&(this.s=-1,g>0&&(this.data[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&b.ZERO.subTo(this,this)}function m(){for(var a=this.s&this.DM;this.t>0&&this.data[this.t-1]==a;)--this.t}function n(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",h=this.t,i=this.DB-h*this.DB%b;if(h-- >0)for(i<this.DB&&(c=this.data[h]>>i)>0&&(e=!0,f=g(c));h>=0;)b>i?(c=(this.data[h]&(1<<i)-1)<<b-i,c|=this.data[--h]>>(i+=this.DB-b)):(c=this.data[h]>>(i-=b)&d,0>=i&&(i+=this.DB,--h)),c>0&&(e=!0),e&&(f+=g(c));return e?f:"0"}function o(){var a=c();return b.ZERO.subTo(this,a),a}function p(){return this.s<0?this.negate():this}function q(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this.data[c]-a.data[c]))return b;return 0}function r(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function s(){return this.t<=0?0:this.DB*(this.t-1)+r(this.data[this.t-1]^this.s&this.DM)}function t(a,b){var c;for(c=this.t-1;c>=0;--c)b.data[c+a]=this.data[c];for(c=a-1;c>=0;--c)b.data[c]=0;b.t=this.t+a,b.s=this.s}function u(a,b){for(var c=a;c<this.t;++c)b.data[c-a]=this.data[c];b.t=Math.max(this.t-a,0),b.s=this.s}function v(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b.data[c+g+1]=this.data[c]>>e|h,h=(this.data[c]&f)<<d;for(c=g-1;c>=0;--c)b.data[c]=0;b.data[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function w(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b.data[0]=this.data[c]>>d;for(var g=c+1;g<this.t;++g)b.data[g-c-1]|=(this.data[g]&f)<<e,b.data[g-c]=this.data[g]>>d;d>0&&(b.data[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function x(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this.data[c]-a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b.data[c++]=this.DV+d:d>0&&(b.data[c++]=d),b.t=c,b.clamp()}function y(a,c){var d=this.abs(),e=a.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c.data[f]=0;for(f=0;f<e.t;++f)c.data[f+d.t]=d.am(0,e.data[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=a.s&&b.ZERO.subTo(c,c)}function z(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a.data[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b.data[c],a,2*c,0,1);(a.data[c+b.t]+=b.am(c+1,2*b.data[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a.data[c+b.t]-=b.DV,a.data[c+b.t+1]=1)}a.t>0&&(a.data[a.t-1]+=b.am(c,b.data[c],a,2*c,0,1)),a.s=0,a.clamp()}function A(a,d,e){var f=a.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=d&&d.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=c());var h=c(),i=this.s,j=a.s,k=this.DB-r(f.data[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h.data[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h.data[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,s=e.t,t=s-l,u=null==d?c():d;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e.data[e.t++]=1,e.subTo(u,e)),b.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h.data[h.t++]=0;for(;--t>=0;){var v=e.data[--s]==m?this.DM:Math.floor(e.data[s]*o+(e.data[s-1]+q)*p);if((e.data[s]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e.data[s]<--v;)e.subTo(u,e)}null!=d&&(e.drShiftTo(l,d),i!=j&&b.ZERO.subTo(d,d)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&b.ZERO.subTo(e,e)}}}function B(a){var d=c();return this.abs().divRemTo(a,null,d),this.s<0&&d.compareTo(b.ZERO)>0&&a.subTo(d,d),d}function C(a){this.m=a}function D(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function E(a){return a}function F(a){a.divRemTo(this.m,null,a)}function G(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function H(a,b){a.squareTo(b),this.reduce(b)}function I(){if(this.t<1)return 0;var a=this.data[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function J(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function K(a){var d=c();return a.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),a.s<0&&d.compareTo(b.ZERO)>0&&this.m.subTo(d,d),d}function L(a){var b=c();return a.copyTo(b),this.reduce(b),b}function M(a){for(;a.t<=this.mt2;)a.data[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a.data[b],d=c*this.mpl+((c*this.mph+(a.data[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a.data[c]+=this.m.am(0,d,a,b,0,this.m.t);a.data[c]>=a.DV;)a.data[c]-=a.DV,a.data[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function N(a,b){a.squareTo(b),this.reduce(b)}function O(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function P(){return 0==(this.t>0?1&this.data[0]:this.s)}function Q(a,d){if(a>4294967295||1>a)return b.ONE;var e=c(),f=c(),g=d.convert(this),h=r(a)-1;for(g.copyTo(e);--h>=0;)if(d.sqrTo(e,f),(a&1<<h)>0)d.mulTo(f,g,e);else{var i=e;e=f,f=i}return d.revert(e)}function R(a,b){var c;return c=256>a||b.isEven()?new C(b):new J(b),this.exp(a,c)}function S(){var a=c();return this.copyTo(a),a}function T(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function U(){return 0==this.t?this.s:this.data[0]<<24>>24}function V(){return 0==this.t?this.s:this.data[0]<<16>>16}function W(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function X(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function Y(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),d=Math.pow(a,b),e=k(d),f=c(),g=c(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(d+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function Z(a,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,i=0,j=0;j<a.length;++j){var k=h(a,j);0>k?"-"==a.charAt(j)&&0==this.signum()&&(f=!0):(i=c*i+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(i,0),g=0,i=0))}g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(i,0)),f&&b.ZERO.subTo(this,this)}function $(a,c,d){if("number"==typeof c)if(2>a)this.fromInt(1);else for(this.fromNumber(a,d),this.testBit(a-1)||this.bitwiseTo(b.ONE.shiftLeft(a-1),ga,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(b.ONE.shiftLeft(a-1),this);else{var e=new Array,f=7&a;e.length=(a>>3)+1,c.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function _(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this.data[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this.data[a]&(1<<d)-1)<<8-d,c|=this.data[--a]>>(d+=this.DB-8)):(c=this.data[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function aa(a){return 0==this.compareTo(a)}function ba(a){return this.compareTo(a)<0?this:a}function ca(a){return this.compareTo(a)>0?this:a}function da(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c.data[d]=b(this.data[d],a.data[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c.data[d]=b(this.data[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c.data[d]=b(e,a.data[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function ea(a,b){return a&b}function fa(a){var b=c();return this.bitwiseTo(a,ea,b),b}function ga(a,b){return a|b}function ha(a){var b=c();return this.bitwiseTo(a,ga,b),b}function ia(a,b){return a^b}function ja(a){var b=c();return this.bitwiseTo(a,ia,b),b}function ka(a,b){return a&~b}function la(a){var b=c();return this.bitwiseTo(a,ka,b),b}function ma(){for(var a=c(),b=0;b<this.t;++b)a.data[b]=this.DM&~this.data[b];return a.t=this.t,a.s=~this.s,a}function na(a){var b=c();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function oa(a){var b=c();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function pa(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function qa(){for(var a=0;a<this.t;++a)if(0!=this.data[a])return a*this.DB+pa(this.data[a]);return this.s<0?this.t*this.DB:-1}function ra(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function sa(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=ra(this.data[c]^b);return a}function ta(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this.data[b]&1<<a%this.DB)}function ua(a,c){var d=b.ONE.shiftLeft(a);return this.bitwiseTo(d,c,d),d}function va(a){return this.changeBit(a,ga)}function wa(a){return this.changeBit(a,ka)}function xa(a){return this.changeBit(a,ia)}function ya(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this.data[c]+a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b.data[c++]=d:-1>d&&(b.data[c++]=this.DV+d),b.t=c,b.clamp()}function za(a){var b=c();return this.addTo(a,b),b}function Aa(a){var b=c();return this.subTo(a,b),b}function Ba(a){var b=c();return this.multiplyTo(a,b),b}function Ca(a){var b=c();return this.divRemTo(a,b,null),b}function Da(a){var b=c();return this.divRemTo(a,null,b),b}function Ea(a){var b=c(),d=c();return this.divRemTo(a,b,d),new Array(b,d)}function Fa(a){this.data[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ga(a,b){if(0!=a){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=a;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Ha(){}function Ia(a){return a}function Ja(a,b,c){a.multiplyTo(b,c)}function Ka(a,b){a.squareTo(b)}function La(a){return this.exp(a,new Ha)}function Ma(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c.data[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c.data[d+this.t]=this.am(0,a.data[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a.data[d],c,d,0,b-d);c.clamp()}function Na(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c.data[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c.data[this.t+d-b]=this.am(b-d,a.data[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Oa(a){this.r2=c(),this.q3=c(),b.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function Pa(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=c();return a.copyTo(b),this.reduce(b),b}function Qa(a){return a}function Ra(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Sa(a,b){a.squareTo(b),this.reduce(b)}function Ta(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Ua(a,b){var d,e,f=a.bitLength(),g=k(1);if(0>=f)return g;d=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new C(b):b.isEven()?new Oa(b):new J(b);var h=new Array,i=3,j=d-1,l=(1<<d)-1;if(h[1]=e.convert(this),d>1){var m=c();for(e.sqrTo(h[1],m);l>=i;)h[i]=c(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,s=c();for(f=r(a.data[p])-1;p>=0;){for(f>=j?n=a.data[p]>>f-j&l:(n=(a.data[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a.data[p-1]>>this.DB+f-j)),i=d;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,s),e.sqrTo(s,g),i-=2;i>0?e.sqrTo(g,s):(o=g,g=s,s=o),e.mulTo(s,h[n],g)}for(;p>=0&&0==(a.data[p]&1<<f);)e.sqrTo(g,s),o=g,g=s,s=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Va(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Wa(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this.data[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this.data[d])%a;return c}function Xa(a){var c=a.isEven();if(this.isEven()&&c||0==a.signum())return b.ZERO;for(var d=a.clone(),e=this.clone(),f=k(1),g=k(0),h=k(0),i=k(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(a,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(a,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(b.ONE)?b.ZERO:i.compareTo(a)>=0?i.subtract(a):i.signum()<0?(i.addTo(a,i),i.signum()<0?i.add(a):i):i}function Ya(a){var b,c=this.abs();if(1==c.t&&c.data[0]<=hb[hb.length-1]){for(b=0;b<hb.length;++b)if(c.data[0]==hb[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<hb.length;){for(var d=hb[b],e=b+1;e<hb.length&&ib>d;)d*=hb[e++];for(d=c.modInt(d);e>b;)if(d%hb[b++]==0)return!1}return c.millerRabin(a)}function Za(a){var c=this.subtract(b.ONE),d=c.getLowestSetBit();if(0>=d)return!1;for(var e,f=c.shiftRight(d),g=$a(),h=0;a>h;++h){do e=new b(this.bitLength(),g);while(e.compareTo(b.ONE)<=0||e.compareTo(c)>=0);var i=e.modPow(f,this);if(0!=i.compareTo(b.ONE)&&0!=i.compareTo(c)){for(var j=1;j++<d&&0!=i.compareTo(c);)if(i=i.modPowInt(2,this),0==i.compareTo(b.ONE))return!1;if(0!=i.compareTo(c))return!1}}return!0}function $a(){return{nextBytes:function(a){for(var b=0;b<a.length;++b)a[b]=Math.floor(256*Math.random())}}}var _a,ab=0xdeadbeefcafe,bb=15715070==(16777215&ab);"undefined"==typeof navigator?(b.prototype.am=f,_a=28):bb&&"Microsoft Internet Explorer"==navigator.appName?(b.prototype.am=e,_a=30):bb&&"Netscape"!=navigator.appName?(b.prototype.am=d,_a=26):(b.prototype.am=f,_a=28),b.prototype.DB=_a,b.prototype.DM=(1<<_a)-1,b.prototype.DV=1<<_a;var cb=52;b.prototype.FV=Math.pow(2,cb),b.prototype.F1=cb-_a,b.prototype.F2=2*_a-cb;var db,eb,fb="0123456789abcdefghijklmnopqrstuvwxyz",gb=new Array;for(db="0".charCodeAt(0),eb=0;9>=eb;++eb)gb[db++]=eb;for(db="a".charCodeAt(0),eb=10;36>eb;++eb)gb[db++]=eb;for(db="A".charCodeAt(0),eb=10;36>eb;++eb)gb[db++]=eb;C.prototype.convert=D,C.prototype.revert=E,C.prototype.reduce=F,C.prototype.mulTo=G,C.prototype.sqrTo=H,J.prototype.convert=K,J.prototype.revert=L,J.prototype.reduce=M,J.prototype.mulTo=O,J.prototype.sqrTo=N,b.prototype.copyTo=i,b.prototype.fromInt=j,b.prototype.fromString=l,b.prototype.clamp=m,b.prototype.dlShiftTo=t,b.prototype.drShiftTo=u,b.prototype.lShiftTo=v,b.prototype.rShiftTo=w,b.prototype.subTo=x,b.prototype.multiplyTo=y,b.prototype.squareTo=z,b.prototype.divRemTo=A,b.prototype.invDigit=I,b.prototype.isEven=P,b.prototype.exp=Q,b.prototype.toString=n,b.prototype.negate=o,b.prototype.abs=p,b.prototype.compareTo=q,b.prototype.bitLength=s,b.prototype.mod=B,b.prototype.modPowInt=R,b.ZERO=k(0),b.ONE=k(1),Ha.prototype.convert=Ia,Ha.prototype.revert=Ia,Ha.prototype.mulTo=Ja,Ha.prototype.sqrTo=Ka,Oa.prototype.convert=Pa,Oa.prototype.revert=Qa,Oa.prototype.reduce=Ra,Oa.prototype.mulTo=Ta,Oa.prototype.sqrTo=Sa;var hb=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ib=(1<<26)/hb[hb.length-1];b.prototype.chunkSize=W,b.prototype.toRadix=Y,b.prototype.fromRadix=Z,b.prototype.fromNumber=$,b.prototype.bitwiseTo=da,b.prototype.changeBit=ua,b.prototype.addTo=ya,b.prototype.dMultiply=Fa,b.prototype.dAddOffset=Ga,b.prototype.multiplyLowerTo=Ma,b.prototype.multiplyUpperTo=Na,b.prototype.modInt=Wa,b.prototype.millerRabin=Za,b.prototype.clone=S,b.prototype.intValue=T,b.prototype.byteValue=U,b.prototype.shortValue=V,b.prototype.signum=X,b.prototype.toByteArray=_,b.prototype.equals=aa,b.prototype.min=ba,b.prototype.max=ca,b.prototype.and=fa,b.prototype.or=ha,b.prototype.xor=ja,b.prototype.andNot=la,b.prototype.not=ma,b.prototype.shiftLeft=na,b.prototype.shiftRight=oa,b.prototype.getLowestSetBit=qa,b.prototype.bitCount=sa,b.prototype.testBit=ta,b.prototype.setBit=va,b.prototype.clearBit=wa,b.prototype.flipBit=xa,b.prototype.add=za,b.prototype.subtract=Aa,b.prototype.multiply=Ba,b.prototype.divide=Ca,b.prototype.remainder=Da,b.prototype.divideAndRemainder=Ea,b.prototype.modPow=Ua,b.prototype.modInverse=Xa,b.prototype.pow=La,b.prototype.gcd=Va,b.prototype.isProbablePrime=Ya,a.jsbn=a.jsbn||{},a.jsbn.BigInteger=b}var d="jsbn";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsbn",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c,d){d||(d=a.md.sha1.create());for(var e="",f=Math.ceil(c/d.digestLength),g=0;f>g;++g){var h=String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,255&g);d.start(),d.update(b+h),e+=d.digest().getBytes()}return e.substring(0,c)}var c=a.pkcs1=a.pkcs1||{};c.encode_rsa_oaep=function(c,d,e){var f,g,h,i;"string"==typeof e?(f=e,g=arguments[3]||void 0,h=arguments[4]||void 0):e&&(f=e.label||void 0,g=e.seed||void 0,h=e.md||void 0,e.mgf1&&e.mgf1.md&&(i=e.mgf1.md)),h?h.start():h=a.md.sha1.create(),i||(i=h);var j=Math.ceil(c.n.bitLength()/8),k=j-2*h.digestLength-2;if(d.length>k){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=d.length,l.maxLength=k,l}f||(f=""),h.update(f,"raw");for(var m=h.digest(),n="",o=k-d.length,p=0;o>p;p++)n+="\x00";var q=m.getBytes()+n+""+d;if(g){if(g.length!==h.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=g.length,l.digestLength=h.digestLength,l}}else g=a.random.getBytes(h.digestLength);var r=b(g,j-h.digestLength-1,i),s=a.util.xorBytes(q,r,q.length),t=b(s,h.digestLength,i),u=a.util.xorBytes(g,t,g.length);return"\x00"+u+s},c.decode_rsa_oaep=function(c,d,e){var f,g,h;"string"==typeof e?(f=e,g=arguments[3]||void 0):e&&(f=e.label||void 0,g=e.md||void 0,e.mgf1&&e.mgf1.md&&(h=e.mgf1.md));var i=Math.ceil(c.n.bitLength()/8);if(d.length!==i){var j=new Error("RSAES-OAEP encoded message length is invalid.");throw j.length=d.length,j.expectedLength=i,j}if(void 0===g?g=a.md.sha1.create():g.start(),h||(h=g),i<2*g.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");f||(f=""),g.update(f,"raw");for(var k=g.digest().getBytes(),l=d.charAt(0),m=d.substring(1,g.digestLength+1),n=d.substring(1+g.digestLength),o=b(n,g.digestLength,h),p=a.util.xorBytes(m,o,m.length),q=b(p,i-g.digestLength-1,h),r=a.util.xorBytes(n,q,n.length),s=r.substring(0,g.digestLength),j="\x00"!==l,t=0;t<g.digestLength;++t)j|=k.charAt(t)!==s.charAt(t);for(var u=1,v=g.digestLength,w=g.digestLength;w<r.length;w++){var x=r.charCodeAt(w),y=1&x^1,z=u?65534:0;j|=x&z,u&=y,v+=u}if(j||1!==r.charCodeAt(v))throw new Error("Invalid RSAES-OAEP padding.");return r.substring(v+1)}}var d="pkcs1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs1",["require","module","./util","./random","./sha1"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,e,f){return"workers"in e?d(a,b,e,f):c(a,b,e,f)}function c(b,d,g,h){var j=e(b,d),k=0,l=f(j.bitLength());"millerRabinTests"in g&&(l=g.millerRabinTests);var m=10;"maxBlockTime"in g&&(m=g.maxBlockTime);var n=+new Date;do{if(j.bitLength()>b&&(j=e(b,d)),j.isProbablePrime(l))return h(null,j);j.dAddOffset(i[k++%8],0)}while(0>m||+new Date-n<m);a.util.setImmediate(function(){c(b,d,g,h)})}function d(b,d,f,g){function i(){function a(a){if(!o){--i;var f=a.data;if(f.found){for(var k=0;k<c.length;++k)c[k].terminate();return o=!0,g(null,new h(f.prime,16))}j.bitLength()>b&&(j=e(b,d));var n=j.toString(16);a.target.postMessage({hex:n,workLoad:l}),j.dAddOffset(m,0)}}k=Math.max(1,k);for(var c=[],f=0;k>f;++f)c[f]=new Worker(n);for(var i=k,f=0;k>f;++f)c[f].addEventListener("message",a);var o=!1}if("undefined"==typeof Worker)return c(b,d,f,g);var j=e(b,d),k=f.workers,l=f.workLoad||100,m=30*l/8,n=f.workerScript||"forge/prime.worker.js";return-1===k?a.util.estimateCores(function(a,b){a&&(b=2),k=b-1,i()}):void i()}function e(a,b){var c=new h(a,b),d=a-1;return c.testBit(d)||c.bitwiseTo(h.ONE.shiftLeft(d),k,c),c.dAddOffset(31-c.mod(j).byteValue(),0),c}function f(a){return 100>=a?27:150>=a?18:200>=a?15:250>=a?12:300>=a?9:350>=a?8:400>=a?7:500>=a?6:600>=a?5:800>=a?4:1250>=a?3:2}if(!a.prime){var g=a.prime=a.prime||{},h=a.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],j=new h(null);j.fromInt(30);var k=function(a,b){return a|b};g.generateProbablePrime=function(c,d,e){"function"==typeof d&&(e=d,d={}),d=d||{};var f=d.algorithm||"PRIMEINC";"string"==typeof f&&(f={name:f}),f.options=f.options||{};var g=d.prng||a.random,h={nextBytes:function(a){for(var b=g.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}};if("PRIMEINC"===f.name)return b(c,h,f.options,e);throw new Error("Invalid prime generation algorithm: "+f.name)}}}var d="prime";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prime",["require","module","./util","./jsbn","./random"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c,d){var e=a.util.createBuffer(),f=Math.ceil(c.n.bitLength()/8);if(b.length>f-11){var g=new Error("Message is too long for PKCS#1 v1.5 padding.");throw g.length=b.length,g.max=f-11,g}e.putByte(0),e.putByte(d);var h,i=f-3-b.length;if(0===d||1===d){h=0===d?0:255;for(var j=0;i>j;++j)e.putByte(h)}else for(;i>0;){for(var k=0,l=a.random.getBytes(i),j=0;i>j;++j)h=l.charCodeAt(j),0===h?++k:e.putByte(h);i=k}return e.putByte(0),e.putBytes(b),e}function c(b,c,d,e){var f=Math.ceil(c.n.bitLength()/8),g=a.util.createBuffer(b),h=g.getByte(),i=g.getByte();if(0!==h||d&&0!==i&&1!==i||!d&&2!=i||d&&0===i&&"undefined"==typeof e)throw new Error("Encryption block is invalid.");var j=0;if(0===i){j=f-3-e;for(var k=0;j>k;++k)if(0!==g.getByte())throw new Error("Encryption block is invalid.");
}else if(1===i)for(j=0;g.length()>1;){if(255!==g.getByte()){--g.read;break}++j}else if(2===i)for(j=0;g.length()>1;){if(0===g.getByte()){--g.read;break}++j}var l=g.getByte();if(0!==l||j!==f-3-g.length())throw new Error("Encryption block is invalid.");return g.getBytes()}function d(b,c,d){function e(){f(b.pBits,function(a,c){return a?d(a):(b.p=c,null!==b.q?h(a,b.q):void f(b.qBits,h))})}function f(b,c){a.prime.generateProbablePrime(b,j,c)}function h(a,c){if(a)return d(a);if(b.q=c,b.p.compareTo(b.q)<0){var j=b.p;b.p=b.q,b.q=j}if(0!==b.p.subtract(g.ONE).gcd(b.e).compareTo(g.ONE))return b.p=null,void e();if(0!==b.q.subtract(g.ONE).gcd(b.e).compareTo(g.ONE))return b.q=null,void f(b.qBits,h);if(b.p1=b.p.subtract(g.ONE),b.q1=b.q.subtract(g.ONE),b.phi=b.p1.multiply(b.q1),0!==b.phi.gcd(b.e).compareTo(g.ONE))return b.p=b.q=null,void e();if(b.n=b.p.multiply(b.q),b.n.bitLength()!==b.bits)return b.q=null,void f(b.qBits,h);var k=b.e.modInverse(b.phi);b.keys={privateKey:i.rsa.setPrivateKey(b.n,b.e,k,b.p,b.q,k.mod(b.p1),k.mod(b.q1),b.q.modInverse(b.p)),publicKey:i.rsa.setPublicKey(b.n,b.e)},d(null,b.keys)}"function"==typeof c&&(d=c,c={}),c=c||{};var j={algorithm:{name:c.algorithm||"PRIMEINC",options:{workers:c.workers||2,workLoad:c.workLoad||100,workerScript:c.workerScript}}};"prng"in c&&(j.prng=c.prng),e()}function e(b){var c=b.toString(16);return c[0]>="8"&&(c="00"+c),a.util.hexToBytes(c)}function f(a){return 100>=a?27:150>=a?18:200>=a?15:250>=a?12:300>=a?9:350>=a?8:400>=a?7:500>=a?6:600>=a?5:800>=a?4:1250>=a?3:2}if("undefined"==typeof g)var g=a.jsbn.BigInteger;var h=a.asn1;a.pki=a.pki||{},a.pki.rsa=a.rsa=a.rsa||{};var i=a.pki,j=[6,4,2,4,2,4,6,2],k={name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},l={name:"RSAPrivateKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},m={name:"RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},n=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},o=function(a){var b;if(!(a.algorithm in i.oids)){var c=new Error("Unknown message digest algorithm.");throw c.algorithm=a.algorithm,c}b=i.oids[a.algorithm];var d=h.oidToDer(b).getBytes(),e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),f=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);f.value.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,d)),f.value.push(h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,""));var g=h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,a.digest().getBytes());return e.value.push(f),e.value.push(g),h.toDer(e).getBytes()},p=function(b,c,d){if(d)return b.modPow(c.e,c.n);if(!c.p||!c.q)return b.modPow(c.d,c.n);c.dP||(c.dP=c.d.mod(c.p.subtract(g.ONE))),c.dQ||(c.dQ=c.d.mod(c.q.subtract(g.ONE))),c.qInv||(c.qInv=c.q.modInverse(c.p));var e;do e=new g(a.util.bytesToHex(a.random.getBytes(c.n.bitLength()/8)),16);while(e.compareTo(c.n)>=0||!e.gcd(c.n).equals(g.ONE));b=b.multiply(e.modPow(c.e,c.n)).mod(c.n);for(var f=b.mod(c.p).modPow(c.dP,c.p),h=b.mod(c.q).modPow(c.dQ,c.q);f.compareTo(h)<0;)f=f.add(c.p);var i=f.subtract(h).multiply(c.qInv).mod(c.p).multiply(c.q).add(h);return i=i.multiply(e.modInverse(c.n)).mod(c.n)};i.rsa.encrypt=function(c,d,e){var f,h=e,i=Math.ceil(d.n.bitLength()/8);e!==!1&&e!==!0?(h=2===e,f=b(c,d,e)):(f=a.util.createBuffer(),f.putBytes(c));for(var j=new g(f.toHex(),16),k=p(j,d,h),l=k.toString(16),m=a.util.createBuffer(),n=i-Math.ceil(l.length/2);n>0;)m.putByte(0),--n;return m.putBytes(a.util.hexToBytes(l)),m.getBytes()},i.rsa.decrypt=function(b,d,e,f){var h=Math.ceil(d.n.bitLength()/8);if(b.length!==h){var i=new Error("Encrypted message length is invalid.");throw i.length=b.length,i.expected=h,i}var j=new g(a.util.createBuffer(b).toHex(),16);if(j.compareTo(d.n)>=0)throw new Error("Encrypted message is invalid.");for(var k=p(j,d,e),l=k.toString(16),m=a.util.createBuffer(),n=h-Math.ceil(l.length/2);n>0;)m.putByte(0),--n;return m.putBytes(a.util.hexToBytes(l)),f!==!1?c(m.getBytes(),d,e):m.getBytes()},i.rsa.createKeyPairGenerationState=function(b,c,d){"string"==typeof b&&(b=parseInt(b,10)),b=b||2048,d=d||{};var e,f=d.prng||a.random,h={nextBytes:function(a){for(var b=f.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}},i=d.algorithm||"PRIMEINC";if("PRIMEINC"!==i)throw new Error("Invalid key generation algorithm: "+i);return e={algorithm:i,state:0,bits:b,rng:h,eInt:c||65537,e:new g(null),p:null,q:null,qBits:b>>1,pBits:b-(b>>1),pqState:0,num:null,keys:null},e.e.fromInt(e.eInt),e},i.rsa.stepKeyPairGenerationState=function(a,b){"algorithm"in a||(a.algorithm="PRIMEINC");var c=new g(null);c.fromInt(30);for(var d,e=0,h=function(a,b){return a|b},k=+new Date,l=0;null===a.keys&&(0>=b||b>l);){if(0===a.state){var m=null===a.p?a.pBits:a.qBits,n=m-1;0===a.pqState?(a.num=new g(m,a.rng),a.num.testBit(n)||a.num.bitwiseTo(g.ONE.shiftLeft(n),h,a.num),a.num.dAddOffset(31-a.num.mod(c).byteValue(),0),e=0,++a.pqState):1===a.pqState?a.num.bitLength()>m?a.pqState=0:a.num.isProbablePrime(f(a.num.bitLength()))?++a.pqState:a.num.dAddOffset(j[e++%8],0):2===a.pqState?a.pqState=0===a.num.subtract(g.ONE).gcd(a.e).compareTo(g.ONE)?3:0:3===a.pqState&&(a.pqState=0,null===a.p?a.p=a.num:a.q=a.num,null!==a.p&&null!==a.q&&++a.state,a.num=null)}else if(1===a.state)a.p.compareTo(a.q)<0&&(a.num=a.p,a.p=a.q,a.q=a.num),++a.state;else if(2===a.state)a.p1=a.p.subtract(g.ONE),a.q1=a.q.subtract(g.ONE),a.phi=a.p1.multiply(a.q1),++a.state;else if(3===a.state)0===a.phi.gcd(a.e).compareTo(g.ONE)?++a.state:(a.p=null,a.q=null,a.state=0);else if(4===a.state)a.n=a.p.multiply(a.q),a.n.bitLength()===a.bits?++a.state:(a.q=null,a.state=0);else if(5===a.state){var o=a.e.modInverse(a.phi);a.keys={privateKey:i.rsa.setPrivateKey(a.n,a.e,o,a.p,a.q,o.mod(a.p1),o.mod(a.q1),a.q.modInverse(a.p)),publicKey:i.rsa.setPublicKey(a.n,a.e)}}d=+new Date,l+=d-k,k=d}return null!==a.keys},i.rsa.generateKeyPair=function(a,b,c,e){1===arguments.length?"object"==typeof a?(c=a,a=void 0):"function"==typeof a&&(e=a,a=void 0):2===arguments.length?"number"==typeof a?"function"==typeof b?(e=b,b=void 0):"number"!=typeof b&&(c=b,b=void 0):(c=a,e=b,a=void 0,b=void 0):3===arguments.length&&("number"==typeof b?"function"==typeof c&&(e=c,c=void 0):(e=c,c=b,b=void 0)),c=c||{},void 0===a&&(a=c.bits||2048),void 0===b&&(b=c.e||65537);var f=i.rsa.createKeyPairGenerationState(a,b,c);return e?void d(f,c,e):(i.rsa.stepKeyPairGenerationState(f,0),f.keys)},i.setRsaPublicKey=i.rsa.setPublicKey=function(d,e){var f={n:d,e:e};return f.encrypt=function(c,d,e){if("string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===d)d={encode:function(a,c,d){return b(a,c,2).getBytes()}};else if("RSA-OAEP"===d||"RSAES-OAEP"===d)d={encode:function(b,c){return a.pkcs1.encode_rsa_oaep(c,b,e)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(d))d={encode:function(a){return a}};else if("string"==typeof d)throw new Error('Unsupported encryption scheme: "'+d+'".');var g=d.encode(c,f,!0);return i.rsa.encrypt(g,f,!0)},f.verify=function(a,b,d){"string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===d?d={verify:function(a,b){b=c(b,f,!0);var d=h.fromDer(b);return a===d.value[1].value}}:("NONE"===d||"NULL"===d||null===d)&&(d={verify:function(a,b){return b=c(b,f,!0),a===b}});var e=i.rsa.decrypt(b,f,!0,!1);return d.verify(a,e,f.n.bitLength())},f},i.setRsaPrivateKey=i.rsa.setPrivateKey=function(b,d,e,f,g,h,j,k){var l={n:b,e:d,d:e,p:f,q:g,dP:h,dQ:j,qInv:k};return l.decrypt=function(b,d,e){"string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5");var f=i.rsa.decrypt(b,l,!1,!1);if("RSAES-PKCS1-V1_5"===d)d={decode:c};else if("RSA-OAEP"===d||"RSAES-OAEP"===d)d={decode:function(b,c){return a.pkcs1.decode_rsa_oaep(c,b,e)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(d))throw new Error('Unsupported encryption scheme: "'+d+'".');d={decode:function(a){return a}}}return d.decode(f,l,!1)},l.sign=function(a,b){var c=!1;"string"==typeof b&&(b=b.toUpperCase()),void 0===b||"RSASSA-PKCS1-V1_5"===b?(b={encode:o},c=1):("NONE"===b||"NULL"===b||null===b)&&(b={encode:function(){return a}},c=1);var d=b.encode(a,l.n.bitLength());return i.rsa.encrypt(d,l,c)},l},i.wrapRsaPrivateKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(a).getBytes())])},i.privateKeyFromAsn1=function(b){var c={},d=[];if(h.validate(b,k,c,d)&&(b=h.fromDer(a.util.createBuffer(c.privateKey))),c={},d=[],!h.validate(b,l,c,d)){var e=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw e.errors=d,e}var f,j,m,n,o,p,q,r;return f=a.util.createBuffer(c.privateKeyModulus).toHex(),j=a.util.createBuffer(c.privateKeyPublicExponent).toHex(),m=a.util.createBuffer(c.privateKeyPrivateExponent).toHex(),n=a.util.createBuffer(c.privateKeyPrime1).toHex(),o=a.util.createBuffer(c.privateKeyPrime2).toHex(),p=a.util.createBuffer(c.privateKeyExponent1).toHex(),q=a.util.createBuffer(c.privateKeyExponent2).toHex(),r=a.util.createBuffer(c.privateKeyCoefficient).toHex(),i.setRsaPrivateKey(new g(f,16),new g(j,16),new g(m,16),new g(n,16),new g(o,16),new g(p,16),new g(q,16),new g(r,16))},i.privateKeyToAsn1=i.privateKeyToRSAPrivateKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.e)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.d)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.p)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.q)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.dP)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.dQ)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.qInv))])},i.publicKeyFromAsn1=function(b){var c={},d=[];if(h.validate(b,n,c,d)){var e=h.derToOid(c.publicKeyOid);if(e!==i.oids.rsaEncryption){var f=new Error("Cannot read public key. Unknown OID.");throw f.oid=e,f}b=c.rsaPublicKey}if(d=[],!h.validate(b,m,c,d)){var f=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw f.errors=d,f}var j=a.util.createBuffer(c.publicKeyModulus).toHex(),k=a.util.createBuffer(c.publicKeyExponent).toHex();return i.setRsaPublicKey(new g(j,16),new g(k,16))},i.publicKeyToAsn1=i.publicKeyToSubjectPublicKeyInfo=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,[i.publicKeyToRSAPublicKey(a)])])},i.publicKeyToRSAPublicKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.e))])}}var d="rsa";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rsa",["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b){return a.start().update(b).digest().getBytes()}if("undefined"==typeof c)var c=a.jsbn.BigInteger;var d=a.asn1,e=a.pki=a.pki||{};e.pbe=a.pbe=a.pbe||{};var f=e.oids,g={name:"EncryptedPrivateKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h={name:"PBES2Algorithms",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},i={name:"pkcs-12PbeParams",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"iterations"}]};e.encryptPrivateKeyInfo=function(b,c,g){g=g||{},g.saltSize=g.saltSize||8,g.count=g.count||2048,g.algorithm=g.algorithm||"aes128";var h,i,j,k=a.random.getBytesSync(g.saltSize),l=g.count,m=d.integerToDer(l);if(0===g.algorithm.indexOf("aes")||"des"===g.algorithm){var n,o,p;switch(g.algorithm){case"aes128":h=16,n=16,o=f["aes128-CBC"],p=a.aes.createEncryptionCipher;break;case"aes192":h=24,n=16,o=f["aes192-CBC"],p=a.aes.createEncryptionCipher;break;case"aes256":h=32,n=16,o=f["aes256-CBC"],p=a.aes.createEncryptionCipher;break;case"des":h=8,n=8,o=f.desCBC,p=a.des.createEncryptionCipher;break;default:var q=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw q.algorithm=g.algorithm,q}var r=a.pkcs5.pbkdf2(c,k,l,h),s=a.random.getBytesSync(n),t=p(r);t.start(s),t.update(d.toDer(b)),t.finish(),j=t.output.getBytes(),i=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(f.pkcs5PBES2).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(f.pkcs5PBKDF2).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,k),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,m.getBytes())])]),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(o).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,s)])])])}else{if("3des"!==g.algorithm){var q=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw q.algorithm=g.algorithm,q}h=24;var u=new a.util.ByteBuffer(k),r=e.pbe.generatePkcs12Key(c,u,1,l,h),s=e.pbe.generatePkcs12Key(c,u,2,l,h),t=a.des.createEncryptionCipher(r);t.start(s),t.update(d.toDer(b)),t.finish(),j=t.output.getBytes(),i=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(f["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,k),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,m.getBytes())])])}var v=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[i,d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,j)]);return v},e.decryptPrivateKeyInfo=function(b,c){var f=null,h={},i=[];if(!d.validate(b,g,h,i)){var j=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw j.errors=i,j}var k=d.derToOid(h.encryptionOid),l=e.pbe.getCipher(k,h.encryptionParams,c),m=a.util.createBuffer(h.encryptedData);return l.update(m),l.finish()&&(f=d.fromDer(l.output)),f},e.encryptedPrivateKeyToPem=function(b,c){var e={type:"ENCRYPTED PRIVATE KEY",body:d.toDer(b).getBytes()};return a.pem.encode(e,{maxline:c})},e.encryptedPrivateKeyFromPem=function(b){var c=a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==c.type){var e=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw e.headerType=c.type,e}if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return d.fromDer(c.body)},e.encryptRsaPrivateKey=function(b,c,f){if(f=f||{},!f.legacy){var g=e.wrapRsaPrivateKey(e.privateKeyToAsn1(b));return g=e.encryptPrivateKeyInfo(g,c,f),e.encryptedPrivateKeyToPem(g)}var h,i,j,k;switch(f.algorithm){case"aes128":h="AES-128-CBC",j=16,i=a.random.getBytesSync(16),k=a.aes.createEncryptionCipher;break;case"aes192":h="AES-192-CBC",j=24,i=a.random.getBytesSync(16),k=a.aes.createEncryptionCipher;break;case"aes256":h="AES-256-CBC",j=32,i=a.random.getBytesSync(16),k=a.aes.createEncryptionCipher;break;case"3des":h="DES-EDE3-CBC",j=24,i=a.random.getBytesSync(8),k=a.des.createEncryptionCipher;break;case"des":h="DES-CBC",j=8,i=a.random.getBytesSync(8),k=a.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+f.algorithm+'".');throw l.algorithm=f.algorithm,l}var m=a.pbe.opensslDeriveBytes(c,i.substr(0,8),j),n=k(m);n.start(i),n.update(d.toDer(e.privateKeyToAsn1(b))),n.finish();var o={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:h,parameters:a.util.bytesToHex(i).toUpperCase()},body:n.output.getBytes()};return a.pem.encode(o)},e.decryptRsaPrivateKey=function(b,c){var f=null,g=a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==g.type&&"PRIVATE KEY"!==g.type&&"RSA PRIVATE KEY"!==g.type){var h=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw h.headerType=h,h}if(g.procType&&"ENCRYPTED"===g.procType.type){var i,j;switch(g.dekInfo.algorithm){case"DES-CBC":i=8,j=a.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,j=a.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,j=a.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,j=a.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,j=a.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,j=function(b){return a.rc2.createDecryptionCipher(b,40)};break;case"RC2-64-CBC":i=8,j=function(b){return a.rc2.createDecryptionCipher(b,64)};break;case"RC2-128-CBC":i=16,j=function(b){return a.rc2.createDecryptionCipher(b,128)};break;default:var h=new Error('Could not decrypt private key; unsupported encryption algorithm "'+g.dekInfo.algorithm+'".');throw h.algorithm=g.dekInfo.algorithm,h}var k=a.util.hexToBytes(g.dekInfo.parameters),l=a.pbe.opensslDeriveBytes(c,k.substr(0,8),i),m=j(l);if(m.start(k),m.update(a.util.createBuffer(g.body)),!m.finish())return f;f=m.output.getBytes()}else f=g.body;return f="ENCRYPTED PRIVATE KEY"===g.type?e.decryptPrivateKeyInfo(d.fromDer(f),c):d.fromDer(f),null!==f&&(f=e.privateKeyFromAsn1(f)),f},e.pbe.generatePkcs12Key=function(b,c,d,e,f,g){var h,i;("undefined"==typeof g||null===g)&&(g=a.md.sha1.create());var j=g.digestLength,k=g.blockLength,l=new a.util.ByteBuffer,m=new a.util.ByteBuffer;if(null!==b&&void 0!==b){for(i=0;i<b.length;i++)m.putInt16(b.charCodeAt(i));m.putInt16(0)}var n=m.length(),o=c.length(),p=new a.util.ByteBuffer;p.fillWithByte(d,k);var q=k*Math.ceil(o/k),r=new a.util.ByteBuffer;for(i=0;q>i;i++)r.putByte(c.at(i%o));var s=k*Math.ceil(n/k),t=new a.util.ByteBuffer;for(i=0;s>i;i++)t.putByte(m.at(i%n));var u=r;u.putBuffer(t);for(var v=Math.ceil(f/j),w=1;v>=w;w++){var x=new a.util.ByteBuffer;x.putBytes(p.bytes()),x.putBytes(u.bytes());for(var y=0;e>y;y++)g.start(),g.update(x.getBytes()),x=g.digest();var z=new a.util.ByteBuffer;for(i=0;k>i;i++)z.putByte(x.at(i%j));var A=Math.ceil(o/k)+Math.ceil(n/k),B=new a.util.ByteBuffer;for(h=0;A>h;h++){var C=new a.util.ByteBuffer(u.getBytes(k)),D=511;for(i=z.length()-1;i>=0;i--)D>>=8,D+=z.at(i)+C.at(i),C.setAt(i,255&D);B.putBuffer(C)}u=B,l.putBuffer(x)}return l.truncate(l.length()-f),l},e.pbe.getCipher=function(a,b,c){switch(a){case e.oids.pkcs5PBES2:return e.pbe.getCipherForPBES2(a,b,c);case e.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case e.oids["pbewithSHAAnd40BitRC2-CBC"]:return e.pbe.getCipherForPKCS12PBE(a,b,c);default:var d=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw d.oid=a,d.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],d}},e.pbe.getCipherForPBES2=function(b,c,f){var g={},i=[];if(!d.validate(c,h,g,i)){var j=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw j.errors=i,j}if(b=d.derToOid(g.kdfOid),b!==e.oids.pkcs5PBKDF2){var j=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw j.oid=b,j.supportedOids=["pkcs5PBKDF2"],j}if(b=d.derToOid(g.encOid),b!==e.oids["aes128-CBC"]&&b!==e.oids["aes192-CBC"]&&b!==e.oids["aes256-CBC"]&&b!==e.oids["des-EDE3-CBC"]&&b!==e.oids.desCBC){var j=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw j.oid=b,j.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],j}var k=g.kdfSalt,l=a.util.createBuffer(g.kdfIterationCount);l=l.getInt(l.length()<<3);var m,n;switch(e.oids[b]){case"aes128-CBC":m=16,n=a.aes.createDecryptionCipher;break;case"aes192-CBC":m=24,n=a.aes.createDecryptionCipher;break;case"aes256-CBC":m=32,n=a.aes.createDecryptionCipher;break;case"des-EDE3-CBC":m=24,n=a.des.createDecryptionCipher;break;case"desCBC":m=8,n=a.des.createDecryptionCipher}var o=a.pkcs5.pbkdf2(f,k,l,m),p=g.encIv,q=n(o);return q.start(p),q},e.pbe.getCipherForPKCS12PBE=function(b,c,f){var g={},h=[];if(!d.validate(c,i,g,h)){var j=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw j.errors=h,j}var k=a.util.createBuffer(g.salt),l=a.util.createBuffer(g.iterations);l=l.getInt(l.length()<<3);var m,n,o;switch(b){case e.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:m=24,n=8,o=a.des.startDecrypting;break;case e.oids["pbewithSHAAnd40BitRC2-CBC"]:m=5,n=8,o=function(b,c){var d=a.rc2.createDecryptionCipher(b,40);return d.start(c,null),d};break;default:var j=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw j.oid=b,j}var p=e.pbe.generatePkcs12Key(f,k,1,l,m),q=e.pbe.generatePkcs12Key(f,k,2,l,n);return o(p,q)},e.pbe.opensslDeriveBytes=function(c,d,e,f){("undefined"==typeof f||null===f)&&(f=a.md.md5.create()),null===d&&(d="");for(var g=[b(f,c+d)],h=16,i=1;e>h;++i,h+=16)g.push(b(f,g[i-1]+c+d));return g.join("").substr(0,e)}}var d="pbe";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbe",["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{},a.pkcs7.asn1=c;var d={name:"ContentInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};c.contentInfoValidator=d;var e={name:"EncryptedContentInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:b.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};c.envelopedDataValidator={name:"EnvelopedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(e)},c.encryptedDataValidator={name:"EncryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"}].concat(e)};var f={name:"SignerInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:b.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};c.signedDataValidator={name:"SignedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},d,{name:"SignedData.Certificates",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,capture:"signerInfos",optional:!0,value:[f]}]},c.recipientInfoValidator={name:"RecipientInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:b.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}var d="pkcs7asn1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),
a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7asn1",["require","module","./asn1","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.mgf=a.mgf||{};var b=a.mgf.mgf1=a.mgf1=a.mgf1||{};b.create=function(b){var c={generate:function(c,d){for(var e=new a.util.ByteBuffer,f=Math.ceil(d/b.digestLength),g=0;f>g;g++){var h=new a.util.ByteBuffer;h.putInt32(g),b.start(),b.update(c+h.getBytes()),e.putBuffer(b.digest())}return e.truncate(e.length()-d),e.getBytes()}};return c}}var d="mgf1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf1",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.mgf=a.mgf||{},a.mgf.mgf1=a.mgf1}var d="mgf";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf",["require","module","./mgf1"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.pss=a.pss||{};b.create=function(b){3===arguments.length&&(b={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var c=b.md,d=b.mgf,e=c.digestLength,f=b.salt||null;"string"==typeof f&&(f=a.util.createBuffer(f));var g;if("saltLength"in b)g=b.saltLength;else{if(null===f)throw new Error("Salt length not specified or specific salt not given.");g=f.length()}if(null!==f&&f.length()!==g)throw new Error("Given salt length does not match length of given salt.");var h=b.prng||a.random,i={};return i.encode=function(b,i){var j,k=i-1,l=Math.ceil(k/8),m=b.digest().getBytes();if(e+g+2>l)throw new Error("Message is too long to encrypt.");var n;n=null===f?h.getBytesSync(g):f.bytes();var o=new a.util.ByteBuffer;o.fillWithByte(0,8),o.putBytes(m),o.putBytes(n),c.start(),c.update(o.getBytes());var p=c.digest().getBytes(),q=new a.util.ByteBuffer;q.fillWithByte(0,l-g-e-2),q.putByte(1),q.putBytes(n);var r=q.getBytes(),s=l-e-1,t=d.generate(p,s),u="";for(j=0;s>j;j++)u+=String.fromCharCode(r.charCodeAt(j)^t.charCodeAt(j));var v=65280>>8*l-k&255;return u=String.fromCharCode(u.charCodeAt(0)&~v)+u.substr(1),u+p+String.fromCharCode(188)},i.verify=function(b,f,h){var i,j=h-1,k=Math.ceil(j/8);if(f=f.substr(-k),e+g+2>k)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==f.charCodeAt(k-1))throw new Error("Encoded message does not end in 0xBC.");var l=k-e-1,m=f.substr(0,l),n=f.substr(l,e),o=65280>>8*k-j&255;if(0!==(m.charCodeAt(0)&o))throw new Error("Bits beyond keysize not zero as expected.");var p=d.generate(n,l),q="";for(i=0;l>i;i++)q+=String.fromCharCode(m.charCodeAt(i)^p.charCodeAt(i));q=String.fromCharCode(q.charCodeAt(0)&~o)+q.substr(1);var r=k-e-g-2;for(i=0;r>i;i++)if(0!==q.charCodeAt(i))throw new Error("Leftmost octets not zero as expected");if(1!==q.charCodeAt(r))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var s=q.substr(-g),t=new a.util.ByteBuffer;t.fillWithByte(0,8),t.putBytes(b),t.putBytes(s),c.start(),c.update(t.getBytes());var u=c.digest().getBytes();return n===u},i}}var d="pss";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pss",["require","module","./random","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b){"string"==typeof b&&(b={shortName:b});for(var c,d=null,e=0;null===d&&e<a.attributes.length;++e)c=a.attributes[e],b.type&&b.type===c.type?d=c:b.name&&b.name===c.name?d=c:b.shortName&&b.shortName===c.shortName&&(d=c);return d}function c(b){for(var c,d,e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),f=b.attributes,g=0;g<f.length;++g){c=f[g];var i=c.value,j=h.Type.PRINTABLESTRING;"valueTagClass"in c&&(j=c.valueTagClass,j===h.Type.UTF8&&(i=a.util.encodeUtf8(i))),d=h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(c.type).getBytes()),h.create(h.Class.UNIVERSAL,j,!1,i)])]),e.value.push(d)}return e}function d(a){for(var b,c=0;c<a.length;++c){if(b=a[c],"undefined"==typeof b.name&&(b.type&&b.type in i.oids?b.name=i.oids[b.type]:b.shortName&&b.shortName in k&&(b.name=i.oids[k[b.shortName]])),"undefined"==typeof b.type){if(!(b.name&&b.name in i.oids)){var d=new Error("Attribute type not specified.");throw d.attribute=b,d}b.type=i.oids[b.name]}if("undefined"==typeof b.shortName&&b.name&&b.name in k&&(b.shortName=k[b.name]),b.type===j.extensionRequest&&(b.valueConstructed=!0,b.valueTagClass=h.Type.SEQUENCE,!b.value&&b.extensions)){b.value=[];for(var f=0;f<b.extensions.length;++f)b.value.push(i.certificateExtensionToAsn1(e(b.extensions[f])))}if("undefined"==typeof b.value){var d=new Error("Attribute value not specified.");throw d.attribute=b,d}}}function e(b,c){if(c=c||{},"undefined"==typeof b.name&&b.id&&b.id in i.oids&&(b.name=i.oids[b.id]),"undefined"==typeof b.id){if(!(b.name&&b.name in i.oids)){var d=new Error("Extension ID not specified.");throw d.extension=b,d}b.id=i.oids[b.name]}if("undefined"!=typeof b.value)return b;if("keyUsage"===b.name){var e=0,f=0,g=0;b.digitalSignature&&(f|=128,e=7),b.nonRepudiation&&(f|=64,e=6),b.keyEncipherment&&(f|=32,e=5),b.dataEncipherment&&(f|=16,e=4),b.keyAgreement&&(f|=8,e=3),b.keyCertSign&&(f|=4,e=2),b.cRLSign&&(f|=2,e=1),b.encipherOnly&&(f|=1,e=0),b.decipherOnly&&(g|=128,e=7);var k=String.fromCharCode(e);0!==g?k+=String.fromCharCode(f)+String.fromCharCode(g):0!==f&&(k+=String.fromCharCode(f)),b.value=h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,k)}else if("basicConstraints"===b.name)b.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),b.cA&&b.value.value.push(h.create(h.Class.UNIVERSAL,h.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in b&&b.value.value.push(h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.pathLenConstraint).getBytes()));else if("extKeyUsage"===b.name){b.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);var l=b.value.value;for(var m in b)b[m]===!0&&(m in j?l.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(j[m]).getBytes())):-1!==m.indexOf(".")&&l.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(m).getBytes())))}else if("nsCertType"===b.name){var e=0,f=0;b.client&&(f|=128,e=7),b.server&&(f|=64,e=6),b.email&&(f|=32,e=5),b.objsign&&(f|=16,e=4),b.reserved&&(f|=8,e=3),b.sslCA&&(f|=4,e=2),b.emailCA&&(f|=2,e=1),b.objCA&&(f|=1,e=0);var k=String.fromCharCode(e);0!==f&&(k+=String.fromCharCode(f)),b.value=h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,k)}else if("subjectAltName"===b.name||"issuerAltName"===b.name){b.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);for(var n,o=0;o<b.altNames.length;++o){n=b.altNames[o];var k=n.value;if(7===n.type&&n.ip){if(k=a.util.bytesFromIP(n.ip),null===k){var d=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw d.extension=b,d}}else 8===n.type&&(k=n.oid?h.oidToDer(h.oidToDer(n.oid)):h.oidToDer(k));b.value.value.push(h.create(h.Class.CONTEXT_SPECIFIC,n.type,!1,k))}}else if("subjectKeyIdentifier"===b.name&&c.cert){var p=c.cert.generateSubjectKeyIdentifier();b.subjectKeyIdentifier=p.toHex(),b.value=h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,p.getBytes())}if("undefined"==typeof b.value){var d=new Error("Extension value not specified.");throw d.extension=b,d}return b}function f(a,b){switch(a){case j["RSASSA-PSS"]:var c=[];return void 0!==b.hash.algorithmOid&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.hash.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])])),void 0!==b.mgf.algorithmOid&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,1,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.mgf.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.mgf.hash.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])])])),void 0!==b.saltLength&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,2,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.saltLength).getBytes())])),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,c);default:return h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")}}function g(b){var c=h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===b.attributes.length)return c;for(var d=b.attributes,e=0;e<d.length;++e){var f=d[e],g=f.value,i=h.Type.UTF8;"valueTagClass"in f&&(i=f.valueTagClass),i===h.Type.UTF8&&(g=a.util.encodeUtf8(g));var j=!1;"valueConstructed"in f&&(j=f.valueConstructed);var k=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(f.type).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,i,j,g)])]);c.value.push(k)}return c}var h=a.asn1,i=a.pki=a.pki||{},j=i.oids,k={};k.CN=j.commonName,k.commonName="CN",k.C=j.countryName,k.countryName="C",k.L=j.localityName,k.localityName="L",k.ST=j.stateOrProvinceName,k.stateOrProvinceName="ST",k.O=j.organizationName,k.organizationName="O",k.OU=j.organizationalUnitName,k.organizationalUnitName="OU",k.E=j.emailAddress,k.emailAddress="E";var l=a.pki.rsa.publicKeyValidator,m={name:"Certificate",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:h.Class.UNIVERSAL,type:h.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:h.Class.UNIVERSAL,type:h.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:h.Class.UNIVERSAL,type:h.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:h.Class.UNIVERSAL,type:h.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},l,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:h.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:h.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},n={name:"rsapss",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:h.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:h.Class.UNIVERSAL,type:h.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:h.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:h.Class.UNIVERSAL,type:h.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},o={name:"CertificationRequestInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},l,{name:"CertificationRequestInfo.attributes",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0}]}]}]},p={name:"CertificationRequest",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[o,{name:"CertificationRequest.signatureAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};i.RDNAttributesAsArray=function(a,b){for(var c,d,e,f=[],g=0;g<a.value.length;++g){c=a.value[g];for(var i=0;i<c.value.length;++i)e={},d=c.value[i],e.type=h.derToOid(d.value[0].value),e.value=d.value[1].value,e.valueTagClass=d.value[1].type,e.type in j&&(e.name=j[e.type],e.name in k&&(e.shortName=k[e.name])),b&&(b.update(e.type),b.update(e.value)),f.push(e)}return f},i.CRIAttributesAsArray=function(a){for(var b=[],c=0;c<a.length;++c)for(var d=a[c],e=h.derToOid(d.value[0].value),f=d.value[1].value,g=0;g<f.length;++g){var l={};if(l.type=e,l.value=f[g].value,l.valueTagClass=f[g].type,l.type in j&&(l.name=j[l.type],l.name in k&&(l.shortName=k[l.name])),l.type===j.extensionRequest){l.extensions=[];for(var m=0;m<l.value.length;++m)l.extensions.push(i.certificateExtensionFromAsn1(l.value[m]))}b.push(l)}return b};var q=function(a,b,c){var d={};if(a!==j["RSASSA-PSS"])return d;c&&(d={hash:{algorithmOid:j.sha1},mgf:{algorithmOid:j.mgf1,hash:{algorithmOid:j.sha1}},saltLength:20});var e={},f=[];if(!h.validate(b,n,e,f)){var g=new Error("Cannot read RSASSA-PSS parameter block.");throw g.errors=f,g}return void 0!==e.hashOid&&(d.hash=d.hash||{},d.hash.algorithmOid=h.derToOid(e.hashOid)),void 0!==e.maskGenOid&&(d.mgf=d.mgf||{},d.mgf.algorithmOid=h.derToOid(e.maskGenOid),d.mgf.hash=d.mgf.hash||{},d.mgf.hash.algorithmOid=h.derToOid(e.maskGenHashOid)),void 0!==e.saltLength&&(d.saltLength=e.saltLength.charCodeAt(0)),d};i.certificateFromPem=function(b,c,d){var e=a.pem.decode(b)[0];if("CERTIFICATE"!==e.type&&"X509 CERTIFICATE"!==e.type&&"TRUSTED CERTIFICATE"!==e.type){var f=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw f.headerType=e.type,f}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var g=h.fromDer(e.body,d);return i.certificateFromAsn1(g,c)},i.certificateToPem=function(b,c){var d={type:"CERTIFICATE",body:h.toDer(i.certificateToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.publicKeyFromPem=function(b){var c=a.pem.decode(b)[0];if("PUBLIC KEY"!==c.type&&"RSA PUBLIC KEY"!==c.type){var d=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw d.headerType=c.type,d}if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var e=h.fromDer(c.body);return i.publicKeyFromAsn1(e)},i.publicKeyToPem=function(b,c){var d={type:"PUBLIC KEY",body:h.toDer(i.publicKeyToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.publicKeyToRSAPublicKeyPem=function(b,c){var d={type:"RSA PUBLIC KEY",body:h.toDer(i.publicKeyToRSAPublicKey(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.getPublicKeyFingerprint=function(b,c){c=c||{};var d,e=c.md||a.md.sha1.create(),f=c.type||"RSAPublicKey";switch(f){case"RSAPublicKey":d=h.toDer(i.publicKeyToRSAPublicKey(b)).getBytes();break;case"SubjectPublicKeyInfo":d=h.toDer(i.publicKeyToAsn1(b)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+c.type+'".')}e.start(),e.update(d);var g=e.digest();if("hex"===c.encoding){var j=g.toHex();return c.delimiter?j.match(/.{2}/g).join(c.delimiter):j}if("binary"===c.encoding)return g.getBytes();if(c.encoding)throw new Error('Unknown encoding "'+c.encoding+'".');return g},i.certificationRequestFromPem=function(b,c,d){var e=a.pem.decode(b)[0];if("CERTIFICATE REQUEST"!==e.type){var f=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw f.headerType=e.type,f}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var g=h.fromDer(e.body,d);return i.certificationRequestFromAsn1(g,c)},i.certificationRequestToPem=function(b,c){var d={type:"CERTIFICATE REQUEST",body:h.toDer(i.certificationRequestToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(a){return b(c.issuer,a)},c.issuer.addField=function(a){d([a]),c.issuer.attributes.push(a)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(a){return b(c.subject,a)},c.subject.addField=function(a){d([a]),c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=null,c.setSubject=function(a,b){d(a),c.subject.attributes=a,delete c.subject.uniqueId,b&&(c.subject.uniqueId=b),c.subject.hash=null},c.setIssuer=function(a,b){d(a),c.issuer.attributes=a,delete c.issuer.uniqueId,b&&(c.issuer.uniqueId=b),c.issuer.hash=null},c.setExtensions=function(a){for(var b=0;b<a.length;++b)e(a[b],{cert:c});c.extensions=a},c.getExtension=function(a){"string"==typeof a&&(a={name:a});for(var b,d=null,e=0;null===d&&e<c.extensions.length;++e)b=c.extensions[e],a.id&&b.id===a.id?d=b:a.name&&b.name===a.name&&(d=b);return d},c.sign=function(b,d){c.md=d||a.md.sha1.create();var e=j[c.md.algorithm+"WithRSAEncryption"];if(!e){var f=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw f.algorithm=c.md.algorithm,f}c.signatureOid=c.siginfo.algorithmOid=e,c.tbsCertificate=i.getTBSCertificate(c);var g=h.toDer(c.tbsCertificate);c.md.update(g.getBytes()),c.signature=b.sign(c.md)},c.verify=function(b){var d=!1;if(!c.issued(b)){var e=b.issuer,f=c.subject,g=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw g.expectedIssuer=e.attributes,g.actualIssuer=f.attributes,g}var k=b.md;if(null===k){if(b.signatureOid in j){var l=j[b.signatureOid];switch(l){case"sha1WithRSAEncryption":k=a.md.sha1.create();break;case"md5WithRSAEncryption":k=a.md.md5.create();break;case"sha256WithRSAEncryption":k=a.md.sha256.create();break;case"sha512WithRSAEncryption":k=a.md.sha512.create();break;case"RSASSA-PSS":k=a.md.sha256.create()}}if(null===k){var g=new Error("Could not compute certificate digest. Unknown signature OID.");throw g.signatureOid=b.signatureOid,g}var m=b.tbsCertificate||i.getTBSCertificate(b),n=h.toDer(m);k.update(n.getBytes())}if(null!==k){var o;switch(b.signatureOid){case j.sha1WithRSAEncryption:o=void 0;break;case j["RSASSA-PSS"]:var p,q;if(p=j[b.signatureParameters.mgf.hash.algorithmOid],void 0===p||void 0===a.md[p]){var g=new Error("Unsupported MGF hash function.");throw g.oid=b.signatureParameters.mgf.hash.algorithmOid,g.name=p,g}if(q=j[b.signatureParameters.mgf.algorithmOid],void 0===q||void 0===a.mgf[q]){var g=new Error("Unsupported MGF function.");throw g.oid=b.signatureParameters.mgf.algorithmOid,g.name=q,g}if(q=a.mgf[q].create(a.md[p].create()),p=j[b.signatureParameters.hash.algorithmOid],void 0===p||void 0===a.md[p])throw{message:"Unsupported RSASSA-PSS hash function.",oid:b.signatureParameters.hash.algorithmOid,name:p};o=a.pss.create(a.md[p].create(),q,b.signatureParameters.saltLength)}d=c.publicKey.verify(k.digest().getBytes(),b.signature,o)}return d},c.isIssuer=function(a){var b=!1,d=c.issuer,e=a.subject;if(d.hash&&e.hash)b=d.hash===e.hash;else if(d.attributes.length===e.attributes.length){b=!0;for(var f,g,h=0;b&&h<d.attributes.length;++h)f=d.attributes[h],g=e.attributes[h],(f.type!==g.type||f.value!==g.value)&&(b=!1)}return b},c.issued=function(a){return a.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(c.publicKey,{type:"RSAPublicKey"})},c.verifySubjectKeyIdentifier=function(){for(var b=j.subjectKeyIdentifier,d=0;d<c.extensions.length;++d){var e=c.extensions[d];if(e.id===b){var f=c.generateSubjectKeyIdentifier().getBytes();return a.util.hexToBytes(e.subjectKeyIdentifier)===f}}return!1},c},i.certificateFromAsn1=function(c,e){var f={},g=[];if(!h.validate(c,m,f,g)){var k=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw k.errors=g,k}if("string"!=typeof f.certSignature){for(var l="\x00",n=0;n<f.certSignature.length;++n)l+=h.toDer(f.certSignature[n]).getBytes();f.certSignature=l}var o=h.derToOid(f.publicKeyOid);if(o!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var p=i.createCertificate();p.version=f.certVersion?f.certVersion.charCodeAt(0):0;var r=a.util.createBuffer(f.certSerialNumber);p.serialNumber=r.toHex(),p.signatureOid=a.asn1.derToOid(f.certSignatureOid),p.signatureParameters=q(p.signatureOid,f.certSignatureParams,!0),p.siginfo.algorithmOid=a.asn1.derToOid(f.certinfoSignatureOid),p.siginfo.parameters=q(p.siginfo.algorithmOid,f.certinfoSignatureParams,!1);var s=a.util.createBuffer(f.certSignature);++s.read,p.signature=s.getBytes();var t=[];if(void 0!==f.certValidity1UTCTime&&t.push(h.utcTimeToDate(f.certValidity1UTCTime)),void 0!==f.certValidity2GeneralizedTime&&t.push(h.generalizedTimeToDate(f.certValidity2GeneralizedTime)),void 0!==f.certValidity3UTCTime&&t.push(h.utcTimeToDate(f.certValidity3UTCTime)),void 0!==f.certValidity4GeneralizedTime&&t.push(h.generalizedTimeToDate(f.certValidity4GeneralizedTime)),t.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(t.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(p.validity.notBefore=t[0],p.validity.notAfter=t[1],p.tbsCertificate=f.tbsCertificate,e){if(p.md=null,p.signatureOid in j){var o=j[p.signatureOid];switch(o){case"sha1WithRSAEncryption":p.md=a.md.sha1.create();break;case"md5WithRSAEncryption":p.md=a.md.md5.create();break;case"sha256WithRSAEncryption":p.md=a.md.sha256.create();break;case"sha512WithRSAEncryption":p.md=a.md.sha512.create();break;case"RSASSA-PSS":p.md=a.md.sha256.create()}}if(null===p.md){var k=new Error("Could not compute certificate digest. Unknown signature OID.");throw k.signatureOid=p.signatureOid,k}var u=h.toDer(p.tbsCertificate);p.md.update(u.getBytes())}var v=a.md.sha1.create();p.issuer.getField=function(a){return b(p.issuer,a)},p.issuer.addField=function(a){d([a]),p.issuer.attributes.push(a)},p.issuer.attributes=i.RDNAttributesAsArray(f.certIssuer,v),f.certIssuerUniqueId&&(p.issuer.uniqueId=f.certIssuerUniqueId),p.issuer.hash=v.digest().toHex();var w=a.md.sha1.create();return p.subject.getField=function(a){return b(p.subject,a)},p.subject.addField=function(a){d([a]),p.subject.attributes.push(a)},p.subject.attributes=i.RDNAttributesAsArray(f.certSubject,w),f.certSubjectUniqueId&&(p.subject.uniqueId=f.certSubjectUniqueId),p.subject.hash=w.digest().toHex(),f.certExtensions?p.extensions=i.certificateExtensionsFromAsn1(f.certExtensions):p.extensions=[],p.publicKey=i.publicKeyFromAsn1(f.subjectPublicKeyInfo),p},i.certificateExtensionsFromAsn1=function(a){for(var b=[],c=0;c<a.value.length;++c)for(var d=a.value[c],e=0;e<d.value.length;++e)b.push(i.certificateExtensionFromAsn1(d.value[e]));return b},i.certificateExtensionFromAsn1=function(b){var c={};if(c.id=h.derToOid(b.value[0].value),c.critical=!1,b.value[1].type===h.Type.BOOLEAN?(c.critical=0!==b.value[1].value.charCodeAt(0),c.value=b.value[2].value):c.value=b.value[1].value,c.id in j)if(c.name=j[c.id],"keyUsage"===c.name){var d=h.fromDer(c.value),e=0,f=0;d.value.length>1&&(e=d.value.charCodeAt(1),f=d.value.length>2?d.value.charCodeAt(2):0),c.digitalSignature=128===(128&e),c.nonRepudiation=64===(64&e),c.keyEncipherment=32===(32&e),c.dataEncipherment=16===(16&e),c.keyAgreement=8===(8&e),c.keyCertSign=4===(4&e),c.cRLSign=2===(2&e),c.encipherOnly=1===(1&e),c.decipherOnly=128===(128&f)}else if("basicConstraints"===c.name){var d=h.fromDer(c.value);d.value.length>0&&d.value[0].type===h.Type.BOOLEAN?c.cA=0!==d.value[0].value.charCodeAt(0):c.cA=!1;var g=null;d.value.length>0&&d.value[0].type===h.Type.INTEGER?g=d.value[0].value:d.value.length>1&&(g=d.value[1].value),null!==g&&(c.pathLenConstraint=h.derToInteger(g))}else if("extKeyUsage"===c.name)for(var d=h.fromDer(c.value),i=0;i<d.value.length;++i){var k=h.derToOid(d.value[i].value);k in j?c[j[k]]=!0:c[k]=!0}else if("nsCertType"===c.name){var d=h.fromDer(c.value),e=0;d.value.length>1&&(e=d.value.charCodeAt(1)),c.client=128===(128&e),c.server=64===(64&e),c.email=32===(32&e),c.objsign=16===(16&e),c.reserved=8===(8&e),c.sslCA=4===(4&e),c.emailCA=2===(2&e),c.objCA=1===(1&e)}else if("subjectAltName"===c.name||"issuerAltName"===c.name){c.altNames=[];for(var l,d=h.fromDer(c.value),m=0;m<d.value.length;++m){l=d.value[m];var n={type:l.type,value:l.value};switch(c.altNames.push(n),l.type){case 1:case 2:case 6:break;case 7:n.ip=a.util.bytesToIP(l.value);break;case 8:n.oid=h.derToOid(l.value)}}}else if("subjectKeyIdentifier"===c.name){var d=h.fromDer(c.value);c.subjectKeyIdentifier=a.util.bytesToHex(d.value)}return c},i.certificationRequestFromAsn1=function(c,e){var f={},g=[];if(!h.validate(c,p,f,g)){var k=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw k.errors=g,k}if("string"!=typeof f.csrSignature){for(var l="\x00",m=0;m<f.csrSignature.length;++m)l+=h.toDer(f.csrSignature[m]).getBytes();f.csrSignature=l}var n=h.derToOid(f.publicKeyOid);if(n!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=i.createCertificationRequest();o.version=f.csrVersion?f.csrVersion.charCodeAt(0):0,o.signatureOid=a.asn1.derToOid(f.csrSignatureOid),o.signatureParameters=q(o.signatureOid,f.csrSignatureParams,!0),o.siginfo.algorithmOid=a.asn1.derToOid(f.csrSignatureOid),o.siginfo.parameters=q(o.siginfo.algorithmOid,f.csrSignatureParams,!1);var r=a.util.createBuffer(f.csrSignature);if(++r.read,o.signature=r.getBytes(),o.certificationRequestInfo=f.certificationRequestInfo,e){if(o.md=null,o.signatureOid in j){var n=j[o.signatureOid];switch(n){case"sha1WithRSAEncryption":o.md=a.md.sha1.create();break;case"md5WithRSAEncryption":o.md=a.md.md5.create();break;case"sha256WithRSAEncryption":o.md=a.md.sha256.create();break;case"sha512WithRSAEncryption":o.md=a.md.sha512.create();break;case"RSASSA-PSS":o.md=a.md.sha256.create()}}if(null===o.md){var k=new Error("Could not compute certification request digest. Unknown signature OID.");throw k.signatureOid=o.signatureOid,k}var s=h.toDer(o.certificationRequestInfo);o.md.update(s.getBytes());
}var t=a.md.sha1.create();return o.subject.getField=function(a){return b(o.subject,a)},o.subject.addField=function(a){d([a]),o.subject.attributes.push(a)},o.subject.attributes=i.RDNAttributesAsArray(f.certificationRequestInfoSubject,t),o.subject.hash=t.digest().toHex(),o.publicKey=i.publicKeyFromAsn1(f.subjectPublicKeyInfo),o.getAttribute=function(a){return b(o,a)},o.addAttribute=function(a){d([a]),o.attributes.push(a)},o.attributes=i.CRIAttributesAsArray(f.certificationRequestInfoAttributes||[]),o},i.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(a){return b(c.subject,a)},c.subject.addField=function(a){d([a]),c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(a){return b(c,a)},c.addAttribute=function(a){d([a]),c.attributes.push(a)},c.md=null,c.setSubject=function(a){d(a),c.subject.attributes=a,c.subject.hash=null},c.setAttributes=function(a){d(a),c.attributes=a},c.sign=function(b,d){c.md=d||a.md.sha1.create();var e=j[c.md.algorithm+"WithRSAEncryption"];if(!e){var f=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw f.algorithm=c.md.algorithm,f}c.signatureOid=c.siginfo.algorithmOid=e,c.certificationRequestInfo=i.getCertificationRequestInfo(c);var g=h.toDer(c.certificationRequestInfo);c.md.update(g.getBytes()),c.signature=b.sign(c.md)},c.verify=function(){var b=!1,d=c.md;if(null===d){if(c.signatureOid in j){var e=j[c.signatureOid];switch(e){case"sha1WithRSAEncryption":d=a.md.sha1.create();break;case"md5WithRSAEncryption":d=a.md.md5.create();break;case"sha256WithRSAEncryption":d=a.md.sha256.create();break;case"sha512WithRSAEncryption":d=a.md.sha512.create();break;case"RSASSA-PSS":d=a.md.sha256.create()}}if(null===d){var f=new Error("Could not compute certification request digest. Unknown signature OID.");throw f.signatureOid=c.signatureOid,f}var g=c.certificationRequestInfo||i.getCertificationRequestInfo(c),k=h.toDer(g);d.update(k.getBytes())}if(null!==d){var l;switch(c.signatureOid){case j.sha1WithRSAEncryption:break;case j["RSASSA-PSS"]:var m,n;if(m=j[c.signatureParameters.mgf.hash.algorithmOid],void 0===m||void 0===a.md[m]){var f=new Error("Unsupported MGF hash function.");throw f.oid=c.signatureParameters.mgf.hash.algorithmOid,f.name=m,f}if(n=j[c.signatureParameters.mgf.algorithmOid],void 0===n||void 0===a.mgf[n]){var f=new Error("Unsupported MGF function.");throw f.oid=c.signatureParameters.mgf.algorithmOid,f.name=n,f}if(n=a.mgf[n].create(a.md[m].create()),m=j[c.signatureParameters.hash.algorithmOid],void 0===m||void 0===a.md[m]){var f=new Error("Unsupported RSASSA-PSS hash function.");throw f.oid=c.signatureParameters.hash.algorithmOid,f.name=m,f}l=a.pss.create(a.md[m].create(),n,c.signatureParameters.saltLength)}b=c.publicKey.verify(d.digest().getBytes(),c.signature,l)}return b},c},i.getTBSCertificate=function(b){var d=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.version).getBytes())]),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber)),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.siginfo.algorithmOid).getBytes()),f(b.siginfo.algorithmOid,b.siginfo.parameters)]),c(b.issuer),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.UTCTIME,!1,h.dateToUtcTime(b.validity.notBefore)),h.create(h.Class.UNIVERSAL,h.Type.UTCTIME,!1,h.dateToUtcTime(b.validity.notAfter))]),c(b.subject),i.publicKeyToAsn1(b.publicKey)]);return b.issuer.uniqueId&&d.value.push(h.create(h.Class.CONTEXT_SPECIFIC,1,!0,[h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+b.issuer.uniqueId)])),b.subject.uniqueId&&d.value.push(h.create(h.Class.CONTEXT_SPECIFIC,2,!0,[h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+b.subject.uniqueId)])),b.extensions.length>0&&d.value.push(i.certificateExtensionsToAsn1(b.extensions)),d},i.getCertificationRequestInfo=function(a){var b=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(a.version).getBytes()),c(a.subject),i.publicKeyToAsn1(a.publicKey),g(a)]);return b},i.distinguishedNameToAsn1=function(a){return c(a)},i.certificateToAsn1=function(a){var b=a.tbsCertificate||i.getTBSCertificate(a);return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[b,h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.signatureOid).getBytes()),f(a.signatureOid,a.signatureParameters)]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},i.certificateExtensionsToAsn1=function(a){var b=h.create(h.Class.CONTEXT_SPECIFIC,3,!0,[]),c=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);b.value.push(c);for(var d=0;d<a.length;++d)c.value.push(i.certificateExtensionToAsn1(a[d]));return b},i.certificateExtensionToAsn1=function(a){var b=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);b.value.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.id).getBytes())),a.critical&&b.value.push(h.create(h.Class.UNIVERSAL,h.Type.BOOLEAN,!1,String.fromCharCode(255)));var c=a.value;return"string"!=typeof a.value&&(c=h.toDer(c).getBytes()),b.value.push(h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,c)),b},i.certificationRequestToAsn1=function(a){var b=a.certificationRequestInfo||i.getCertificationRequestInfo(a);return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[b,h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.signatureOid).getBytes()),f(a.signatureOid,a.signatureParameters)]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},i.createCaStore=function(b){function d(b){if(!b.hash){var d=a.md.sha1.create();b.attributes=i.RDNAttributesAsArray(c(b),d),b.hash=d.digest().toHex()}return e.certs[b.hash]||null}var e={certs:{}};if(e.getIssuer=function(a){var b=d(a.issuer);return b},e.addCertificate=function(b){if("string"==typeof b&&(b=a.pki.certificateFromPem(b)),!b.subject.hash){var d=a.md.sha1.create();b.subject.attributes=i.RDNAttributesAsArray(c(b.subject),d),b.subject.hash=d.digest().toHex()}if(b.subject.hash in e.certs){var f=e.certs[b.subject.hash];a.util.isArray(f)||(f=[f]),f.push(b)}else e.certs[b.subject.hash]=b},e.hasCertificate=function(b){var c=d(b.subject);if(!c)return!1;a.util.isArray(c)||(c=[c]);for(var e=h.toDer(i.certificateToAsn1(b)).getBytes(),f=0;f<c.length;++f){var g=h.toDer(i.certificateToAsn1(c[f])).getBytes();if(e===g)return!0}return!1},b)for(var f=0;f<b.length;++f){var g=b[f];e.addCertificate(g)}return e},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(b,c,d){c=c.slice(0);var e=c.slice(0),f=new Date,g=!0,h=null,j=0;do{var k=c.shift(),l=null,m=!1;if((f<k.validity.notBefore||f>k.validity.notAfter)&&(h={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:k.validity.notBefore,notAfter:k.validity.notAfter,now:f}),null===h){if(l=c[0]||b.getIssuer(k),null===l&&k.isIssuer(k)&&(m=!0,l=k),l){var n=l;a.util.isArray(n)||(n=[n]);for(var o=!1;!o&&n.length>0;){l=n.shift();try{o=l.verify(k)}catch(p){}}o||(h={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}null!==h||l&&!m||b.hasCertificate(k)||(h={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(null===h&&l&&!k.isIssuer(l)&&(h={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),null===h)for(var q={keyUsage:!0,basicConstraints:!0},r=0;null===h&&r<k.extensions.length;++r){var s=k.extensions[r];!s.critical||s.name in q||(h={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(null===h&&(!g||0===c.length&&(!l||m))){var t=k.getExtension("basicConstraints"),u=k.getExtension("keyUsage");if(null!==u&&(u.keyCertSign&&null!==t||(h={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate})),null!==h||null===t||t.cA||(h={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),null===h&&null!==u&&"pathLenConstraint"in t){var v=j-1;v>t.pathLenConstraint&&(h={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}}var w=null===h?!0:h.error,x=d?d(w,j,e):w;if(x!==!0)throw w===!0&&(h={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(x||0===x)&&("object"!=typeof x||a.util.isArray(x)?"string"==typeof x&&(h.error=x):(x.message&&(h.message=x.message),x.error&&(h.error=x.error))),h;h=null,g=!1,++j}while(c.length>0);return!0}}var d="x509";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pki}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/x509",["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,c,d){for(var e=[],f=0;f<a.length;f++)for(var g=0;g<a[f].safeBags.length;g++){var h=a[f].safeBags[g];(void 0===d||h.type===d)&&(null!==b?void 0!==h.attributes[b]&&h.attributes[b].indexOf(c)>=0&&e.push(h):e.push(h))}return e}function c(b){if(b.composed||b.constructed){for(var c=a.util.createBuffer(),d=0;d<b.value.length;++d)c.putBytes(b.value[d].value);b.composed=b.constructed=!1,b.value=c.getBytes()}return b}function d(a,b,d,g){if(b=h.fromDer(b,d),b.tagClass!==h.Class.UNIVERSAL||b.type!==h.Type.SEQUENCE||b.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var j=0;j<b.value.length;j++){var l=b.value[j],m={},n=[];if(!h.validate(l,k,m,n)){var o=new Error("Cannot read ContentInfo.");throw o.errors=n,o}var p={encrypted:!1},q=null,r=m.content.value[0];switch(h.derToOid(m.contentType)){case i.oids.data:if(r.tagClass!==h.Class.UNIVERSAL||r.type!==h.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");q=c(r).value;break;case i.oids.encryptedData:q=e(r,g),p.encrypted=!0;break;default:var o=new Error("Unsupported PKCS#12 contentType.");throw o.contentType=h.derToOid(m.contentType),o}p.safeBags=f(q,d,g),a.safeContents.push(p)}}function e(b,d){var e={},f=[];if(!h.validate(b,a.pkcs7.asn1.encryptedDataValidator,e,f)){var g=new Error("Cannot read EncryptedContentInfo.");throw g.errors=f,g}var j=h.derToOid(e.contentType);if(j!==i.oids.data){var g=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw g.oid=j,g}j=h.derToOid(e.encAlgorithm);var k=i.pbe.getCipher(j,e.encParameter,d),l=c(e.encryptedContentAsn1),m=a.util.createBuffer(l.value);if(k.update(m),!k.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return k.output.getBytes()}function f(a,b,c){if(!b&&0===a.length)return[];if(a=h.fromDer(a,b),a.tagClass!==h.Class.UNIVERSAL||a.type!==h.Type.SEQUENCE||a.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var d=[],e=0;e<a.value.length;e++){var f=a.value[e],j={},k=[];if(!h.validate(f,m,j,k)){var l=new Error("Cannot read SafeBag.");throw l.errors=k,l}var n={type:h.derToOid(j.bagId),attributes:g(j.bagAttributes)};d.push(n);var p,q,r=j.bagValue.value[0];switch(n.type){case i.oids.pkcs8ShroudedKeyBag:if(r=i.decryptPrivateKeyInfo(r,c),null===r)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case i.oids.keyBag:try{n.key=i.privateKeyFromAsn1(r)}catch(s){n.key=null,n.asn1=r}continue;case i.oids.certBag:p=o,q=function(){if(h.derToOid(j.certId)!==i.oids.x509Certificate){var a=new Error("Unsupported certificate type, only X.509 supported.");throw a.oid=h.derToOid(j.certId),a}var c=h.fromDer(j.cert,b);try{n.cert=i.certificateFromAsn1(c,!0)}catch(d){n.cert=null,n.asn1=c}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=n.type,l}if(void 0!==p&&!h.validate(r,p,j,k)){var l=new Error("Cannot read PKCS#12 "+p.name);throw l.errors=k,l}q()}return d}function g(a){var b={};if(void 0!==a)for(var c=0;c<a.length;++c){var d={},e=[];if(!h.validate(a[c],n,d,e)){var f=new Error("Cannot read PKCS#12 BagAttribute.");throw f.errors=e,f}var g=h.derToOid(d.oid);if(void 0!==i.oids[g]){b[i.oids[g]]=[];for(var j=0;j<d.values.length;++j)b[i.oids[g]].push(d.values[j].value)}}return b}var h=a.asn1,i=a.pki,j=a.pkcs12=a.pkcs12||{},k={name:"ContentInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:h.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},l={name:"PFX",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"version"},k,{name:"PFX.macData",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:h.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},m={name:"SafeBag",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:h.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},n={name:"Attribute",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0,capture:"values"}]},o={name:"CertBag",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:h.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:h.Class.UNIVERSAL,type:h.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};j.pkcs12FromAsn1=function(e,f,g){"string"==typeof f?(g=f,f=!0):void 0===f&&(f=!0);var k={},m=[];if(!h.validate(e,l,k,m)){var n=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw n.errors=n,n}var o={version:k.version.charCodeAt(0),safeContents:[],getBags:function(c){var d,e={};return"localKeyId"in c?d=c.localKeyId:"localKeyIdHex"in c&&(d=a.util.hexToBytes(c.localKeyIdHex)),void 0===d&&!("friendlyName"in c)&&"bagType"in c&&(e[c.bagType]=b(o.safeContents,null,null,c.bagType)),void 0!==d&&(e.localKeyId=b(o.safeContents,"localKeyId",d,c.bagType)),"friendlyName"in c&&(e.friendlyName=b(o.safeContents,"friendlyName",c.friendlyName,c.bagType)),e},getBagsByFriendlyName:function(a,c){return b(o.safeContents,"friendlyName",a,c)},getBagsByLocalKeyId:function(a,c){return b(o.safeContents,"localKeyId",a,c)}};if(3!==k.version.charCodeAt(0)){var n=new Error("PKCS#12 PFX of version other than 3 not supported.");throw n.version=k.version.charCodeAt(0),n}if(h.derToOid(k.contentType)!==i.oids.data){var n=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw n.oid=h.derToOid(k.contentType),n}var p=k.content.value[0];if(p.tagClass!==h.Class.UNIVERSAL||p.type!==h.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(p=c(p),k.mac){var q=null,r=0,s=h.derToOid(k.macAlgorithm);switch(s){case i.oids.sha1:q=a.md.sha1.create(),r=20;break;case i.oids.sha256:q=a.md.sha256.create(),r=32;break;case i.oids.sha384:q=a.md.sha384.create(),r=48;break;case i.oids.sha512:q=a.md.sha512.create(),r=64;break;case i.oids.md5:q=a.md.md5.create(),r=16}if(null===q)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+s);var t=new a.util.ByteBuffer(k.macSalt),u="macIterations"in k?parseInt(a.util.bytesToHex(k.macIterations),16):1,v=j.generateKey(g,t,3,u,r,q),w=a.hmac.create();w.start(q,v),w.update(p.value);var x=w.getMac();if(x.getBytes()!==k.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return d(o,p.value,f,g),o},j.toPkcs12Asn1=function(b,c,d,e){e=e||{},e.saltSize=e.saltSize||8,e.count=e.count||2048,e.algorithm=e.algorithm||e.encAlgorithm||"aes128","useMac"in e||(e.useMac=!0),"localKeyId"in e||(e.localKeyId=null),"generateLocalKeyId"in e||(e.generateLocalKeyId=!0);var f,g=e.localKeyId;if(null!==g)g=a.util.hexToBytes(g);else if(e.generateLocalKeyId)if(c){var k=a.util.isArray(c)?c[0]:c;"string"==typeof k&&(k=i.certificateFromPem(k));var l=a.md.sha1.create();l.update(h.toDer(i.certificateToAsn1(k)).getBytes()),g=l.digest().getBytes()}else g=a.random.getBytes(20);var m=[];null!==g&&m.push(h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.localKeyId).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,g)])])),"friendlyName"in e&&m.push(h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.friendlyName).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,h.Type.BMPSTRING,!1,e.friendlyName)])])),m.length>0&&(f=h.create(h.Class.UNIVERSAL,h.Type.SET,!0,m));var n=[],o=[];null!==c&&(o=a.util.isArray(c)?c:[c]);for(var p=[],q=0;q<o.length;++q){c=o[q],"string"==typeof c&&(c=i.certificateFromPem(c));var r=0===q?f:void 0,s=i.certificateToAsn1(c),t=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.certBag).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.x509Certificate).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(s).getBytes())])])]),r]);p.push(t)}if(p.length>0){var u=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,p),v=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.data).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(u).getBytes())])]);n.push(v)}var w=null;if(null!==b){var x=i.wrapRsaPrivateKey(i.privateKeyToAsn1(b));w=null===d?h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.keyBag).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[x]),f]):h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.pkcs8ShroudedKeyBag).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[i.encryptPrivateKeyInfo(x,d,e)]),f]);var y=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[w]),z=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.data).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(y).getBytes())])]);n.push(z)}var A,B=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,n);if(e.useMac){var l=a.md.sha1.create(),C=new a.util.ByteBuffer(a.random.getBytes(e.saltSize)),D=e.count,b=j.generateKey(d,C,3,D,20),E=a.hmac.create();E.start(l,b),E.update(h.toDer(B).getBytes());var F=E.getMac();A=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.sha1).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,F.getBytes())]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,C.getBytes()),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(D).getBytes())])}return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(3).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.data).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(B).getBytes())])]),A])},j.generateKey=a.pbe.generatePkcs12Key}var d="pkcs12";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pki=a.pki||{};c.pemToDer=function(b){var c=a.pem.decode(b)[0];if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return a.util.createBuffer(c.body)},c.privateKeyFromPem=function(d){var e=a.pem.decode(d)[0];if("PRIVATE KEY"!==e.type&&"RSA PRIVATE KEY"!==e.type){var f=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw f.headerType=e.type,f}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var g=b.fromDer(e.body);return c.privateKeyFromAsn1(g)},c.privateKeyToPem=function(d,e){var f={type:"RSA PRIVATE KEY",body:b.toDer(c.privateKeyToAsn1(d)).getBytes()};return a.pem.encode(f,{maxline:e})},c.privateKeyInfoToPem=function(c,d){var e={type:"PRIVATE KEY",body:b.toDer(c).getBytes()};return a.pem.encode(e,{maxline:d})}}var d="pki";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pki",["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=function(b,c,d,e){var f=a.util.createBuffer(),g=b.length>>1,h=g+(1&b.length),i=b.substr(0,h),j=b.substr(g,h),k=a.util.createBuffer(),l=a.hmac.create();d=c+d;var m=Math.ceil(e/16),n=Math.ceil(e/20);l.start("MD5",i);var o=a.util.createBuffer();k.putBytes(d);for(var p=0;m>p;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+d),o.putBuffer(l.digest());l.start("SHA1",j);var q=a.util.createBuffer();k.clear(),k.putBytes(d);for(var p=0;n>p;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+d),q.putBuffer(l.digest());return f.putBytes(a.util.xorBytes(o.getBytes(),q.getBytes(),e)),f},c=function(b,c,d){var e=a.hmac.create();e.start("SHA1",b);var f=a.util.createBuffer();return f.putInt32(c[0]),f.putInt32(c[1]),f.putByte(d.type),f.putByte(d.version.major),f.putByte(d.version.minor),f.putInt16(d.length),f.putBytes(d.fragment.bytes()),e.update(f.getBytes()),e.digest().getBytes()},d=function(b,c,d){var e=!1;try{var f=b.deflate(c.fragment.getBytes());c.fragment=a.util.createBuffer(f),c.length=f.length,e=!0}catch(g){}return e},e=function(b,c,d){var e=!1;try{var f=b.inflate(c.fragment.getBytes());c.fragment=a.util.createBuffer(f),c.length=f.length,e=!0}catch(g){}return e},f=function(b,c){var d=0;switch(c){case 1:d=b.getByte();break;case 2:d=b.getInt16();break;case 3:d=b.getInt24();break;case 4:d=b.getInt32()}return a.util.createBuffer(b.getBytes(d))},g=function(a,b,c){a.putInt(c.length(),b<<3),a.putBuffer(c)},h={};h.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},h.SupportedVersions=[h.Versions.TLS_1_1,h.Versions.TLS_1_0],h.Version=h.SupportedVersions[0],h.MaxFragment=15360,h.ConnectionEnd={server:0,client:1},h.PRFAlgorithm={tls_prf_sha256:0},h.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},h.CipherType={stream:0,block:1,aead:2},h.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},h.CompressionMethod={none:0,deflate:1},h.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},h.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},h.Alert={},h.Alert.Level={warning:1,fatal:2},h.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},h.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},h.CipherSuites={},h.getCipherSuite=function(a){var b=null;for(var c in h.CipherSuites){var d=h.CipherSuites[c];if(d.id[0]===a.charCodeAt(0)&&d.id[1]===a.charCodeAt(1)){b=d;break}}return b},h.handleUnexpected=function(a,b){var c=!a.open&&a.entity===h.ConnectionEnd.client;c||a.error(a,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})},h.handleHelloRequest=function(a,b,c){!a.handshaking&&a.handshakes>0&&(h.queue(a,h.createAlert(a,{level:h.Alert.Level.warning,description:h.Alert.Description.no_renegotiation})),h.flush(a)),a.process()},h.parseHelloMessage=function(b,c,d){var e=null,g=b.entity===h.ConnectionEnd.client;if(38>d)b.error(b,{message:g?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var i=c.fragment,j=i.length();if(e={version:{major:i.getByte(),minor:i.getByte()},random:a.util.createBuffer(i.getBytes(32)),session_id:f(i,1),extensions:[]},g?(e.cipher_suite=i.getBytes(2),e.compression_method=i.getByte()):(e.cipher_suites=f(i,2),e.compression_methods=f(i,1)),j=d-(j-i.length()),j>0){for(var k=f(i,2);k.length()>0;)e.extensions.push({type:[k.getByte(),k.getByte()],data:f(k,2)});if(!g)for(var l=0;l<e.extensions.length;++l){var m=e.extensions[l];if(0===m.type[0]&&0===m.type[1])for(var n=f(m.data,2);n.length()>0;){var o=n.getByte();if(0!==o)break;b.session.extensions.server_name.serverNameList.push(f(n,2).getBytes())}}}if(b.session.version&&(e.version.major!==b.session.version.major||e.version.minor!==b.session.version.minor))return b.error(b,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}});if(g)b.session.cipherSuite=h.getCipherSuite(e.cipher_suite);else for(var p=a.util.createBuffer(e.cipher_suites.bytes());p.length()>0&&(b.session.cipherSuite=h.getCipherSuite(p.getBytes(2)),null===b.session.cipherSuite););if(null===b.session.cipherSuite)return b.error(b,{message:"No cipher suites in common.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(e.cipher_suite)});g?b.session.compressionMethod=e.compression_method:b.session.compressionMethod=h.CompressionMethod.none}return e},h.createSecurityParameters=function(a,b){var c=a.entity===h.ConnectionEnd.client,d=b.random.bytes(),e=c?a.session.sp.client_random:d,f=c?d:h.createRandom().getBytes();a.session.sp={entity:a.entity,prf_algorithm:h.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:a.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:e,server_random:f}},h.handleServerHello=function(a,b,c){var d=h.parseHelloMessage(a,b,c);if(!a.fail){if(!(d.version.minor<=a.version.minor))return a.error(a,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}});a.version.minor=d.version.minor,a.session.version=a.version;var e=d.session_id.bytes();e.length>0&&e===a.session.id?(a.expect=n,a.session.resuming=!0,a.session.sp.server_random=d.random.bytes()):(a.expect=j,a.session.resuming=!1,h.createSecurityParameters(a,d)),a.session.id=e,a.process()}},h.handleClientHello=function(b,c,d){var e=h.parseHelloMessage(b,c,d);if(!b.fail){var f=e.session_id.bytes(),g=null;if(b.sessionCache&&(g=b.sessionCache.getSession(f),null===g?f="":(g.version.major!==e.version.major||g.version.minor>e.version.minor)&&(g=null,f="")),0===f.length&&(f=a.random.getBytes(32)),b.session.id=f,b.session.clientHelloVersion=e.version,b.session.sp={},g)b.version=b.session.version=g.version,b.session.sp=g.sp;else{for(var i,j=1;j<h.SupportedVersions.length&&(i=h.SupportedVersions[j],!(i.minor<=e.version.minor));++j);b.version={major:i.major,minor:i.minor},b.session.version=b.version}null!==g?(b.expect=v,b.session.resuming=!0,b.session.sp.client_random=e.random.bytes()):(b.expect=b.verifyClient!==!1?s:t,b.session.resuming=!1,h.createSecurityParameters(b,e)),b.open=!0,h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,
data:h.createServerHello(b)})),b.session.resuming?(h.queue(b,h.createRecord(b,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),b.state.pending=h.createConnectionState(b),b.state.current.write=b.state.pending.write,h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createFinished(b)}))):(h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createCertificate(b)})),b.fail||(h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createServerKeyExchange(b)})),b.verifyClient!==!1&&h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createCertificateRequest(b)})),h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createServerHelloDone(b)})))),h.flush(b),b.process()}},h.handleCertificate=function(b,c,d){if(3>d)return b.error(b,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var e,g,i=c.fragment,j={certificate_list:f(i,3)},l=[];try{for(;j.certificate_list.length()>0;)e=f(j.certificate_list,3),g=a.asn1.fromDer(e),e=a.pki.certificateFromAsn1(g,!0),l.push(e)}catch(m){return b.error(b,{message:"Could not parse certificate list.",cause:m,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}var n=b.entity===h.ConnectionEnd.client;!n&&b.verifyClient!==!0||0!==l.length?0===l.length?b.expect=n?k:t:(n?b.session.serverCertificate=l[0]:b.session.clientCertificate=l[0],h.verifyCertificateChain(b,l)&&(b.expect=n?k:t)):b.error(b,{message:n?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}}),b.process()},h.handleServerKeyExchange=function(a,b,c){return c>0?a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}}):(a.expect=l,void a.process())},h.handleClientKeyExchange=function(b,c,d){if(48>d)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}});var e=c.fragment,g={enc_pre_master_secret:f(e,2).getBytes()},i=null;if(b.getPrivateKey)try{i=b.getPrivateKey(b,b.session.serverCertificate),i=a.pki.privateKeyFromPem(i)}catch(j){b.error(b,{message:"Could not get private key.",cause:j,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}if(null===i)return b.error(b,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}});try{var k=b.session.sp;k.pre_master_secret=i.decrypt(g.enc_pre_master_secret);var l=b.session.clientHelloVersion;if(l.major!==k.pre_master_secret.charCodeAt(0)||l.minor!==k.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(j){k.pre_master_secret=a.random.getBytes(48)}b.expect=v,null!==b.session.clientCertificate&&(b.expect=u),b.process()},h.handleCertificateRequest=function(a,b,c){if(3>c)return a.error(a,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var d=b.fragment,e={certificate_types:f(d,1),certificate_authorities:f(d,2)};a.session.certificateRequest=e,a.expect=m,a.process()},h.handleCertificateVerify=function(b,c,d){if(2>d)return b.error(b,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var e=c.fragment;e.read-=4;var g=e.bytes();e.read+=4;var i={signature:f(e,2).getBytes()},j=a.util.createBuffer();j.putBuffer(b.session.md5.digest()),j.putBuffer(b.session.sha1.digest()),j=j.getBytes();try{var k=b.session.clientCertificate;if(!k.publicKey.verify(j,i.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");b.session.md5.update(g),b.session.sha1.update(g)}catch(l){return b.error(b,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure}})}b.expect=v,b.process()},h.handleServerHelloDone=function(b,c,d){if(d>0)return b.error(b,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.record_overflow}});if(null===b.serverCertificate){var e={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.insufficient_security}},f=0,g=b.verify(b,e.alert.description,f,[]);if(g!==!0)return(g||0===g)&&("object"!=typeof g||a.util.isArray(g)?"number"==typeof g&&(e.alert.description=g):(g.message&&(e.message=g.message),g.alert&&(e.alert.description=g.alert))),b.error(b,e)}null!==b.session.certificateRequest&&(c=h.createRecord(b,{type:h.ContentType.handshake,data:h.createCertificate(b)}),h.queue(b,c)),c=h.createRecord(b,{type:h.ContentType.handshake,data:h.createClientKeyExchange(b)}),h.queue(b,c),b.expect=q;var i=function(a,b){null!==a.session.certificateRequest&&null!==a.session.clientCertificate&&h.queue(a,h.createRecord(a,{type:h.ContentType.handshake,data:h.createCertificateVerify(a,b)})),h.queue(a,h.createRecord(a,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),a.state.pending=h.createConnectionState(a),a.state.current.write=a.state.pending.write,h.queue(a,h.createRecord(a,{type:h.ContentType.handshake,data:h.createFinished(a)})),a.expect=n,h.flush(a),a.process()};return null===b.session.certificateRequest||null===b.session.clientCertificate?i(b,null):void h.getClientSignature(b,i)},h.handleChangeCipherSpec=function(a,b){if(1!==b.fragment.getByte())return a.error(a,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var c=a.entity===h.ConnectionEnd.client;(a.session.resuming&&c||!a.session.resuming&&!c)&&(a.state.pending=h.createConnectionState(a)),a.state.current.read=a.state.pending.read,(!a.session.resuming&&c||a.session.resuming&&!c)&&(a.state.pending=null),a.expect=c?o:w,a.process()},h.handleFinished=function(c,d,e){var f=d.fragment;f.read-=4;var g=f.bytes();f.read+=4;var i=d.fragment.getBytes();f=a.util.createBuffer(),f.putBuffer(c.session.md5.digest()),f.putBuffer(c.session.sha1.digest());var j=c.entity===h.ConnectionEnd.client,k=j?"server finished":"client finished",l=c.session.sp,m=12,n=b;return f=n(l.master_secret,k,f.getBytes(),m),f.getBytes()!==i?c.error(c,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decrypt_error}}):(c.session.md5.update(g),c.session.sha1.update(g),(c.session.resuming&&j||!c.session.resuming&&!j)&&(h.queue(c,h.createRecord(c,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),c.state.current.write=c.state.pending.write,c.state.pending=null,h.queue(c,h.createRecord(c,{type:h.ContentType.handshake,data:h.createFinished(c)}))),c.expect=j?p:x,c.handshaking=!1,++c.handshakes,c.peerCertificate=j?c.session.serverCertificate:c.session.clientCertificate,h.flush(c),c.isConnected=!0,c.connected(c),void c.process())},h.handleAlert=function(a,b){var c,d=b.fragment,e={level:d.getByte(),description:d.getByte()};switch(e.description){case h.Alert.Description.close_notify:c="Connection closed.";break;case h.Alert.Description.unexpected_message:c="Unexpected message.";break;case h.Alert.Description.bad_record_mac:c="Bad record MAC.";break;case h.Alert.Description.decryption_failed:c="Decryption failed.";break;case h.Alert.Description.record_overflow:c="Record overflow.";break;case h.Alert.Description.decompression_failure:c="Decompression failed.";break;case h.Alert.Description.handshake_failure:c="Handshake failure.";break;case h.Alert.Description.bad_certificate:c="Bad certificate.";break;case h.Alert.Description.unsupported_certificate:c="Unsupported certificate.";break;case h.Alert.Description.certificate_revoked:c="Certificate revoked.";break;case h.Alert.Description.certificate_expired:c="Certificate expired.";break;case h.Alert.Description.certificate_unknown:c="Certificate unknown.";break;case h.Alert.Description.illegal_parameter:c="Illegal parameter.";break;case h.Alert.Description.unknown_ca:c="Unknown certificate authority.";break;case h.Alert.Description.access_denied:c="Access denied.";break;case h.Alert.Description.decode_error:c="Decode error.";break;case h.Alert.Description.decrypt_error:c="Decrypt error.";break;case h.Alert.Description.export_restriction:c="Export restriction.";break;case h.Alert.Description.protocol_version:c="Unsupported protocol version.";break;case h.Alert.Description.insufficient_security:c="Insufficient security.";break;case h.Alert.Description.internal_error:c="Internal error.";break;case h.Alert.Description.user_canceled:c="User canceled.";break;case h.Alert.Description.no_renegotiation:c="Renegotiation not supported.";break;default:c="Unknown error."}return e.description===h.Alert.Description.close_notify?a.close():(a.error(a,{message:c,send:!1,origin:a.entity===h.ConnectionEnd.client?"server":"client",alert:e}),void a.process())},h.handleHandshake=function(b,c){var d=c.fragment,e=d.getByte(),f=d.getInt24();if(f>d.length())return b.fragmented=c,c.fragment=a.util.createBuffer(),d.read-=4,b.process();b.fragmented=null,d.read-=4;var g=d.bytes(f+4);d.read+=4,e in M[b.entity][b.expect]?(b.entity!==h.ConnectionEnd.server||b.open||b.fail||(b.handshaking=!0,b.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),e!==h.HandshakeType.hello_request&&e!==h.HandshakeType.certificate_verify&&e!==h.HandshakeType.finished&&(b.session.md5.update(g),b.session.sha1.update(g)),M[b.entity][b.expect][e](b,c,f)):h.handleUnexpected(b,c)},h.handleApplicationData=function(a,b){a.data.putBuffer(b.fragment),a.dataReady(a),a.process()},h.handleHeartbeat=function(b,c){var d=c.fragment,e=d.getByte(),f=d.getInt16(),g=d.getBytes(f);if(e===h.HeartbeatMessageType.heartbeat_request){if(b.handshaking||f>g.length)return b.process();h.queue(b,h.createRecord(b,{type:h.ContentType.heartbeat,data:h.createHeartbeat(h.HeartbeatMessageType.heartbeat_response,g)})),h.flush(b)}else if(e===h.HeartbeatMessageType.heartbeat_response){if(g!==b.expectedHeartbeatPayload)return b.process();b.heartbeatReceived&&b.heartbeatReceived(b,a.util.createBuffer(g))}b.process()};var i=0,j=1,k=2,l=3,m=4,n=5,o=6,p=7,q=8,r=0,s=1,t=2,u=3,v=4,w=5,x=6,y=h.handleUnexpected,z=h.handleChangeCipherSpec,A=h.handleAlert,B=h.handleHandshake,C=h.handleApplicationData,D=h.handleHeartbeat,E=[];E[h.ConnectionEnd.client]=[[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[z,A,y,y,D],[y,A,B,y,D],[y,A,B,C,D],[y,A,B,y,D]],E[h.ConnectionEnd.server]=[[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[z,A,y,y,D],[y,A,B,y,D],[y,A,B,C,D],[y,A,B,y,D]];var F=h.handleHelloRequest,G=h.handleServerHello,H=h.handleCertificate,I=h.handleServerKeyExchange,J=h.handleCertificateRequest,K=h.handleServerHelloDone,L=h.handleFinished,M=[];M[h.ConnectionEnd.client]=[[y,y,G,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,H,I,J,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,I,J,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,J,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,L],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]];var N=h.handleClientHello,O=h.handleClientKeyExchange,P=h.handleCertificateVerify;M[h.ConnectionEnd.server]=[[y,N,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,H,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,O,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,P,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,L],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]],h.generateKeys=function(a,c){var d=b,e=c.client_random+c.server_random;a.session.resuming||(c.master_secret=d(c.pre_master_secret,"master secret",e,48).bytes(),c.pre_master_secret=null),e=c.server_random+c.client_random;var f=2*c.mac_key_length+2*c.enc_key_length,g=a.version.major===h.Versions.TLS_1_0.major&&a.version.minor===h.Versions.TLS_1_0.minor;g&&(f+=2*c.fixed_iv_length);var i=d(c.master_secret,"key expansion",e,f),j={client_write_MAC_key:i.getBytes(c.mac_key_length),server_write_MAC_key:i.getBytes(c.mac_key_length),client_write_key:i.getBytes(c.enc_key_length),server_write_key:i.getBytes(c.enc_key_length)};return g&&(j.client_write_IV=i.getBytes(c.fixed_iv_length),j.server_write_IV=i.getBytes(c.fixed_iv_length)),j},h.createConnectionState=function(a){var b=a.entity===h.ConnectionEnd.client,c=function(){var a={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){4294967295===a.sequenceNumber[1]?(a.sequenceNumber[1]=0,++a.sequenceNumber[0]):++a.sequenceNumber[1]}};return a},f={read:c(),write:c()};if(f.read.update=function(a,b){return f.read.cipherFunction(b,f.read)?f.read.compressFunction(a,b,f.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decompression_failure}}):a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_record_mac}}),!a.fail},f.write.update=function(a,b){return f.write.compressFunction(a,b,f.write)?f.write.cipherFunction(b,f.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}),!a.fail},a.session){var g=a.session.sp;switch(a.session.cipherSuite.initSecurityParameters(g),g.keys=h.generateKeys(a,g),f.read.macKey=b?g.keys.server_write_MAC_key:g.keys.client_write_MAC_key,f.write.macKey=b?g.keys.client_write_MAC_key:g.keys.server_write_MAC_key,a.session.cipherSuite.initConnectionState(f,a,g),g.compression_algorithm){case h.CompressionMethod.none:break;case h.CompressionMethod.deflate:f.read.compressFunction=e,f.write.compressFunction=d;break;default:throw new Error("Unsupported compression algorithm.")}}return f},h.createRandom=function(){var b=new Date,c=+b+6e4*b.getTimezoneOffset(),d=a.util.createBuffer();return d.putInt32(c),d.putBytes(a.random.getBytes(28)),d},h.createRecord=function(a,b){if(!b.data)return null;var c={type:b.type,version:{major:a.version.major,minor:a.version.minor},length:b.data.length(),fragment:b.data};return c},h.createAlert=function(b,c){var d=a.util.createBuffer();return d.putByte(c.level),d.putByte(c.description),h.createRecord(b,{type:h.ContentType.alert,data:d})},h.createClientHello=function(b){b.session.clientHelloVersion={major:b.version.major,minor:b.version.minor};for(var c=a.util.createBuffer(),d=0;d<b.cipherSuites.length;++d){var e=b.cipherSuites[d];c.putByte(e.id[0]),c.putByte(e.id[1])}var f=c.length(),i=a.util.createBuffer();i.putByte(h.CompressionMethod.none);var j=i.length(),k=a.util.createBuffer();if(b.virtualHost){var l=a.util.createBuffer();l.putByte(0),l.putByte(0);var m=a.util.createBuffer();m.putByte(0),g(m,2,a.util.createBuffer(b.virtualHost));var n=a.util.createBuffer();g(n,2,m),g(l,2,n),k.putBuffer(l)}var o=k.length();o>0&&(o+=2);var p=b.session.id,q=p.length+1+2+4+28+2+f+1+j+o,r=a.util.createBuffer();return r.putByte(h.HandshakeType.client_hello),r.putInt24(q),r.putByte(b.version.major),r.putByte(b.version.minor),r.putBytes(b.session.sp.client_random),g(r,1,a.util.createBuffer(p)),g(r,2,c),g(r,1,i),o>0&&g(r,2,k),r},h.createServerHello=function(b){var c=b.session.id,d=c.length+1+2+4+28+2+1,e=a.util.createBuffer();return e.putByte(h.HandshakeType.server_hello),e.putInt24(d),e.putByte(b.version.major),e.putByte(b.version.minor),e.putBytes(b.session.sp.server_random),g(e,1,a.util.createBuffer(c)),e.putByte(b.session.cipherSuite.id[0]),e.putByte(b.session.cipherSuite.id[1]),e.putByte(b.session.compressionMethod),e},h.createCertificate=function(b){var c=b.entity===h.ConnectionEnd.client,d=null;if(b.getCertificate){var e;e=c?b.session.certificateRequest:b.session.extensions.server_name.serverNameList,d=b.getCertificate(b,e)}var f=a.util.createBuffer();if(null!==d)try{a.util.isArray(d)||(d=[d]);for(var i=null,j=0;j<d.length;++j){var k=a.pem.decode(d[j])[0];if("CERTIFICATE"!==k.type&&"X509 CERTIFICATE"!==k.type&&"TRUSTED CERTIFICATE"!==k.type){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=k.type,l}if(k.procType&&"ENCRYPTED"===k.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var m=a.util.createBuffer(k.body);null===i&&(i=a.asn1.fromDer(m.bytes(),!1));var n=a.util.createBuffer();g(n,3,m),f.putBuffer(n)}d=a.pki.certificateFromAsn1(i),c?b.session.clientCertificate=d:b.session.serverCertificate=d}catch(o){return b.error(b,{message:"Could not send certificate list.",cause:o,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}var p=3+f.length(),q=a.util.createBuffer();return q.putByte(h.HandshakeType.certificate),q.putInt24(p),g(q,3,f),q},h.createClientKeyExchange=function(b){var c=a.util.createBuffer();c.putByte(b.session.clientHelloVersion.major),c.putByte(b.session.clientHelloVersion.minor),c.putBytes(a.random.getBytes(46));var d=b.session.sp;d.pre_master_secret=c.getBytes();var e=b.session.serverCertificate.publicKey;c=e.encrypt(d.pre_master_secret);var f=c.length+2,g=a.util.createBuffer();return g.putByte(h.HandshakeType.client_key_exchange),g.putInt24(f),g.putInt16(c.length),g.putBytes(c),g},h.createServerKeyExchange=function(b){var c=0,d=a.util.createBuffer();return c>0&&(d.putByte(h.HandshakeType.server_key_exchange),d.putInt24(c)),d},h.getClientSignature=function(b,c){var d=a.util.createBuffer();d.putBuffer(b.session.md5.digest()),d.putBuffer(b.session.sha1.digest()),d=d.getBytes(),b.getSignature=b.getSignature||function(b,c,d){var e=null;if(b.getPrivateKey)try{e=b.getPrivateKey(b,b.session.clientCertificate),e=a.pki.privateKeyFromPem(e)}catch(f){b.error(b,{message:"Could not get private key.",cause:f,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}null===e?b.error(b,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):c=e.sign(c,null),d(b,c)},b.getSignature(b,d,c)},h.createCertificateVerify=function(b,c){var d=c.length+2,e=a.util.createBuffer();return e.putByte(h.HandshakeType.certificate_verify),e.putInt24(d),e.putInt16(c.length),e.putBytes(c),e},h.createCertificateRequest=function(b){var c=a.util.createBuffer();c.putByte(1);var d=a.util.createBuffer();for(var e in b.caStore.certs){var f=b.caStore.certs[e],i=a.pki.distinguishedNameToAsn1(f.subject);d.putBuffer(a.asn1.toDer(i))}var j=1+c.length()+2+d.length(),k=a.util.createBuffer();return k.putByte(h.HandshakeType.certificate_request),k.putInt24(j),g(k,1,c),g(k,2,d),k},h.createServerHelloDone=function(b){var c=a.util.createBuffer();return c.putByte(h.HandshakeType.server_hello_done),c.putInt24(0),c},h.createChangeCipherSpec=function(){var b=a.util.createBuffer();return b.putByte(1),b},h.createFinished=function(c){var d=a.util.createBuffer();d.putBuffer(c.session.md5.digest()),d.putBuffer(c.session.sha1.digest());var e=c.entity===h.ConnectionEnd.client,f=c.session.sp,g=12,i=b,j=e?"client finished":"server finished";d=i(f.master_secret,j,d.getBytes(),g);var k=a.util.createBuffer();return k.putByte(h.HandshakeType.finished),k.putInt24(d.length()),k.putBuffer(d),k},h.createHeartbeat=function(b,c,d){"undefined"==typeof d&&(d=c.length);var e=a.util.createBuffer();e.putByte(b),e.putInt16(d),e.putBytes(c);var f=e.length(),g=Math.max(16,f-d-3);return e.putBytes(a.random.getBytes(g)),e},h.queue=function(b,c){if(c){if(c.type===h.ContentType.handshake){var d=c.fragment.bytes();b.session.md5.update(d),b.session.sha1.update(d),d=null}var e;if(c.fragment.length()<=h.MaxFragment)e=[c];else{e=[];for(var f=c.fragment.bytes();f.length>h.MaxFragment;)e.push(h.createRecord(b,{type:c.type,data:a.util.createBuffer(f.slice(0,h.MaxFragment))})),f=f.slice(h.MaxFragment);f.length>0&&e.push(h.createRecord(b,{type:c.type,data:a.util.createBuffer(f)}))}for(var g=0;g<e.length&&!b.fail;++g){var i=e[g],j=b.state.current.write;j.update(b,i)&&b.records.push(i)}}},h.flush=function(a){for(var b=0;b<a.records.length;++b){var c=a.records[b];a.tlsData.putByte(c.type),a.tlsData.putByte(c.version.major),a.tlsData.putByte(c.version.minor),a.tlsData.putInt16(c.fragment.length()),a.tlsData.putBuffer(a.records[b].fragment)}return a.records=[],a.tlsDataReady(a)};var Q=function(b){switch(b){case!0:return!0;case a.pki.certificateError.bad_certificate:return h.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return h.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return h.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return h.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return h.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return h.Alert.Description.unknown_ca;default:return h.Alert.Description.bad_certificate}},R=function(b){switch(b){case!0:return!0;case h.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case h.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case h.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case h.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case h.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case h.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};h.verifyCertificateChain=function(b,c){try{a.pki.verifyCertificateChain(b.caStore,c,function(c,d,e){var f=(Q(c),b.verify(b,c,d,e));if(f!==!0){if("object"==typeof f&&!a.util.isArray(f)){var g=new Error("The application rejected the certificate.");throw g.send=!0,g.alert={level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate},f.message&&(g.message=f.message),f.alert&&(g.alert.description=f.alert),g}f!==c&&(f=R(f))}return f})}catch(d){var e=d;("object"!=typeof e||a.util.isArray(e))&&(e={send:!0,alert:{level:h.Alert.Level.fatal,description:Q(d)}}),"send"in e||(e.send=!0),"alert"in e||(e.alert={level:h.Alert.Level.fatal,description:Q(e.error)}),b.error(b,e)}return!b.fail},h.createSessionCache=function(b,c){var d=null;if(b&&b.getSession&&b.setSession&&b.order)d=b;else{d={},d.cache=b||{},d.capacity=Math.max(c||100,1),d.order=[];for(var e in b)d.order.length<=c?d.order.push(e):delete b[e];d.getSession=function(b){var c=null,e=null;if(b?e=a.util.bytesToHex(b):d.order.length>0&&(e=d.order[0]),null!==e&&e in d.cache){c=d.cache[e],delete d.cache[e];for(var f in d.order)if(d.order[f]===e){d.order.splice(f,1);break}}return c},d.setSession=function(b,c){if(d.order.length===d.capacity){var e=d.order.shift();delete d.cache[e]}var e=a.util.bytesToHex(b);d.order.push(e),d.cache[e]=c}}return d},h.createConnection=function(b){var c=null;c=b.caStore?a.util.isArray(b.caStore)?a.pki.createCaStore(b.caStore):b.caStore:a.pki.createCaStore();var d=b.cipherSuites||null;if(null===d){d=[];for(var e in h.CipherSuites)d.push(h.CipherSuites[e])}var f=b.server?h.ConnectionEnd.server:h.ConnectionEnd.client,g=b.sessionCache?h.createSessionCache(b.sessionCache):null,j={version:{major:h.Version.major,minor:h.Version.minor},entity:f,sessionId:b.sessionId,caStore:c,sessionCache:g,cipherSuites:d,connected:b.connected,virtualHost:b.virtualHost||null,verifyClient:b.verifyClient||!1,verify:b.verify||function(a,b,c,d){return b},getCertificate:b.getCertificate||null,getPrivateKey:b.getPrivateKey||null,getSignature:b.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:b.tlsDataReady,dataReady:b.dataReady,heartbeatReceived:b.heartbeatReceived,closed:b.closed,error:function(a,c){c.origin=c.origin||(a.entity===h.ConnectionEnd.client?"client":"server"),c.send&&(h.queue(a,h.createAlert(a,c.alert)),h.flush(a));var d=c.fatal!==!1;d&&(a.fail=!0),b.error(a,c),d&&a.close(!1)},deflate:b.deflate||null,inflate:b.inflate||null};j.reset=function(a){j.version={major:h.Version.major,minor:h.Version.minor},j.record=null,j.session=null,j.peerCertificate=null,j.state={pending:null,current:null},j.expect=j.entity===h.ConnectionEnd.client?i:r,j.fragmented=null,j.records=[],j.open=!1,j.handshakes=0,j.handshaking=!1,j.isConnected=!1,j.fail=!(a||"undefined"==typeof a),j.input.clear(),j.tlsData.clear(),j.data.clear(),j.state.current=h.createConnectionState(j)},j.reset();var k=function(a,b){var c=b.type-h.ContentType.change_cipher_spec,d=E[a.entity][a.expect];c in d?d[c](a,b):h.handleUnexpected(a,b)},l=function(b){var c=0,d=b.input,e=d.length();if(5>e)c=5-e;else{b.record={type:d.getByte(),version:{major:d.getByte(),minor:d.getByte()},length:d.getInt16(),fragment:a.util.createBuffer(),ready:!1};var f=b.record.version.major===b.version.major;f&&b.session&&b.session.version&&(f=b.record.version.minor===b.version.minor),f||b.error(b,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}})}return c},m=function(a){var b=0,c=a.input,d=c.length();if(d<a.record.length)b=a.record.length-d;else{a.record.fragment.putBytes(c.getBytes(a.record.length)),c.compact();var e=a.state.current.read;e.update(a,a.record)&&(null!==a.fragmented&&(a.fragmented.type===a.record.type?(a.fragmented.fragment.putBuffer(a.record.fragment),a.record=a.fragmented):a.error(a,{message:"Invalid fragmented record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})),a.record.ready=!0)}return b};return j.handshake=function(b){if(j.entity!==h.ConnectionEnd.client)j.error(j,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(j.handshaking)j.error(j,{message:"Handshake already in progress.",fatal:!1});else{j.fail&&!j.open&&0===j.handshakes&&(j.fail=!1),j.handshaking=!0,b=b||"";var c=null;b.length>0&&(j.sessionCache&&(c=j.sessionCache.getSession(b)),null===c&&(b="")),0===b.length&&j.sessionCache&&(c=j.sessionCache.getSession(),null!==c&&(b=c.id)),j.session={id:b,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()},c&&(j.version=c.version,j.session.sp=c.sp),j.session.sp.client_random=h.createRandom().getBytes(),j.open=!0,h.queue(j,h.createRecord(j,{type:h.ContentType.handshake,data:h.createClientHello(j)})),h.flush(j)}},j.process=function(a){var b=0;return a&&j.input.putBytes(a),j.fail||(null!==j.record&&j.record.ready&&j.record.fragment.isEmpty()&&(j.record=null),null===j.record&&(b=l(j)),j.fail||null===j.record||j.record.ready||(b=m(j)),!j.fail&&null!==j.record&&j.record.ready&&k(j,j.record)),b},j.prepare=function(b){return h.queue(j,h.createRecord(j,{type:h.ContentType.application_data,data:a.util.createBuffer(b)})),h.flush(j)},j.prepareHeartbeatRequest=function(b,c){return b instanceof a.util.ByteBuffer&&(b=b.bytes()),"undefined"==typeof c&&(c=b.length),j.expectedHeartbeatPayload=b,h.queue(j,h.createRecord(j,{type:h.ContentType.heartbeat,data:h.createHeartbeat(h.HeartbeatMessageType.heartbeat_request,b,c)})),h.flush(j)},j.close=function(a){if(!j.fail&&j.sessionCache&&j.session){var b={id:j.session.id,version:j.session.version,sp:j.session.sp};b.sp.keys=null,j.sessionCache.setSession(b.id,b)}j.open&&(j.open=!1,j.input.clear(),(j.isConnected||j.handshaking)&&(j.isConnected=j.handshaking=!1,h.queue(j,h.createAlert(j,{level:h.Alert.Level.warning,description:h.Alert.Description.close_notify})),h.flush(j)),j.closed(j)),j.reset(a)},j},a.tls=a.tls||{};for(var S in h)"function"!=typeof h[S]&&(a.tls[S]=h[S]);a.tls.prf_tls1=b,a.tls.hmac_sha1=c,a.tls.createSessionCache=h.createSessionCache,a.tls.createConnection=h.createConnection}var d="tls";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/tls",["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,d,e){var g=d.entity===a.tls.ConnectionEnd.client;b.read.cipherState={init:!1,cipher:a.cipher.createDecipher("AES-CBC",g?e.keys.server_write_key:e.keys.client_write_key),iv:g?e.keys.server_write_IV:e.keys.client_write_IV},b.write.cipherState={init:!1,cipher:a.cipher.createCipher("AES-CBC",g?e.keys.client_write_key:e.keys.server_write_key),iv:g?e.keys.client_write_IV:e.keys.server_write_IV},b.read.cipherFunction=f,b.write.cipherFunction=c,b.read.macLength=b.write.macLength=e.mac_length,b.read.macFunction=b.write.macFunction=h.hmac_sha1}function c(b,c){var e=!1,f=c.macFunction(c.macKey,c.sequenceNumber,b);b.fragment.putBytes(f),c.updateSequenceNumber();var g;g=b.version.minor===h.Versions.TLS_1_0.minor?c.cipherState.init?null:c.cipherState.iv:a.random.getBytesSync(16),c.cipherState.init=!0;var i=c.cipherState.cipher;return i.start({iv:g}),b.version.minor>=h.Versions.TLS_1_1.minor&&i.output.putBytes(g),i.update(b.fragment),i.finish(d)&&(b.fragment=i.output,b.length=b.fragment.length(),e=!0),e}function d(a,b,c){if(!c){var d=a-b.length()%a;b.fillWithByte(d-1,d)}return!0}function e(a,b,c){var d=!0;if(c){for(var e=b.length(),f=b.last(),g=e-1-f;e-1>g;++g)d=d&&b.at(g)==f;d&&b.truncate(f+1)}return d}function f(b,c){var d=!1;++i;var f;f=b.version.minor===h.Versions.TLS_1_0.minor?c.cipherState.init?null:c.cipherState.iv:b.fragment.getBytes(16),c.cipherState.init=!0;var j=c.cipherState.cipher;j.start({iv:f}),j.update(b.fragment),d=j.finish(e);var k=c.macLength,l=a.random.getBytesSync(k),m=j.output.length();m>=k?(b.fragment=j.output.getBytes(m-k),l=j.output.getBytes(k)):b.fragment=j.output.getBytes(),b.fragment=a.util.createBuffer(b.fragment),b.length=b.fragment.length();var n=c.macFunction(c.macKey,c.sequenceNumber,b);return c.updateSequenceNumber(),d=g(c.macKey,l,n)&&d}function g(b,c,d){var e=a.hmac.create();return e.start("SHA1",b),e.update(c),c=e.digest().getBytes(),e.start(null,null),e.update(d),d=e.digest().getBytes(),c===d}var h=a.tls;h.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=h.BulkCipherAlgorithm.aes,a.cipher_type=h.CipherType.block,a.enc_key_length=16,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=h.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:b},h.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",
initSecurityParameters:function(a){a.bulk_cipher_algorithm=h.BulkCipherAlgorithm.aes,a.cipher_type=h.CipherType.block,a.enc_key_length=32,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=h.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:b};var i=0}var d="aesCipherSuites";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aesCipherSuites",["require","module","./aes","./tls"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.debug=a.debug||{},a.debug.storage={},a.debug.get=function(b,c){var d;return"undefined"==typeof b?d=a.debug.storage:b in a.debug.storage&&(d="undefined"==typeof c?a.debug.storage[b]:a.debug.storage[b][c]),d},a.debug.set=function(b,c,d){b in a.debug.storage||(a.debug.storage[b]={}),a.debug.storage[b][c]=d},a.debug.clear=function(b,c){"undefined"==typeof b?a.debug.storage={}:b in a.debug.storage&&("undefined"==typeof c?delete a.debug.storage[b]:delete a.debug.storage[b][c])}}var d="debug";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/debug",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c,d,e){b.generate=function(b,f){for(var g=new a.util.ByteBuffer,h=Math.ceil(f/e)+d,i=new a.util.ByteBuffer,j=d;h>j;++j){i.putInt32(j),c.start(),c.update(b+i.getBytes());var k=c.digest();g.putBytes(k.getBytes(e))}return g.truncate(g.length()-f),g.getBytes()}}a.kem=a.kem||{};var c=a.jsbn.BigInteger;a.kem.rsa={},a.kem.rsa.create=function(b,d){d=d||{};var e=d.prng||a.random,f={};return f.encrypt=function(d,f){var g,h=Math.ceil(d.n.bitLength()/8);do g=new c(a.util.bytesToHex(e.getBytesSync(h)),16).mod(d.n);while(g.equals(c.ZERO));g=a.util.hexToBytes(g.toString(16));var i=h-g.length;i>0&&(g=a.util.fillString(String.fromCharCode(0),i)+g);var j=d.encrypt(g,"NONE"),k=b.generate(g,f);return{encapsulation:j,key:k}},f.decrypt=function(a,c,d){var e=a.decrypt(c,"NONE");return b.generate(e,d)},f},a.kem.kdf1=function(a,c){b(this,a,0,c||a.digestLength)},a.kem.kdf2=function(a,c){b(this,a,1,c||a.digestLength)}}var d="kem";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/kem",["require","module","./util","./random","./jsbn"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.log=a.log||{},a.log.levels=["none","error","warning","info","debug","verbose","max"];var b={},c=[],d=null;a.log.LEVEL_LOCKED=2,a.log.NO_LEVEL_CHECK=4,a.log.INTERPOLATE=8;for(var e=0;e<a.log.levels.length;++e){var f=a.log.levels[e];b[f]={index:e,name:f.toUpperCase()}}a.log.logMessage=function(d){for(var e=b[d.level].index,f=0;f<c.length;++f){var g=c[f];if(g.flags&a.log.NO_LEVEL_CHECK)g.f(d);else{var h=b[g.level].index;h>=e&&g.f(g,d)}}},a.log.prepareStandard=function(a){"standard"in a||(a.standard=b[a.level].name+" ["+a.category+"] "+a.message)},a.log.prepareFull=function(b){if(!("full"in b)){var c=[b.message];c=c.concat([]||b.arguments),b.full=a.util.format.apply(this,c)}},a.log.prepareStandardFull=function(b){"standardFull"in b||(a.log.prepareStandard(b),b.standardFull=b.standard)};for(var g=["error","warning","info","debug","verbose"],e=0;e<g.length;++e)!function(b){a.log[b]=function(c,d){var e=Array.prototype.slice.call(arguments).slice(2),f={timestamp:new Date,level:b,category:c,message:d,arguments:e};a.log.logMessage(f)}}(g[e]);if(a.log.makeLogger=function(b){var c={flags:0,f:b};return a.log.setLevel(c,"none"),c},a.log.setLevel=function(b,c){var d=!1;if(b&&!(b.flags&a.log.LEVEL_LOCKED))for(var e=0;e<a.log.levels.length;++e){var f=a.log.levels[e];if(c==f){b.level=c,d=!0;break}}return d},a.log.lock=function(b,c){"undefined"==typeof c||c?b.flags|=a.log.LEVEL_LOCKED:b.flags&=~a.log.LEVEL_LOCKED},a.log.addLogger=function(a){c.push(a)},"undefined"!=typeof console&&"log"in console){var h;if(console.error&&console.warn&&console.info&&console.debug){var i={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},j=function(b,c){a.log.prepareStandard(c);var d=i[c.level],e=[c.standard];e=e.concat(c.arguments.slice()),d.apply(console,e)};h=a.log.makeLogger(j)}else{var j=function(b,c){a.log.prepareStandardFull(c),console.log(c.standardFull)};h=a.log.makeLogger(j)}a.log.setLevel(h,"debug"),a.log.addLogger(h),d=h}else console={log:function(){}};if(null!==d){var k=a.util.getQueryVariables();if("console.level"in k&&a.log.setLevel(d,k["console.level"].slice(-1)[0]),"console.lock"in k){var l=k["console.lock"].slice(-1)[0];"true"==l&&a.log.lock(d)}}a.log.consoleLogger=d}var d="log";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/log",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b){var c={},d=[];if(!l.validate(b,m.asn1.recipientInfoValidator,c,d)){var e=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw e.errors=d,e}return{version:c.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(c.issuer),serialNumber:a.util.createBuffer(c.serial).toHex(),encryptedContent:{algorithm:l.derToOid(c.encAlgorithm),parameter:c.encParameter.value,content:c.encKey}}}function c(b){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(b.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:b.issuer}),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber))]),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.encryptedContent.algorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")]),l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,b.encryptedContent.content)])}function d(a){for(var c=[],d=0;d<a.length;++d)c.push(b(a[d]));return c}function e(a){for(var b=[],d=0;d<a.length;++d)b.push(c(a[d]));return b}function f(b){var c=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(b.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:b.issuer}),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber))]),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.digestAlgorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])]);if(b.authenticatedAttributesAsn1&&c.value.push(b.authenticatedAttributesAsn1),c.value.push(l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.signatureAlgorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])),c.value.push(l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,b.signature)),b.unauthenticatedAttributes.length>0){for(var d=l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[]),e=0;e<b.unauthenticatedAttributes.length;++e){var f=b.unauthenticatedAttributes[e];d.values.push(h(f))}c.value.push(d)}return c}function g(a){for(var b=[],c=0;c<a.length;++c)b.push(f(a[c]));return b}function h(b){var c;if(b.type===a.pki.oids.contentType)c=l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.value).getBytes());else if(b.type===a.pki.oids.messageDigest)c=l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,b.value.bytes());else if(b.type===a.pki.oids.signingTime){var d=new Date("Jan 1, 1950 00:00:00Z"),e=new Date("Jan 1, 2050 00:00:00Z"),f=b.value;if("string"==typeof f){var g=Date.parse(f);f=isNaN(g)?13===f.length?l.utcTimeToDate(f):l.generalizedTimeToDate(f):new Date(g)}c=f>=d&&e>f?l.create(l.Class.UNIVERSAL,l.Type.UTCTIME,!1,l.dateToUtcTime(f)):l.create(l.Class.UNIVERSAL,l.Type.GENERALIZEDTIME,!1,l.dateToGeneralizedTime(f))}return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.type).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[c])])}function i(b){return[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.pki.oids.data).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.algorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,b.parameter.getBytes())]),l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,b.content.getBytes())])]}function j(b,c,d){var e={},f=[];if(!l.validate(c,d,e,f)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw g.errors=g,g}var h=l.derToOid(e.contentType);if(h!==a.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(e.encryptedContent){var i="";if(a.util.isArray(e.encryptedContent))for(var j=0;j<e.encryptedContent.length;++j){if(e.encryptedContent[j].type!==l.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");i+=e.encryptedContent[j].value}else i=e.encryptedContent;b.encryptedContent={algorithm:l.derToOid(e.encAlgorithm),parameter:a.util.createBuffer(e.encParameter.value),content:a.util.createBuffer(i)}}if(e.content){var i="";if(a.util.isArray(e.content))for(var j=0;j<e.content.length;++j){if(e.content[j].type!==l.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");i+=e.content[j].value}else i=e.content;b.content=a.util.createBuffer(i)}return b.version=e.version.charCodeAt(0),b.rawCapture=e,e}function k(b){if(void 0===b.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===b.content){var c;switch(b.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:c=a.aes.createDecryptionCipher(b.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:c=a.des.createDecryptionCipher(b.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+b.encryptedContent.algorithm)}if(c.start(b.encryptedContent.parameter),c.update(b.encryptedContent.content),!c.finish())throw new Error("Symmetric decryption failed.");b.content=c.output}}var l=a.asn1,m=a.pkcs7=a.pkcs7||{};m.messageFromPem=function(b){var c=a.pem.decode(b)[0];if("PKCS7"!==c.type){var d=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw d.headerType=c.type,d}if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var e=l.fromDer(c.body);return m.messageFromAsn1(e)},m.messageToPem=function(b,c){var d={type:"PKCS7",body:l.toDer(b.toAsn1()).getBytes()};return a.pem.encode(d,{maxline:c})},m.messageFromAsn1=function(b){var c={},d=[];if(!l.validate(b,m.asn1.contentInfoValidator,c,d)){var e=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw e.errors=d,e}var f,g=l.derToOid(c.contentType);switch(g){case a.pki.oids.envelopedData:f=m.createEnvelopedData();break;case a.pki.oids.encryptedData:f=m.createEncryptedData();break;case a.pki.oids.signedData:f=m.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+g+" is not (yet) supported.")}return f.fromAsn1(c.content.value[0]),f},m.createSignedData=function(){function b(){for(var b={},c=0;c<d.signers.length;++c){var e=d.signers[c],f=e.digestAlgorithm;f in b||(b[f]=a.md[a.pki.oids[f]].create()),0===e.authenticatedAttributes.length?e.md=b[f]:e.md=a.md[a.pki.oids[f]].create()}d.digestAlgorithmIdentifiers=[];for(var f in b)d.digestAlgorithmIdentifiers.push(l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(f).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")]));return b}function c(b){if(d.contentInfo.value.length<2)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var c=l.derToOid(d.contentInfo.value[0].value),e=d.contentInfo.value[1];e=e.value[0];var f=l.toDer(e);f.getByte(),l.getBerValueLength(f),f=f.getBytes();for(var i in b)b[i].start().update(f);for(var j=new Date,k=0;k<d.signers.length;++k){var m=d.signers[k];if(0===m.authenticatedAttributes.length){if(c!==a.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{m.authenticatedAttributesAsn1=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var n=l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[]),o=0;o<m.authenticatedAttributes.length;++o){var p=m.authenticatedAttributes[o];p.type===a.pki.oids.messageDigest?p.value=b[m.digestAlgorithm].digest():p.type===a.pki.oids.signingTime&&(p.value||(p.value=j)),n.value.push(h(p)),m.authenticatedAttributesAsn1.value.push(h(p))}f=l.toDer(n).getBytes(),m.md.start().update(f)}m.signature=m.key.sign(m.md,"RSASSA-PKCS1-V1_5")}d.signerInfos=g(d.signers)}var d=null;return d={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(b){j(d,b,m.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[];for(var c=d.rawCapture.certificates.value,e=0;e<c.length;++e)d.certificates.push(a.pki.certificateFromAsn1(c[e]))},toAsn1:function(){d.contentInfo||d.sign();for(var b=[],c=0;c<d.certificates.length;++c)b.push(a.pki.certificateToAsn1(d.certificates[c]));var e=[],f=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(d.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo])]);return b.length>0&&f.value[0].value.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,b)),e.length>0&&f.value[0].value.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,e)),f.value[0].value.push(l.create(l.Class.UNIVERSAL,l.Type.SET,!0,d.signerInfos)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(d.type).getBytes()),f])},addSigner:function(b){var c=b.issuer,e=b.serialNumber;if(b.certificate){var f=b.certificate;"string"==typeof f&&(f=a.pki.certificateFromPem(f)),c=f.issuer.attributes,e=f.serialNumber}var g=b.key;if(!g)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof g&&(g=a.pki.privateKeyFromPem(g));var h=b.digestAlgorithm||a.pki.oids.sha1;switch(h){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+h)}var i=b.authenticatedAttributes||[];if(i.length>0){for(var j=!1,k=!1,l=0;l<i.length;++l){var m=i[l];if(j||m.type!==a.pki.oids.contentType){if(k||m.type!==a.pki.oids.messageDigest);else if(k=!0,j)break}else if(j=!0,k)break}if(!j||!k)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}d.signers.push({key:g,version:1,issuer:c,serialNumber:e,digestAlgorithm:h,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:i,unauthenticatedAttributes:[]})},sign:function(){if(("object"!=typeof d.content||null===d.contentInfo)&&(d.contentInfo=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.pki.oids.data).getBytes())]),"content"in d)){var e;d.content instanceof a.util.ByteBuffer?e=d.content.bytes():"string"==typeof d.content&&(e=a.util.encodeUtf8(d.content)),d.contentInfo.value.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,e)]))}if(0!==d.signers.length){var f=b();c(f)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(b){"string"==typeof b&&(b=a.pki.certificateFromPem(b)),d.certificates.push(b)},addCertificateRevokationList:function(a){throw new Error("PKCS#7 CRL support not yet implemented.")}}},m.createEncryptedData=function(){var b=null;return b={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){j(b,a,m.asn1.encryptedDataValidator)},decrypt:function(a){void 0!==a&&(b.encryptedContent.key=a),k(b)}}},m.createEnvelopedData=function(){var b=null;return b={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){var c=j(b,a,m.asn1.envelopedDataValidator);b.recipients=d(c.recipientInfos.value)},toAsn1:function(){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(b.type).getBytes()),l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(b.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,e(b.recipients)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,i(b.encryptedContent))])])])},findRecipient:function(a){for(var c=a.issuer.attributes,d=0;d<b.recipients.length;++d){var e=b.recipients[d],f=e.issuer;if(e.serialNumber===a.serialNumber&&f.length===c.length){for(var g=!0,h=0;h<c.length;++h)if(f[h].type!==c[h].type||f[h].value!==c[h].value){g=!1;break}if(g)return e}}return null},decrypt:function(c,d){if(void 0===b.encryptedContent.key&&void 0!==c&&void 0!==d)switch(c.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var e=d.decrypt(c.encryptedContent.content);b.encryptedContent.key=a.util.createBuffer(e);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}k(b)},addRecipient:function(c){b.recipients.push({version:0,issuer:c.issuer.attributes,serialNumber:c.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:c.publicKey}})},encrypt:function(c,d){if(void 0===b.encryptedContent.content){d=d||b.encryptedContent.algorithm,c=c||b.encryptedContent.key;var e,f,g;switch(d){case a.pki.oids["aes128-CBC"]:e=16,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:e=24,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:e=32,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:e=24,f=8,g=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+d)}if(void 0===c)c=a.util.createBuffer(a.random.getBytes(e));else if(c.length()!=e)throw new Error("Symmetric key has wrong length; got "+c.length()+" bytes, expected "+e+".");b.encryptedContent.algorithm=d,b.encryptedContent.key=c,b.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(f));var h=g(c);if(h.start(b.encryptedContent.parameter.copy()),h.update(b.content),!h.finish())throw new Error("Symmetric encryption failed.");b.encryptedContent.content=h.output}for(var i=0;i<b.recipients.length;++i){var j=b.recipients[i];if(void 0===j.encryptedContent.content)switch(j.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:j.encryptedContent.content=j.encryptedContent.key.encrypt(b.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+j.encryptedContent.algorithm)}}}}}}var d="pkcs7";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7",["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c){var d=c.toString(16);d[0]>="8"&&(d="00"+d);var e=a.util.hexToBytes(d);b.putInt32(e.length),b.putBytes(e)}function c(a,b){a.putInt32(b.length),a.putString(b)}function d(){for(var b=a.md.sha1.create(),c=arguments.length,d=0;c>d;++d)b.update(arguments[d]);return b.digest()}var e=a.ssh=a.ssh||{};e.privateKeyToPutty=function(e,f,g){g=g||"",f=f||"";var h="ssh-rsa",i=""===f?"none":"aes256-cbc",j="PuTTY-User-Key-File-2: "+h+"\r\n";j+="Encryption: "+i+"\r\n",j+="Comment: "+g+"\r\n";var k=a.util.createBuffer();c(k,h),b(k,e.e),b(k,e.n);var l=a.util.encode64(k.bytes(),64),m=Math.floor(l.length/66)+1;j+="Public-Lines: "+m+"\r\n",j+=l;var n=a.util.createBuffer();b(n,e.d),b(n,e.p),b(n,e.q),b(n,e.qInv);var o;if(f){var p=n.length()+16-1;p-=p%16;var q=d(n.bytes());q.truncate(q.length()-p+n.length()),n.putBuffer(q);var r=a.util.createBuffer();r.putBuffer(d("\x00\x00\x00\x00",f)),r.putBuffer(d("\x00\x00\x00",f));var s=a.aes.createEncryptionCipher(r.truncate(8),"CBC");s.start(a.util.createBuffer().fillWithByte(0,16)),s.update(n.copy()),s.finish();var t=s.output;t.truncate(16),o=a.util.encode64(t.bytes(),64)}else o=a.util.encode64(n.bytes(),64);m=Math.floor(o.length/66)+1,j+="\r\nPrivate-Lines: "+m+"\r\n",j+=o;var u=d("putty-private-key-file-mac-key",f),v=a.util.createBuffer();c(v,h),c(v,i),c(v,g),v.putInt32(k.length()),v.putBuffer(k),v.putInt32(n.length()),v.putBuffer(n);var w=a.hmac.create();return w.start("sha1",u),w.update(v.bytes()),j+="\r\nPrivate-MAC: "+w.digest().toHex()+"\r\n"},e.publicKeyToOpenSSH=function(d,e){var f="ssh-rsa";e=e||"";var g=a.util.createBuffer();return c(g,f),b(g,d.e),b(g,d.n),f+" "+a.util.encode64(g.bytes())+" "+e},e.privateKeyToOpenSSH=function(b,c){return c?a.pki.encryptRsaPrivateKey(b,c,{legacy:!0,algorithm:"aes128"}):a.pki.privateKeyToPem(b)},e.getPublicKeyFingerprint=function(d,e){e=e||{};var f=e.md||a.md.md5.create(),g="ssh-rsa",h=a.util.createBuffer();c(h,g),b(h,d.e),b(h,d.n),f.start(),f.update(h.getBytes());var i=f.digest();if("hex"===e.encoding){var j=i.toHex();return e.delimiter?j.match(/.{2}/g).join(e.delimiter):j}if("binary"===e.encoding)return i.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".');return i}}var d="ssh";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/ssh",["require","module","./aes","./hmac","./md5","./sha1","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b="forge.task",c=0,d={},e=0;a.debug.set(b,"tasks",d);var f={};a.debug.set(b,"queues",f);var g="?",h=30,i=20,j="ready",k="running",l="blocked",m="sleeping",n="done",o="error",p="stop",q="start",r="block",s="unblock",t="sleep",u="wakeup",v="cancel",w="fail",x={};x[j]={},x[j][p]=j,x[j][q]=k,x[j][v]=n,x[j][w]=o,x[k]={},x[k][p]=j,x[k][q]=k,x[k][r]=l,x[k][s]=k,x[k][t]=m,x[k][u]=k,x[k][v]=n,x[k][w]=o,x[l]={},x[l][p]=l,x[l][q]=l,x[l][r]=l,x[l][s]=l,x[l][t]=l,x[l][u]=l,x[l][v]=n,x[l][w]=o,x[m]={},x[m][p]=m,x[m][q]=m,x[m][r]=m,x[m][s]=m,x[m][t]=m,x[m][u]=m,x[m][v]=n,x[m][w]=o,x[n]={},x[n][p]=n,x[n][q]=n,x[n][r]=n,x[n][s]=n,x[n][t]=n,x[n][u]=n,x[n][v]=n,x[n][w]=o,x[o]={},x[o][p]=o,x[o][q]=o,x[o][r]=o,x[o][s]=o,x[o][t]=o,x[o][u]=o,x[o][v]=o,x[o][w]=o;var y=function(f){this.id=-1,this.name=f.name||g,this.parent=f.parent||null,this.run=f.run,this.subtasks=[],this.error=!1,this.state=j,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=e++,d[this.id]=this,c>=1&&a.log.verbose(b,"[%s][%s] init",this.id,this.name,this)};y.prototype.debug=function(c){c=c||"",a.log.debug(b,c,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",f)},y.prototype.next=function(a,b){"function"==typeof a&&(b=a,a=this.name);var c=new y({run:b,name:a,parent:this});return c.state=k,c.type=this.type,c.successCallback=this.successCallback||null,c.failureCallback=this.failureCallback||null,this.subtasks.push(c),this},y.prototype.parallel=function(b,c){return a.util.isArray(b)&&(c=b,b=this.name),this.next(b,function(d){var e=d;e.block(c.length);for(var f=function(b,d){a.task.start({type:b,run:function(a){c[d](a)},success:function(a){e.unblock()},failure:function(a){e.unblock()}})},g=0;g<c.length;g++){var h=b+"__parallel-"+d.id+"-"+g,i=g;f(h,i)}})},y.prototype.stop=function(){this.state=x[this.state][p]},y.prototype.start=function(){this.error=!1,this.state=x[this.state][q],this.state===k&&(this.start=new Date,this.run(this),A(this,0))},y.prototype.block=function(a){a="undefined"==typeof a?1:a,this.blocks+=a,this.blocks>0&&(this.state=x[this.state][r])},y.prototype.unblock=function(a){return a="undefined"==typeof a?1:a,this.blocks-=a,0===this.blocks&&this.state!==n&&(this.state=k,A(this,0)),this.blocks},y.prototype.sleep=function(a){a="undefined"==typeof a?0:a,this.state=x[this.state][t];var b=this;this.timeoutId=setTimeout(function(){b.timeoutId=null,b.state=k,A(b,0)},a)},y.prototype.wait=function(a){a.wait(this)},y.prototype.wakeup=function(){this.state===m&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=k,A(this,0))},y.prototype.cancel=function(){this.state=x[this.state][v],this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},y.prototype.fail=function(a){if(this.error=!0,B(this,!0),a)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,A(a,0);else{if(null!==this.parent){for(var b=this.parent;null!==b.parent;)b.error=this.error,b.swapTime=this.swapTime,b.userData=this.userData,b=b.parent;B(b,!0)}this.failureCallback&&this.failureCallback(this)}};var z=function(a){a.error=!1,a.state=x[a.state][q],setTimeout(function(){a.state===k&&(a.swapTime=+new Date,a.run(a),A(a,0))},0)},A=function(a,b){var c=b>h||+new Date-a.swapTime>i,d=function(b){if(b++,a.state===k)if(c&&(a.swapTime=+new Date),a.subtasks.length>0){var d=a.subtasks.shift();d.error=a.error,d.swapTime=a.swapTime,d.userData=a.userData,d.run(d),d.error||A(d,b)}else B(a),a.error||null!==a.parent&&(a.parent.error=a.error,a.parent.swapTime=a.swapTime,a.parent.userData=a.userData,A(a.parent,b))};c?setTimeout(d,0):d(b)},B=function(e,g){e.state=n,delete d[e.id],c>=1&&a.log.verbose(b,"[%s][%s] finish",e.id,e.name,e),null===e.parent&&(e.type in f?0===f[e.type].length?a.log.error(b,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type):f[e.type][0]!==e?a.log.error(b,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type):(f[e.type].shift(),0===f[e.type].length?(c>=1&&a.log.verbose(b,"[%s][%s] delete queue [%s]",e.id,e.name,e.type),delete f[e.type]):(c>=1&&a.log.verbose(b,"[%s][%s] queue start next [%s] remain:%s",e.id,e.name,e.type,f[e.type].length),f[e.type][0].start())):a.log.error(b,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type),g||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};a.task=a.task||{},a.task.start=function(d){var e=new y({run:d.run,name:d.name||g});e.type=d.type,e.successCallback=d.success||null,e.failureCallback=d.failure||null,e.type in f?f[d.type].push(e):(c>=1&&a.log.verbose(b,"[%s][%s] create queue [%s]",e.id,e.name,e.type),f[e.type]=[e],z(e))},a.task.cancel=function(a){a in f&&(f[a]=[f[a][0]])},a.task.createCondition=function(){var a={tasks:{}};return a.wait=function(b){b.id in a.tasks||(b.block(),a.tasks[b.id]=b)},a.notify=function(){var b=a.tasks;a.tasks={};for(var c in b)b[c].unblock()},a}}var d="task";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?h.apply(null,Array.prototype.slice.call(arguments,0)):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/task",["require","module","./debug","./log","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var a="forge";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return void("undefined"==typeof forge&&(forge={disableNativeCode:!1}));var d=!0;c=function(a,c){c(b,module)}}var e,f=function(b,c){c.exports=function(c){var d=e.map(function(a){return b(a)});if(c=c||{},c.defined=c.defined||{},c.defined[a])return c[a];c.defined[a]=!0;for(var f=0;f<d.length;++f)d[f](c);return c},c.exports.disableNativeCode=!1,c.exports(c.exports)},g=c;(c=function(a,b){return e="string"==typeof a?b.slice(2):a.slice(2),d?g.apply(null,Array.prototype.slice.call(arguments,0)):(c=g,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/forge",["require","module","./aes","./aesCipherSuites","./asn1","./cipher","./cipherModes","./debug","./des","./hmac","./kem","./log","./md","./mgf1","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prime","./prng","./pss","./random","./rc2","./ssh","./task","./tls","./util"],function(){f.apply(null,Array.prototype.slice.call(arguments,0))})}(),b("js/forge")}),angular.module("Authentication",[]).run(["$rootScope","$location","$cookies","$http","AuthenticationService","$routeParams","$timeout",function(a,b,c,d,e,f,g){if(!sessionStorage.getObj("globals")||!sessionStorage.getObj("globals").authUserToken){var h={
authUserToken:null,userData:{contract:[]}},i={authUserToken:c.get("XSRF-TOKEN"),loginToken:c.get("XSRF-TOKEN")}||h;sessionStorage.setObj("globals",i)}"/"!==b.path()&&(sessionStorage.getObj("globals").authUserToken&&(d.defaults.headers.common["X-AUTH-TOKEN"]=sessionStorage.getObj("globals").authUserToken,e.setCSRFToken()),a.$on("$locationChangeStart",function(a,c,d){"/"!==b.path()&&"/asv/test-registry"!==b.path()&&("/rsa-login"!==b.path()||sessionStorage.getItem("loginToken")?-1===b.path().indexOf("/asv")||"/asv/rsa-login"===b.path()||sessionStorage.getObj("globals").authUserToken?"/login"===b.path()||"/rsa-login"===b.path()||"/asv/rsa-login"===b.path()||sessionStorage.getObj("globals").authUserToken?-1!==b.path().indexOf("/rsa-login")||sessionStorage.getObj("globals").userData||e.SetCredentials(sessionStorage.getObj("globals").authUserToken):b.path("/init"):e.checkDocCirrus().then(function(a){a?b.path("/asv/kvdttoasv"):b.path("/asv/login")},function(){b.path("/asv/login")}):b.path("/login"),"/login"===b.path()&&sessionStorage.getObj("globals").authUserToken&&sessionStorage.getItem("loginToken")&&b.path("/main"),("/asv/login"===b.path()||"/asv/"===b.path())&&sessionStorage.getObj("globals").authUserToken&&sessionStorage.getItem("loginToken")&&b.path("/asv/kvdttoasv"),g(function(){e.checkStammDaten()}))}))}]),angular.module("Authentication").factory("AuthenticationService",["$http","$cookies","$rootScope","$timeout","userResource","authResource","config","$q","$location","ngDialog","$interval",function(a,b,c,d,e,f,g,h,i,j,k){var l={};return l.responseError={responseError:function(a){403===a.status&&(l.ClearCredentials(),i.path("/login"))}},l.setCSRFToken=function(){var c=[];angular.forEach(b.getAll(),function(a,b){c.push(b+"="+a)}),a.defaults.headers.common["X-CSRFToken"]=c.join(";")},l.checkStammDaten=function(){d(function(){if(2===parseInt(sessionStorage.getItem("loginModul"))){var a=sessionStorage.getObj("globals").userData;if(!a||-1!==i.path().indexOf("/user"))return!0;var b=["firstname","lastname","doctor_number","business_number","street","number","zip","city","account_owner","iban"],c=!0;if(console.log("checkStammDaten"),angular.forEach(b,function(b){a[b]||(c=!1)}),!l.stammDialogOpen&&!c){l.stammDialogOpen=!0;var d=j.open({template:"views/require-stamm.html",className:"ngdialog-theme-flat"});d.closePromise.then(function(){i.path("/user"),l.stammDialogOpen=!1})}}},2e3)},l.checkDocCirrus=function(){var d=(JSON.parse(localStorage.getItem("ASV-UserData")),h.defer());return sessionStorage.getItem("docCirrusCon")&&sessionStorage.getItem("docCirrusUser")?(sessionStorage.setItem("loginModul",1),a.get("/2/user/?username="+sessionStorage.getItem("docCirrusUser")).then(function(e){if(!e.data.data)return void d.resolve(!1);switch(e=e.data.data[0],e.asvMembershipType){case"LEAD":e.asvMembershipType=1;break;case"FULL":e.asvMembershipType=2;break;case"RESTRICTED":e.asvMembershipType=3;break;case"OTHER":e.asvMembershipType=4}var g="";if(angular.forEach(e.communications,function(a){"EMAILJOB"===a.type&&(g=a.value)}),!e.physicianIknr||9!==e.physicianIknr.length)return alert("Die IK wurde nicht korrekt übergeben. Für die Abrechnung wird eine 9stellige IK-Nr. benötigt."),void d.resolve(!1);if(!g)return alert("Die EMail-Adresse wurde nicht korrekt übergeben."),void d.resolve(!1);var h={institution_number:e.physicianIknr,asv_role:e.asvMembershipType,firstname:e.firstname,lastname:e.lastname,email:g,modulId:1};f.save(h,function(e){if(sessionStorage.setItem("googleAuthQRCode",e.googleAuthQRCode),sessionStorage.setItem("googleAuthCode",e.googleAuthCode),sessionStorage.setItem("loginToken",e.token),sessionStorage.setItem("loginModul",1),e.SID){var f=e.SID.split("=");b.put(f[0],f[1],{expires:"Session"}),l.SetCredentials(e.token).then(function(){c.KVDTASV?d.resolve(!0):a.get("/download/"+sessionStorage.getItem("docCirrusCon")).then(function(a){c.KVDTASV=a.data,d.resolve(!0)},function(){d.resolve(!1)}),l.setCSRFToken()})}},function(a){})},function(){d.resolve(!1)}),d.promise):(d.resolve(!1),d.promise)},l.Login=function(d,e,g,h,i){f.save({username:d,password:e,modulId:g},function(d){if(d.SID){var e=d.SID.split("=");b.put(e[0],e[1],{expires:"Session"}),l.setCSRFToken()}h(d),c.keepalive&&k.cancel(c.keepalive),c.keepalive=k(function(){a.get("/de/api/index/keepalive",{ignoreLoadingBar:!0})},2e5)},function(a){i(a)})},l.RsaAuth=function(b,c,d){a.post(g.apiBase+"/de/api/index/rsaauth",{rsaKey:b}).then(function(a){c(a)},function(a){d(a)})},l.SetCredentials=function(c){if(c){if(sessionStorage.getObj("globals")&&sessionStorage.getObj("globals").userData){b.put("XSRF-TOKEN",c),a.defaults.headers.common["X-AUTH-TOKEN"]=c,l.setCSRFToken();var d=h.defer();return d.resolve(!0),d.promise}var f={authUserToken:c,userData:{contract:[]}};return sessionStorage.setObj("globals",f),b.put("XSRF-TOKEN",c),a.defaults.headers.common["X-AUTH-TOKEN"]=c,l.setCSRFToken(),e.query(function(a){var b=sessionStorage.getObj("globals");b.userData=a,sessionStorage.setObj("globals",b)}).$promise}},l.ClearCredentials=function(){c.keepalive&&k.cancel(c.keepalive),sessionStorage.setObj("globals",{}),b.remove("XSRF-TOKEN"),a.defaults.headers.common.Authorization="Basic"},l}]),angular.module("frontendApp").factory("rootData",function(){return{searchText:""}}),angular.module("frontendApp").factory("renderHtmlContent",["$templateRequest","$sce","$compile",function(a,b,c){return{render:function(d,e,f){var f=b.getTrustedResourceUrl(f);a(f).then(function(a){c(e.html(a).contents())(d)},function(){})}}}]),angular.module("kvdttoasvApp").factory("kvdt",["$rootScope","asv",function(a,b){var c=null,d={},e={"0101":[],"0102":[],"0103":[],"0104":[]},f={"0101":[],"0102":[],"0103":[],"0104":[]},g=0,h=0,i=0,j={},k={},l=function(){d={},e={"0101":[],"0102":[],"0103":[],"0104":[]},f={"0101":[],"0102":[],"0103":[],"0104":[]},g=0,h=0,i=0,j={},k={}},m=function(){var a=c.match(/([0-9]{3})(8000)([0-9a-z]{4})[\r\n]/gim),b=c.split(/[0-9]{3}8000[0-9a-z]{4}[\r\n]/gim);l(),angular.forEach(a,function(a,c){if(a=a.substr(7,4),"0101"===a||"0102"===a||"0103"===a||"0104"===a)d[a]||(d[a]=[]),d[a].push(b[c+1]);else{var e=b[c+1].split("\r\n");d[a]={},angular.forEach(e,function(b){b=b.replace(/^\n/,"");var c=b.substr(3,4);c&&(d[a][c]=b.substr(7))})}}),b=null},n=function(){var a=!1,b=null;return angular.forEach(e,function(c,j){d[j]&&angular.forEach(d[j],function(c,k){h++,/0185100[0-9]{9}/gm.test(c)?((b=c.match(/^[0-9]{3}5001.*/gm))&&(g+=b.length),(b=c.match(/^[0-9]{3}5005.*/gm))&&angular.forEach(b,function(a){var b=1*a.substr(-2);g+=b-1}),e[j].push(o(c)),delete d[j],i++,a=!0):((b=c.match(/^[0-9]{3}5001.*/gm))&&(g+=b.length),(b=c.match(/^[0-9]{3}5005.*/gm))&&angular.forEach(b,function(a){var b=1*a.substr(-2);g+=b-1}),f[j].push(o(c)),delete d[j])})}),a},o=function(a){var b=a.split("\r\n"),c={},d={4235:[]},e=[],f={6001:[],3673:[]},g=null;return angular.forEach(b,function(a){a=a.replace(/^\s+|\s+$/g,"");var b=a.substr(3,4);a.match(/^[0-9]{3}3[0-9]{3}/)&&!a.match(/^[0-9]{3}367[0-9]{1}/)?c[b]=a.substr(7):a.match(/^[0-9]{3}4[0-9]{3}/)?"4235"===b||(d[b]=a.substr(7),"4104"===b?(g=a.substr(7),j[g]=1):"4111"===b?(k[a.substr(7)]="(IK)"+a.substr(7),j[g]="(IK)"+a.substr(7)):"4134"===b&&(j[g]=a.substr(7))):a.match(/^[0-9]{3}5[0-9]{3}/)?"5000"===b?e.push({5000:a.substr(7),5001:[]}):"5001"===b?e[e.length-1][5001].push({5001:a.substr(7)}):"5012"===b?(e[e.length-1][5001][e[e.length-1][5001].length-1][b]||(e[e.length-1][5001][e[e.length-1][5001].length-1][b]=[]),e[e.length-1][5001][e[e.length-1][5001].length-1][b].push(a.substr(7))):e[e.length-1][5001][e[e.length-1][5001].length-1][b]=a.substr(7):(a.match(/^[0-9]{3}6[0-9]{3}/)||a.match(/^[0-9]{3}367[0-9]{1}/))&&("6001"===b?f[b].push({6001:a.substr(7)}):"3673"===b?f[b].push({3673:a.substr(7)}):a.match(/^[0-9]{3}367[0-9]{1}/)?f[3673][f[3673].length-1][b]=a.substr(7):f[6001][f[6001].length-1][b]=a.substr(7))}),{patient:c,satzart:d,leistung:e,diagnose:f}},p=function(a){var c=";",d='"',e="",f="",g="";a.patient[3119]&&(f=a.patient[3119]),g=a.satzart[4134]?a.satzart[4134]:"(IK)"+a.satzart[4111];var h=a.satzart[4101].substr(1,4),i=d+a.patient[3101]+d+c+d+a.patient[3102]+d+c+d+f+d+c+d+g+d+c;return angular.forEach(a.leistung,function(f){var g=f[5e3]+d+c;angular.forEach(f[5001],function(f){e+=i+d+g+d+f[5001]+d+c;var j=1*f[5005]||1;if(f[5100]){var k=b.getGopPrice(f,h);if(e+=d+"ASV"+d+c+d+j+d+c,e+=d+(k+"").replace(".",",")+d+"\r\n",0===k)return"";var l=[],m=b.getSac(f,a.satzart[4101].substr(1,4),l);if(m){var n=b.getSeperator();angular.forEach(l,function(a){var b=a.data.split(n.d);e+=i+d+g+d+f[5001]+d+c,e+=d+"ASV-SACH"+d+c+d+b[2]+d+c,e+=d+b[0]+d+"\r\n"})}}else e+=d+"KVTD"+d+c+d+j+d+c,e+=d+"0,00"+d+"\r\n"})}),e},q=function(){var a="";return angular.forEach(["0101","0102","0103","0104"],function(b){angular.forEach(e[b],function(b){a+=p(b)}),angular.forEach(f[b],function(b){a+=p(b)})}),a},r=function(c,d,e,f,g){return angular.forEach(c,function(c){angular.forEach(c[5001],function(c){-1!==e.indexOf(c[5001])?(u+=parseFloat(b.getGopPrice(c,d)),s++,a.$broadcast("checkGopIsAsvData",{price:u,current:s/g*100})):t.push(c[5001])})}),u},s=0,t=[],u=0,v=function(b,c,d){return angular.forEach(["0101","0102","0103","0104"],function(a){angular.forEach(f[a],function(a){var e=a.satzart[4101].substr(1,4);r(a.leistung,e,b,c,d)})}),a.$broadcast("checkGopIsAsvData",{price:u,current:100}),u};return{setData:function(a){return c=a,m(),n()?!0:!1},getDataBlock:function(){return angular.extend(e,d)},getCntLeistungen:function(){return g},getKKdata:function(){return j},getKKiks:function(){return k},getCntPatienten:function(){return h},getCntAsvPatienten:function(){return i},createCSVData:function(){return q()},checkASVintoKVDT:v}}]),angular.module("kvdttoasvApp").factory("asv",["$filter","$injector","gopStamm","kvReg","b64toBlob","$indexedDB",function(a,b,c,d,e,f){var g=function(){return"n"===sessionStorage.getObj("globals").userData.asv_live?"T":"E"},h=new Date,i=a("date")(h,"yyyyMMdd"),j=a("date")(h,"Hmm"),k=a("date")(h,"yyyyMMddHHmmss"),l=null,m=[],n="001",o=null,p=1,q={},r={},s="",t=0,u="",v=0,w=null,x=null,y=null,z=function(a){switch(a){case"Y2015":return"B";case"Y2016":return"C";case"Y2017":return"D";case"Y2018":return"E";case"Y2019":return"F";case"Y2020":return"G";case"Y2021":return"H";case"Y2022":return"I";case"Y2023":return"J";case"Y2024":return"K"}},A=function(){v=0},B={UNB:"",UNH:[],UNZ:""},C=function(){h=new Date,i=a("date")(h,"yyyyMMdd"),j=a("date")(h,"HHmm"),k=a("date")(h,"yyyyMMddHHmmss"),o=null,p=1,q={},s="",t=0,u="",y=null,B={UNB:"",UNH:[],UNZ:""}},D={e:String.fromCharCode(28),i:String.fromCharCode(31),d:String.fromCharCode(29)},E=function(b){var c=("n"===sessionStorage.getObj("globals").userData.asv_live?D.d+"1":"",sessionStorage.getObj("globals").userData.institution_number),d=a("filter")(m,{ik:b.satzart[4111]});0===d.length&&(d[0]={dav_ik:b.satzart[4111]}),B.UNB="UNOC"+D.i+"3"+D.d+c+D.i+"L"+D.d+d[0].dav_ik+D.i+"K"+D.d+i+D.i+j+D.d+o},F=function(){B.UNZ=p-1+D.d+o},G=function(a){return r[a]+D.i+a},H=function(a){q[p]=0,r[p]=5,B.UNH.push({segment:p+D.d+"ASVREC"+D.i+"1"+D.i+"00"+D.i+"SV",IFA:I(a),REA:J(a,p),IVA:K(a),UNT:G(p)}),p++},I=function(a){var b=a.leistung[0][5001][0][5100],c=a.leistung[0][5001][0][5098],d=a.leistung[0][5001][0][5099];return{segment:b+D.i+c+D.i+d+D.i+sessionStorage.getObj("globals").userData.asv_type+D.i+sessionStorage.getObj("globals").userData.asv_role,DGN:O(a),LEA:L(a)}},J=function(b,c){var d="";u=b.satzart[4111],d=b.satzart[4111];var e=Math.round(100*q[c])/100;e=a("number")(e,2),-1===e.indexOf(",")&&(e+=",00"),d=a("filter")(m,{ik:d}),0===d.length&&(d[0]={abrech_ik:b.satzart[4111]}),1===(c+"").length&&(c="0"+c);var f=sessionStorage.getObj("globals").userData.institution_number;return e+D.i+T(b.satzart[4101])+S(b.satzart[4101])+D.i+(b.satzart[4104]+z("Y"+T(b.satzart[4101]))+S(b.satzart[4101])+n+c).substr(0,12)+D.i+"0"+D.i+i+D.i+f+D.i+f+D.i+d[0].abrech_ik+D.i+sessionStorage.getObj("globals").userData.institution_number},K=function(a){var b="";if(a.patient[3119])var b=a.patient[3119];return a.patient[3108]+D.d+b+D.d+a.patient[3101]+D.i+a.patient[3102]+D.i+a.patient[3103]},L=function(b){var c=[];return angular.forEach(b.leistung,function(d){var e=d[5e3];angular.forEach(d[5001],function(d){if(!d[5100])return void console.log("kein ASV");var f=1;d[5005]&&(f=1*d[5005]);var g=M(d,b.satzart[4101].substr(1,4));if(0!==g){v+=f;var h=a("number")(g,2),i="";d[5011]&&(i+=i?d[5011]:D.i+d[5011]),d[5009]&&(i+=i?d[5009]:D.i+d[5009]),c.push(d[5001]+D.i+e+D.i+f+D.i+h+i.substring(0,70)),q[p]+=g*f,q[p]+=N(d,b.satzart[4101].substr(1,4),c),r[p]+=1}})}),c},M=function(a,b){var e=a[5001],f=a[5098],g=d.getKvReg(f),h=c.getVal(g,e,b);return 0===h&&a[5012]&&a[5012].length>0&&angular.forEach(a[5012],function(a,b){h+=a/100}),h},N=function(b,e,f){var g=b[5001],h=b[5098],i=d.getKvReg(h),j=0,k=c.getVal(i,g,e);return k>0&&(k=0,b[5012]&&b[5012].length>0&&angular.forEach(b[5012],function(c,d){k+=c/100,j=a("number")(k,2),f.push({key:"SAC",data:j+D.d+b[5011]+D.d+"1"}),r[p]+=1})),k},O=function(a){var b=[];return a.diagnose[3673].length>0&&angular.forEach(a.diagnose[3673],function(a){b.push(a[3673]+D.i+a[3674]+D.i+D.i+D.i+"1"),r[p]+=1}),a.diagnose[6001].length>0&&angular.forEach(a.diagnose[6001],function(a){b.push(a[6001]+D.i+a[6003]+D.i+D.i+D.i+"1"),r[p]+=1}),b},P=function(a){o||(n=V(a.satzart[4111]),o="B"+a.satzart[4104]+z("Y"+T(a.satzart[4101]))+S(a.satzart[4101])+n)},Q=function(){var b=0;return angular.forEach(q,function(a){b+=a}),(a("number")(b,2)+"").replace(".","").replace(",",".")},R=function(){var c=a("filter");angular.forEach(w,function(a,d){if(C(),angular.forEach(["0101","0102","0103","0104"],function(a){angular.forEach(c(l[a],{satzart:{4104:d}}),function(a){P(a),E(a),H(a),F()})}),X()&&o){var f=sessionStorage.getObj("globals").userData.institution_number,h=V(u);w[d]={asvData:"",kksData:b.get("kks").getKKS(s,h),fileName:f+u+"_"+g()+"ASV0"+h,sum:Q()};var i=new Blob(e.b64toBlob(forge.util.encode64(s),"octect/stream"),{type:"application/octet-binary",endings:"native"}),j=new FileReader;j.onload=function(a){return"string"==typeof j.result&&(j.result.search("ï¿½")>0||j.result.search("�")>0)?void(j.isSimulated?j.readAsArrayBuffer(i):j.readAsBinaryString(i,"iso-8859-15")):void("object"==typeof j.result?(w[d].asvData=forge.util.binary.raw.encode(new Uint8Array(j.result)),w[d].kksData=w[d].kksData.substr(0,178)+W(w[d].asvData)+w[d].kksData.substring(190,348)):(w[d].asvData=j.result,w[d].kksData=w[d].kksData.substr(0,178)+W(w[d].asvData)+w[d].kksData.substring(190,348)))},j.readAsText(i)}})},S=function(a){return a.substr(0,1)},T=function(a){return a.substr(1,4)},U=function(a,b){angular.forEach(b,function(b){s+=angular.isObject(b)?b.key+D.d+b.data+D.e:a+D.d+b+D.e})},V=function(b){var c=a("filter")(x,{ik:b});if(c=a("orderBy")(c,"-lfdnr",!0),c.length){for(var d=1*c[0].lfdnr+1,e="",f=(d+"").length;3>f;f++)e+="0";return e+d}return"001"},W=function(a){var b=a.length+"";t=b;for(var c=b.length,d="",e=0;12-c>e;e++)d+="0";return d+b},X=function(){return s="",angular.forEach(B,function(a,b){angular.isString(a)?s+=b+D.d+a+D.e:angular.forEach(a,function(a,b){s+="UNH"+D.d+a.segment+D.e,a.IFA&&(s+="IFA"+D.d+a.IFA.segment+D.e,a.IFA.DGN&&U("DGN",a.IFA.DGN),a.IFA.LEA&&U("LEA",a.IFA.LEA)),a.REA&&(s+="REA"+D.d+a.REA+D.e),a.IVA&&(s+="IVA"+D.d+a.IVA+D.e),s+="UNT"+D.d+r[b+1]+D.d+(b+1)+D.e})}),!0},Y=function(a){f.openStore("asvData",function(b){var c=a.nutzerDaten.asvDaten;delete a.nutzerDaten.asvDaten;var d=a.nutzerDaten.kksData;delete a.nutzerDaten.kksData;a.nutzerDaten.summe;delete a.nutzerDaten.summe;b.insert(a.nutzerDaten).then(function(a){var b=a[0];f.openStore("asvSendData",function(a){a.insert({asvData_id:b,asvData:c,kksData:forge.util.encode64(d)}).then(function(){})})})})},Z=function(a,b,c){var d=["UNB","UNH","IFA","REA","IVA","UNT","UNZ"],e=a.split(D.e),f=[];return angular.forEach(e,function(a,b){var c=a.split(D.d);if(-1!==d.indexOf(c[0])){if("UNB"===c[0]&&(c[4]=i+D.i+j,c[5]=o),"REA"===c[0]){var e=c[1].split(D.i);e[0]=0,e[3]=1,c[1]=e.join(D.i)}if("IFA"===c[0]){var e=c[1].split(D.i);e[4]=sessionStorage.getObj("globals").userData.asv_role,c[1]=e.join(D.i)}"UNT"===c[0]&&(c[1]=5),"UNZ"===c[0]&&(c[2]=o),f.push(c.join(D.d))}}),u=c,{asvData:f.join(D.e),kksData:b}};return{setKvdtData:function(a,b){A(),l=a,w=b,R()},writeASVData:function(){return X()},getASVFileData:function(){return w},getASVFileDataCrypt:function(){var a=CryptoJS.AES.encrypt(s,"Secret Passphrase")+"";return t=a.length,a},getASVFileName:function(){return o},getCreateStamp:function(){return k},getBytesNormal:function(a){return W(a)},getBytesCrypted:function(){var a="platzhalter";return W(a)},getIKEmpf:function(){return u},getASVCnt:function(){return v},getGopPrice:function(a,b){return M(a,b)},setLfdnr:function(a){x=a},setProviderData:function(a){m=a},getSac:N,getSeperator:function(){return D},getGop:function(a){return c.getAsvGop(a)},getFileLfdnr:V,storeSendData:Y,createStorno:Z,setFileName:P}}]),angular.module("kvdttoasvApp").factory("kks",["$filter","gopStamm","kvReg","asv",function(a,b,c,d){var e=function(a,b){for(var c={fileNameCnt:b,IKAbsender:sessionStorage.getObj("globals").userData.institution_number,mail:sessionStorage.getObj("globals").userData.mail},e=c.mail.length,f=e;44>f;f++)c.mail+=" ";var g=[6,2,8,3,5,3,5,15,15,15,15,6,6,11,14,14,14,14,6,1,12,12,2,2,2,2,3,5,8,1,2,1,10,6,28,44,30],h="n"===sessionStorage.getObj("globals").userData.asv_live?"T":"E",i={IDENTIFIKATOR:"500000",VERSION:"01",AUFTRAG:"00000348",SEQUENZ_NR:"000",VERFAHREN_KENNUNG:h+"ASV0",TRANSFER_NUMMER:c.fileNameCnt,VERFAHREN_KENNUNG_SPEC:"ASVA0",ABSENDER_EIGNER:c.IKAbsender+"      ",ABSENDER_PHYSIKALISCH:c.IKAbsender+"      ",EMPFAENGER_NUTZER:d.getIKEmpf()+"      ",EMPFAENGER_PHYSIKALISCH:d.getIKEmpf()+"      ",FEHLER_NUMMER:"000000",FEHLER_MASSNAHME:"000000",DATEINAME:d.getASVFileName(),DATUM_ERSTELLUNG:d.getCreateStamp(),DARUM_GESENDET:"00000000000000",DARUM_EMPFANGEN_START:"00000000000000",DARUM_EMPFANGEN_ENDE:"00000000000000",DATEIVERSION:"000000",KORREKTUR:"0",DATEIGROESSE_NUTZDATEN:d.getBytesNormal(a),DATEIGROESSE_UEBERTRAGUNG:d.getBytesCrypted(),ZEICHENSATZ:"I5",KOMPRIMIERUNG:"00",VERSCHLUESSELUNGSART:"03",ELEKTRONISCHE_UNTERSCHRIFT:"03",SATZFORMAT:"   ",SATZLAENGE:"00000",BLOCKLAENGE:"00000000",STATUS:"0",WIEDERHOLUNG:"00",UEBERTRAGUNGSWEG:"0",VERZOEGERTER_VERSAND:"0000000000",INFO:"000000",VARIABLESINFO:"                            ",DATEINAME_PHYSIKALISCH:c.mail,DATEI_BEZEICHNUNG:"                              "},j="",f=0;return angular.forEach(i,function(a,b){a.length===g[f]?j+=a:console.log("Error-KKSFields",a,b),f++}),j};return{getKKS:function(a,b){return e(a,b)}}}]),angular.module("kvdttoasvApp").factory("kvReg",function(){function a(a){var c=a.substr(0,2);if(-1!=b.indexOf(c))return c;if(c=1*c,0>=c||c>99)return!1;var d=!1;return angular.forEach(b,function(a,e){a=1*a,c>a&&c<1*b[e+1]&&(d=b[e+1])}),d}var b=["01","02","03","17","20","38","46","51","52","71","72","73","78","83","88","93","98"];return{getKvReg:function(b){return a(b)}}}),angular.module("kvdttoasvApp").factory("gopStamm",["$filter","ebmResource","gopResource","$q",function(a,b,c,d){var e={};return{setGopData:function(a){if(e.year){var c=d.defer().resolve(!0).promise;return c}return b.query({year:a},function(b){e[a]=b.ebmData}).$promise},getVal:function(b,c,d){var f=a("filter")(e[d],{gop:c});return f[0]?f[0].val:0},getAsvGop:function(a){return c.query({type:a}).$promise}}}]),angular.module("kvdttoasvApp").factory("pfxToPem",function(){var a=null,b=null,c=function(c,d){var e=forge.asn1.fromDer(c,!1);try{var f=forge.pkcs12.pkcs12FromAsn1(e,!1,d)}catch(g){if("PKCS#12 MAC could not be verified. Invalid password?"===g.message)return 403;if("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX."===g.message)return 401}var h=f.getBags({bagType:forge.pki.oids.pkcs8ShroudedKeyBag}),i=h[forge.pki.oids.pkcs8ShroudedKeyBag][0];a=forge.pki.privateKeyToPem(i.key);var j=f.getBags({bagType:forge.pki.oids.certBag}),i=j[forge.pki.oids.certBag][0];return b=forge.pki.certificateToPem(i.cert),!0};return{pfxtopem:function(a,b){return c(a,b)},getPrivateKey:function(){return a},getCetifikat:function(){return b}}}),angular.module("kvdttoasvApp").factory("signCertData",["certResource","b64toBlob","$q",function(a,b,c){var d=function(a){var b=a.trim().split("\n"),c=b.length-1;delete b[0],delete b[c];var d=b.join("");return FileReader.prototype.isSimulated&&(d=d.replace(/\r/g,"")),d},e=function(a,b,c,e,f){var g=new Blob(a,{type:"application/octet-binary",endings:"native"}),h=new FileReader;h.onload=function(a){if("string"==typeof h.result&&(h.result.search("ï¿½")>0||h.result.search("�")>0))return void(h.isSimulated?h.readAsArrayBuffer(g):h.readAsBinaryString(g));var i=forge.pkcs7.createEnvelopedData();i.addRecipient(b),h.isSimulated?i.content=forge.util.createBuffer(forge.util.binary.raw.encode(new Uint8Array(h.result))):i.content=forge.util.createBuffer(h.result),i.encrypt();var j=forge.pkcs7.messageToPem(i);f.resolve({cryptData:d(j),kksData:c,summe:e})},h.readAsText(g)},f=function(a,b,c){b=forge.pki.certificateFromPem(b),c=forge.pki.privateKeyFromPem(c);var d=forge.pkcs7.messageFromAsn1(forge.asn1.fromDer(a));d.findRecipient(b),d.decrypt(d.recipients[0],c);d=forge.pkcs7.messageFromAsn1(forge.asn1.fromDer(d.content.data));var e=d.rawCapture.content.value[0].value;if("object"==typeof e){var f="";return angular.forEach(e,function(a){f+=a.value}),f}return e},g=function(f,g,h){var i=c.defer(),j=forge.pkcs7.createSignedData();return f.kksData&&a.query({ik:f.kksData.substr(62,15).trim()},function(a){if(1===a.error)return void i.reject("Kein Zertifikat gefunden");j.content=forge.util.createBuffer(f.asvData,"iso-8859-15");var c=a.certificate;g=forge.pki.certificateFromPem(g),c=forge.pki.certificateFromPem(c),j.addCertificate(g),j.addSigner({key:h,certificate:g,digestAlgorithm:forge.pki.oids.sha256,authenticatedAttributes:[{type:forge.pki.oids.contentType,value:forge.pki.oids.data},{type:forge.pki.oids.messageDigest},{type:forge.pki.oids.signingTime,value:new Date}]}),j.sign();var k=forge.pkcs7.messageToPem(j);k=d(k),e(b.b64toBlob(k,"octect/stream"),c,f.kksData,f.sum,i)}),i.promise};return{cryptASV:function(a,b,c){return g(a,b,c)},descryptData:function(a,b,c){return f(a,b,c)}}}]),angular.module("kvdttoasvApp").factory("b64toBlob",function(){return{b64toBlob:function(a,b,c){b=b||"",c=c||512;for(var d=atob(a),e=[],f=0;f<d.length;f+=c){for(var g=d.slice(f,f+c),h=new Array(g.length),i=0;i<g.length;i++)h[i]=g.charCodeAt(i);var j=new Uint8Array(h);e.push(j)}return e}}}),angular.module("kvdttoasvApp").factory("asvAccoundingData",["$indexedDB","$q","b64toBlob","signCertData","sendAsvResource","pfxToPem","localStorageService","fileReader","lfdnrResource","asv","kks","asvAccoundingStatusResource",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){switch(a){case"id":return"ID";case"email":return"Empfänger";case"ik":return"KK-IK";case"abrech_ik":return"Abrech-IK";case"dav_ik":return"Datenver.-IK";case"name":return"Datenannahmestelle";case"kasse":return"KK";case"sendTime":return"Übertragung";case"sum":return"Betrag";case"cancellation":return"Storno";case"payed":return"Bezahlt";case"fileName":return"ASV-Daten";case"sendCancellation":return"Storno-Send";default:return a}}function n(a){switch(a){case"id":return!1;default:return!0}}function o(a){switch(a){case"cancellation":return"select";case"payed":return"select";default:return"text"}}function p(a){switch(a){case"payed":return"boolean";case"cancellation":return"boolean";case"sum":return"price";case"fileName":return"asvDataLink";case"sendTime":return"date";case"pdf":return"pdf";case"sendCancellation":return"sendCancellation";default:return"text"}}function q(b){b.payed&&(b.cancellation=!1),a.openStore("asvData",function(a){a.upsert(b)}),w(b)}function r(a){var b=Object.getOwnPropertyNames(a),c=b.map(function(a,b){var c={};return c[a]=o(a),{title:m(a),dataType:p(a),sortable:a,filter:c,filterData:[{id:!0,title:"Ja"},{id:!1,title:"Nein"}],show:n(a),field:a}});return c}function s(a){t(a).then(function(b){var d=new Blob(c.b64toBlob(b.asvData,"octect/stream"),{type:"application/octet-stream;charset=iso-8859-15",encoding:"iso-8859-15"});saveAs(d,a.fileName);var d=new Blob(c.b64toBlob(b.kksData,"octect/stream"),{type:"application/octet-stream;charset=iso-8859-15",encoding:"iso-8859-15"});saveAs(d,a.fileName+".AUF")})}function t(b){return a.openStore("asvSendData",function(a){return a.findBy("asvData_id_idx",b.id)})}function u(a,l){var m=b.defer(),n=f.pfxtopem(g.get("certData"),l);return n!==!0?(m.reject("Zertifikat Passwort ist falsch"),m.promise):(t(a).then(function(g){if(!g)return m.reject("Keine Daten gefunden"),m.promise;var l=new Blob(c.b64toBlob(g.asvData,"octect/stream"),{type:"application/octet-stream;charset=iso-8859-15",encoding:"iso-8859-15"}),n=h.readBlob(l),l=new Blob(c.b64toBlob(g.kksData,"octect/stream"),{type:"application/octet-stream;charset=iso-8859-15",encoding:"iso-8859-15"}),o=h.readBlob(l),p=Math.ceil(((new Date).getMonth()+1)/3),r=i.query({quartal:(new Date).getFullYear()+""+p},function(a){j.setLfdnr(a.lfdnrData)}).$promise;b.all([n,o,r]).then(function(b){var c=j.getFileLfdnr(a.ik);j.setFileName({satzart:{4111:a.ik,4101:p+""+(new Date).getFullYear(),4104:b[1].result.substr(105,5)}});var g=j.createStorno(b[0].result,b[1].result,a.ik),h={asvData:g.asvData,fileName:b[1].result.substr(32,9)+a.ik+"_"+b[1].result.substr(19,4)+c,kksData:k.getKKS(g.asvData,c),sum:0};d.cryptASV(h,f.getCetifikat(),f.getPrivateKey()).then(function(b){e.post({asvData:b.cryptData,kksData:b.kksData,summe:b.summe},function(c){c.sendKK=a.ik,c.nutzerDaten.asvDaten=forge.util.encode64(h.asvData),c.nutzerDaten.kksData=c.kksData,c.nutzerDaten.sendTime=c.sendTime,c.nutzerDaten.summe=b.summe,delete c.kksData,delete c.sendTime,c.nutzerDaten.cancellation=!0,c.nutzerDaten.payed=!1,c.nutzerDaten.sum=0,c.nutzerDaten.fileName=c.nutzerDaten.kksData.substring(19,27),j.storeSendData(c),a.payed=!1,a.cancellation=!0,w(a),w({fileName:c.nutzerDaten.fileName,ik:c.sendKK,sendTime:c.sendTime,payed:c.nutzerDaten.payed,cancellation:c.nutzerDaten.cancellation}),q(a),m.resolve(!0)})})})}),m.promise)}function v(){return{email:"",id:3,ik:"",kasse:"",name:"",sendTime:"",fileName:"",pdf:"",sum:"",sendCancellation:"",cancellation:"",payed:""}}function w(a){var b={filename:a.fileName,ik:a.ik,sendTime:a.sendTime,paid:a.payed,cancellation:a.cancellation};a.aufFileName&&(b={aufFileName:a.aufFileName,paid:a.payed,cancellation:a.cancellation}),l.update(b)}function x(){return b(function(b,c){a.openStore("asvData",function(a){a.getAll().then(function(a){b(a)},function(a){c(a)})})})}return{getData:x,generateColumns:r,getSampleData:v,updateRow:q,downloadAsvData:s,getAsvData:t,sendCancellation:u,sendStatus:w}}]),angular.module("kvdttoasvApp").factory("fileReader",["$q",function(a){return{readBlob:function(b){return a(function(a,c){var d=new FileReader;d.onload=function(c){return"string"==typeof d.result&&(d.result.search("ï¿½")>0||d.result.search("�")>0)?void(d.isSimulated?d.readAsArrayBuffer(b):d.readAsBinaryString(b,"iso-8859-15")):void a(d)},d.readAsText(b)})}}}]),angular.module("frontendApp").controller("InitCtrl",["$scope","config",function(a,b){a.helpLink=b.helpLink}]),angular.module("frontendApp").controller("GOAELoginCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("frontendApp").controller("MainCtrl",["$rootScope","$location","AuthenticationService","$window","ngDialog","$http","config",function(a,b,c,d,e,f,g){var h=this;h.helpLink=g.helpLink,h.impressum=g.impressum,h.datasecurity=g.datasecurity,h.release=g.release,this.init=function(){a.errorCheck||f.get(g.apiBase+"/de/api/index/errorData").then(function(c){if(a.errorCheck=1,c.data.errorData&&c.data.errorData.length>0){e.openConfirm({data:{},template:'                                <p>Es liegen noch fehlerhafte Leistungen vor.<br>Bitte korrigieren Sie diese entsprechend und geben die Daten erneut zur Abrechnung frei.</p>                                <div class="ngdialog-buttons">                                    <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="confirm(0)">jetzt nicht</button>                                    <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="confirm(1)">zur Übersicht</button>                                </div>',plain:!0}).then(function(a){1===a&&b.path("/errorData")})}})},this.authUserToken=sessionStorage.getObj("globals").authUserToken,this.logout=function(){c.ClearCredentials(),b.path("/")},a.$on("$locationChangeStart",function(a){h.path=b.path()}),this.blank=function(){},this.linkPanel={portal:{home:{icon:"glyphicon-home",href:"/main",title:"Startseite",headerTitle:"",tooltop:"Startseite",func:this.blank},stamm:{icon:"glyphicon-cog",href:"/user",title:"Meine<br>Stammdaten",headerTitle:"Meine Stammdaten",tooltop:"Meine Stammdaten",func:this.blank},patient:{icon:"glyphicon-user",href:"/addpatient",title:"Patienten Stammdaten",headerTitle:"Patienten Stammdaten",tooltop:"Patienten Stammdaten",func:this.blank},patienten:{icon:"diagnose-icon",href:"/patient",title:"Patientenübersicht",headerTitle:"Patientenübersicht",tooltop:"Patientenübersicht",func:this.blank},acc:{icon:"glyphicon-euro",href:"/accounting",title:"Abrechnung",headerTitle:"Abrechnung",tooltop:"Abrechnung",func:this.blank},errorData:{icon:"glyphicon-exclamation-sign",href:"/errorData",title:"Fehlerhaften Leistungen",headerTitle:"Fehlerhaften Leistungen",tooltop:"Fehlerhaften Leistungen",func:this.blank},logout:{icon:"glyphicon-lock",href:"#",title:"Logout",headerTitle:"Logout",tooltop:"Logout",func:this.logout}},asv:{stamm:{icon:"glyphicon-cog",href:"/asv/user",title:"Meine<br>Stammdaten verwalten",headerTitle:"Meine Stammdaten",tooltop:"Meine Stammdaten",func:this.blank},splitter:{icon:"glyphicon-transfer",href:"/asv/kvdttoasv",title:"ASV-Daten Generator<br>und Datenversand an die Krankenkassen",headerTitle:"ASV-Daten Generator",tooltop:"ASV-Daten generieren und versenden",func:this.blank},error:{icon:"glyphicon-alert",href:"/asv/errorDecrypt",title:"EASV-Rückmeldung<br>Entschlüsseln von Fehlermeldungen der Krankenkassen",headerTitle:"EASV-Rückmeldung entschlüsseln",tooltop:"EASV-Rückmeldung entschlüsseln",func:this.blank},acc:{icon:"glyphicon-euro",href:"/asv/accounting",title:"Rechnungsübersicht",headerTitle:"Rechnungsübersicht",tooltop:"Rechnungsübersicht",func:this.blank},logout:{icon:"glyphicon-lock",href:"#",title:"Logout",headerTitle:"Logout",tooltop:"Logout",func:this.logout}}},sessionStorage.getItem("docCirrusUser")&&(h.linkPanel.asv.logout.func=function(){c.ClearCredentials(),window.location.href=window.location.protocol+"//"+window.location.hostname+"/invoice#"})}]),angular.module("frontendApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("frontendApp").controller("UserCtrl",["$scope","userResource","$timeout","$routeParams","notify","zipResource","ngDialog","$http","config","errorSuccsessResource",function(a,b,c,d,e,f,g,h,i,j){var k=this;this.loginModul=parseInt(sessionStorage.getItem("loginModul")),this.formData=sessionStorage.getObj("globals").userData,this.changeZip=function(a){5===a.length&&f.query({zip:a},function(a){k.formData.city=a.city[0],k.responseZip=a.city},function(){k.formData.zip="",e({message:"Postleitzahl nicht gültig.",position:"right",duration:"5000",classes:"alert-danger"})})},this.setCity=function(a){k.formData.city=k.responseZip[a],k.responseZip=[]},this.showGoogleAuth=function(){h.get(i.apiBase+"/de/api/index/googleCode").then(function(b){a.googleAuthQRCode=b.data.googleAuthQRCode,a.googleAuthCode=b.data.googleAuthCode}),g.open({template:"views/googleAuthQRCode.html",scope:a})},this.changePWD=function(){g.open({template:"views/changepwd.html"})},this.submit=function(c){a.submitStart=!0,a.$$childHead.userForm.$valid?b.update(this.formData,function(a){var b=sessionStorage.getObj("globals");b.userData=k.formData,
sessionStorage.setObj("globals",b),e({message:"Ihre Änderungen wurden erfolgreich gespeichert.",position:"right",duration:"5000",classes:"alert-success"}),d.errorEdit&&(j.update({activityDataId:d.errorEdit}),$location.path("/errorData"))},function(a){e({message:"Beim Speichen ist leider ein Fehler aufgetreten.",position:"right",duration:"5000",classes:"alert-danger"})}):e({message:"Fehler: Ihre Änderungen wurden nicht gespeichert. Bitte Hinweise beachten",position:"right",duration:"5000",classes:"alert-danger"})}}]),angular.module("frontendApp").controller("PatientCtrl",["$scope","$rootScope","rootData","patientResource","notify","$location","ngDialog",function(a,b,c,d,e,f,g){var h=this;this.rootData=c,this.contractData=sessionStorage.getObj("globals").userData.contract,this.searchChange=function(){a.isOpen=!0,a.closeAll=!0,b.$broadcast("toogleIsOpen",a)},this.init=function(){h.patienten=[],d.query(null,function(a){angular.forEach(a.patienten,function(b,c){a.patienten[c].diagnoseFormData={locale:"",secure:"G",description:"",contract_id:-1===b.contract_id.indexOf(",")?b.contract_id:"0",accident_flag:"0",utilization:"8"},a.patienten[c].activityForm={description:"",contract_id:-1===b.contract_id.indexOf(",")?b.contract_id:"0",patient_id:b.patient_id}}),h.patienten=a.patienten},function(a){e({message:a.data.message,position:"right",duration:"5000",classes:"alert-danger"})})},this.editPatient=function(a){f.path("/patient/"+a)},this.removePatient=function(a){if(a.activity.length>0)return void g.open({template:'                <h3 class="text-center">Löschen nicht möglich!</h3><p class="text-center">Es wurden bereits Leistungen erfasst.</p>',plain:!0});if(a.diagnose.length>0)return void g.open({template:'                <h3 class="text-center">Löschen nicht möglich!</h3><p class="text-center">Es wurden bereits Diagnosen erfasst.</p>',plain:!0});var b=g.openConfirm({template:'                <p>Möchten Sie den Patient wirklich entfernen?</p>                <div class="ngdialog-buttons">                    <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)">Nein</button>                    <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="confirm(1)">Ja</button>                </div>',plain:!0});b.then(function(b){b&&(h.searchChange(),a.active="n",d.update(a,function(){e({message:"Patient wurde erfolgreich entfernt",position:"right",duration:"5000",classes:"alert-success"})}))})}}]),angular.module("frontendApp").controller("PatientformCtrl",["$scope","patientResource","errorSuccsessResource","$routeParams","notify","$filter","$location","zipResource",function(a,b,c,d,e,f,g,h){function i(a){var b=+a;return b.toString()===a}var j=this;this.onlyNumbers=/^\d+$/,this.contractData=sessionStorage.getObj("globals").userData.contract,this.init=function(){d.patientId?(this.formData=[],b.query({patientId:d.patientId},function(a){j.formData=a.patienten,j.formData[0].date_of_birth=f("amParse","YYYY-MM-DD")(j.formData[0].date_of_birth).format("DD.MM.YYYY"),j.formData[0].cart_livetime=4===j.formData[0].cart_livetime.length?f("amParse","YYYY-MM-DD")(j.formData[0].cart_livetime).format("YYMM"):""}),this.patientId=d.patientId,this.formData[0]&&(this.formData[0].patient_id=this.patientId)):(this.formData=[{gender:"0",insured_type:"0",person_grp:"0",dpm_flag:"0",payment_status:"0"}],this.patientId=0,this.formData[0].patient_id=this.patientId,this.formData[0].institution_number=j.contractData.length>1?"":j.contractData[0].institution_number)},this.datepickerOptions={format:"dd.mm.yyyy",language:"de-DE",autoclose:!0,weekStart:0},this.changeZip=function(a){a&&5===a.length&&h.query({zip:a},function(a){j.formData[0].city=a.city[0],j.responseZip=a.city},function(){j.formData[0].zip="",e({message:"Postleitzahl nicht gültig.",position:"right",duration:"5000",classes:"alert-danger"})})},this.setCity=function(a){j.formData[0].city=j.responseZip[a],j.responseZip=[]},this.cleanForm=function(){angular.forEach(this.formData[0],function(a,b){i(a)?j.formData[0][b]="0":j.formData[0][b]=""}),j.formData[0].number="",j.formData[0].zip="",j.formData[0].insured_number="",j.formData[0].institution_number=j.contractData.length>1?"":j.contractData[0].institution_number,j.formData[0].patient_id=null,j.patientId=null},this.submit=function(){a.submitStart=!0,a.$$childHead.pForm.$valid?this.patientId?b.update(this.formData[0],function(b){e({message:"Ihre Änderungen wurden erfolgreich gespeichert.",position:"right",duration:"5000",classes:"alert-success"}),d.errorEdit&&c.update({activityDataId:d.errorEdit,patientId:a.patientForm.formData[0].patient_id,action:"goToPatient"},function(){g.path("/errorData")}),a.$$childHead.pForm.$setUntouched()},function(){e({message:"Beim Speichern der Patientendaten ist ein Fehler aufgetreten.",position:"right",duration:"5000",classes:"alert-danger"})}):b.save(this.formData[0],function(b){b.patientId&&(j.patientId=b.patientId,j.formData[0].patient_id=b.patientId),e({message:"Ihre Eingaben wurden erfolgreich gespeichert.",position:"right",duration:"5000",classes:"alert-success"}),a.$$childHead.pForm.$setPristine(),a.submitStart=!1},function(a){e({message:"Beim Speichern der Patientendaten ist ein Fehler aufgetreten.",position:"right",duration:"5000",classes:"alert-danger"})}):e({message:"Fehler: Ihre Änderungen wurden nicht gespeichert. Bitte Hinweise beachten",position:"right",duration:"5000",classes:"alert-danger"})}}]),angular.module("frontendApp").controller("DiagnoseCtrl",["$scope","$rootScope","diagnoseResource","notify","$filter","ngDialog","$location",function(a,b,c,d,e,f,g){var h=this;this.$rootScope=b,this.$filter=e,this.proficiency_number_selected_obj={description:""},this.proficiency_number_selected_obj.description=a.patient.diagnoseFormData.description,this.initialValue={diagnose_code:"",parent_code:"",diagnose_text:"",diagnose_id:"",contract_id:"1"},this.autocompleteCodeChange=function(b){a.patient.diagnoseFormData.diagnose_code=b},this.submit=function(){if(!a.diagnoseForm.$valid)return d({message:"Bitte prüfen Sie ihre Eingaben.",position:"right",duration:"5000",classes:"alert-danger"}),!1;if(!moment(a.patient.diagnoseFormData.diagnose_datum,"DD.MM.YYYY",!0).isValid())return d({message:"Bitte prüfen Sie ihre Datumseingaben.",position:"right",duration:"5000",classes:"alert-danger"}),!1;if(moment(a.patient.diagnoseFormData.diagnose_datum,"DD.MM.YYYY",!0).isAfter(new Date))return d({message:"Das Diagnosedatum darf nicht in der Zukunft liegen.",position:"right",duration:"5000",classes:"alert-danger"}),!1;if(!this.proficiency_number_selected_obj||!this.proficiency_number_selected_obj.description)return d({message:"Es ist ein Fehler aufgetreten. Diagnose-Code wurde nicht korrekt ausgewählt.",position:"right",duration:"5000",classes:"alert-danger"}),!1;a.patient.diagnoseFormData.commentary||(a.patient.diagnoseFormData.commentary=""),a.patient.diagnoseFormData.exclusion_portfolio||(a.patient.diagnoseFormData.exclusion_portfolio=""),delete a.patient.diagnoseFormData.description,this.proficiency_number_selected_obj.title&&(a.patient.diagnoseFormData.diagnose_code=this.proficiency_number_selected_obj.title),a.patient.diagnoseFormData.patient_id=a.patient.patient_id,a.patient.diagnoseFormData.diagnose_datum=this.$filter("amParse")(a.patient.diagnoseFormData.diagnose_datum,"DD.MM.YYYY").format("YYYY-MM-DD");var b=this.proficiency_number_selected_obj.description,f=function(c){if(a.patient.diagnoseFormData.diagnose_text=b,a.patient.diagnoseFormData.active="j",a.patient.diagnoseFormData.diagnose_id){if(a.patient.diagnose){var f=e("filter")(a.patient.diagnose,{diagnose_id:a.patient.diagnoseFormData.diagnose_id});a.patient.diagnose[a.patient.diagnose.indexOf(f[0])]=angular.copy(a.patient.diagnoseFormData)}}else c.diagnose_id&&(a.patient.diagnoseFormData.diagnose_id=c.diagnose_id),a.patient.diagnose.push(angular.copy(a.patient.diagnoseFormData));a.patient.diagnoseFormData.diagnose_id=null,h.$rootScope.$broadcast("insertDiagnose"),a.patient.diagnoseFormData={locale:"",secure:"G",description:"",contract_id:a.patient.diagnoseFormData.contract_id,accident_flag:"0",utilization:"8"},h.proficiency_number_selected_obj.description="",d({message:"Die Diagnosdaten wurden gespeichert.",position:"right",duration:"5000",classes:"alert-success"}),a.diagnoseForm.$setPristine(),angular.element("input[name=proficiency_number]").scope().searchStr="",a.submitStart=!1};a.patient.diagnoseFormData.active||(a.patient.diagnoseFormData.active="j"),a.patient.diagnoseFormData.diagnose_id?c.update(a.patient.diagnoseFormData,f,function(){d({message:"Fehler beim speichern der Diagnosedaten.",position:"right",duration:"5000",classes:"alert-danger"})}):c.save(a.patient.diagnoseFormData,f,function(){d({message:"Fehler beim speichern der Diagnosedaten.",position:"right",duration:"5000",classes:"alert-danger"})})},this.editPatient=function(){if(a.diagnoseForm.$dirty){f.openConfirm({controller:"diagnoseConfirmDialogCtrl",data:{patientId:a.patient.patient_id,ctrl:this},template:'                        <p>Das Diagnose-Formular wurde verändert.<br>Möchten Sie die Daten speichern? </p>                        <div class="ngdialog-buttons">                            <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="notSubmit()">Nein</button>                            <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="confirm()">Ja</button>                        </div>',plain:!0})}else g.path("/patient/"+a.patient.patient_id)}}]).controller("diagnoseConfirmDialogCtrl",["$scope","$location",function(a,b){a.confirm=function(a){this.closeThisDialog(0),this.ngDialogData.ctrl.submit()!==!1&&b.path("/patient/"+this.ngDialogData.patientId)},a.notSubmit=function(){this.closeThisDialog(0),b.path("/patient/"+this.ngDialogData.patientId)}}]),angular.module("Authentication").controller("LoginCtrl",["$scope","$location","AuthenticationService","ngDialog","config",function(a,b,c,d,e){c.ClearCredentials(),sessionStorage.setItem("loginModul",2),a.helpLink=e.helpLink,a.login=function(){a.dataLoading=!0,c.Login(a.username,a.password,sessionStorage.getItem("loginModul"),function(c){sessionStorage.setItem("googleAuthQRCode",c.googleAuthQRCode),sessionStorage.setItem("googleAuthCode",c.googleAuthCode),sessionStorage.setItem("loginToken",c.token),sessionStorage.setItem("loginModul",2),b.path("/rsa-login"),a.dataLoading=!1},function(b){c.ClearCredentials(),a.error=b.data.message,a.dataLoading=!1})},a.openPlain=function(){d.open({template:"views/forgetPassword.html",controller:"ForgotPasswordCtrl"})}}]),angular.module("Authentication").controller("RsaLoginCtrl",["$scope","$rootScope","$location","AuthenticationService",function(a,b,c,d){a.googleAuthQRCode=sessionStorage.getItem("googleAuthQRCode"),a.googleAuthCode=sessionStorage.getItem("googleAuthCode"),a.login=function(){a.dataLoading=!0,d.RsaAuth(a.rsaKey,function(a){d.SetCredentials(a.data.token).then(function(){2===parseInt(sessionStorage.getItem("loginModul"))?c.path("/main"):1===parseInt(sessionStorage.getItem("loginModul"))&&c.path("/asv/kvdttoasv")})},function(b){a.error=b.data.message,a.dataLoading=!1})}}]),angular.module("frontendApp").controller("TimelineCtrl",["$scope","$filter","$http","config","ngDialog","activityResource","diagnoseResource",function(a,b,c,d,e,f,g){a.change_activity=function(e){var f=$("div.active form[name=activityForm]"),g=f.scope();g.acti.activity_id=e.activity_id;var h=f.find("input[ng-model=searchStr]");c.get(d.apiBase+"/de/api/index/activity/contract/"+a.patient.diagnoseFormData.contract_id+"/patientId/"+a.patient.patient_id+"/activityId/"+e.activity_id+"/find?s="+e.activity_code).then(function(a){g.acti.initialValue=a.data[0],g.acti.activity_code_selected_obj.title=e.activity_code,g.acti.activity_code_selected_obj.originalObject=a.data[0],h.scope().searchStr=e.activity_code,g.acti.activity_code_selected_obj.description=a.data[0].activity_text;var c={activity_code:e.activity_code,activity_id:e.activity_id,contract_id:e.contract_id,activity_date:b("amParse")(e.activity_date,"YYYY-MM-DD").format("DD.MM.YYYY"),activity_text:e.activity_text,activitydata_id:e.activitydata_id,info:e.info,patient_id:e.patient_id};g.patient.activityForm=c;var d=f.parents(".tabbable").scope().$$childHead.panes;d[0].selected=!1,d[1].selected=!0})},a.change_diagnose=function(e){var f=$("div.active form[name=diagnoseForm]"),g=f.scope();g.diag.diagnose_id=e.diagnose_id;var h=f.find("input[ng-model=searchStr]");c.get(d.apiBase+"/de/api/index/icd10/contract/"+e.contract_id+"/patientId/"+a.patient.patient_id+"/diagnoseId/"+e.diagnose_id+"/find?s="+e.diagnose_code).then(function(a){g.diag.initialValue=a.data[0],g.diag.proficiency_number_selected_obj.title=e.diagnose_code,g.diag.proficiency_number_selected_obj.description=e.diagnose_text,g.diag.proficiency_number_selected_obj.originalObject=a.data[0],h.scope().searchStr=e.diagnose_code;var c={locale:e.locale,secure:e.secure,diagnose_datum:b("amParse")(e.diagnose_datum,"YYYY-MM-DD").format("DD.MM.YYYY"),description:e.diagnose_text,contract_id:e.contract_id,accident_flag:e.accident_flag,utilization:e.utilization,diagnose_id:e.diagnose_id,commentary:e.commentary,exclusion_portfolio:e.exclusion_portfolio};g.patient.diagnoseFormData=c;var d=f.parents(".tabbable").scope().$$childHead.panes;d[1].selected=!1,d[0].selected=!0})},a.removeDiagnose=function(b,c){var d=e.openConfirm({template:'                <p>Möchten Sie die Diagnose wirklich entfernen?</p>                <div class="ngdialog-buttons">                    <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)">Nein</button>                    <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="confirm(1)">Ja</button>                </div>',plain:!0});d.then(function(d){d&&(b.active="n",g.update(b,function(){a.patient.diagnose.splice(c,1)}))})},a.removeActivity=function(b,c){var d=e.openConfirm({template:'                <p>Möchten Sie die Leistung wirklich entfernen?</p>                <div class="ngdialog-buttons">                    <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)">Nein</button>                    <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="confirm(1)">Ja</button>                </div>',plain:!0});d.then(function(d){d&&(b.active="n",f.update(b,function(){a.patient.activity.splice(c,1)}))})}}]),angular.module("frontendApp").controller("ActivityCtrl",["$scope","$rootScope","activityResource","notify","$filter","ngDialog","$location",function(a,b,c,d,e,f,g){var h=this;this.$filter=e,this.$rootScope=b,this.activity_code_selected_obj={description:""},this.activity_code_selected_obj.description=a.patient.activityForm.description,this.initialValue={activity_code:"",activity_id:"",activity_text:"",contract_id:"",max_count:"",price:""},this.submit=function(){if(!a.activityForm.$valid)return d({message:"Bitte prüfen Sie ihre Eingaben.",position:"right",duration:"5000",classes:"alert-danger"}),!1;if(!moment(a.patient.activityForm.activity_date,"DD.MM.YYYY",!0).isValid())return d({message:"Bitte prüfen Sie ihre Datumseingaben.",position:"right",duration:"5000",classes:"alert-danger"}),!1;if(moment(a.patient.activityForm.activity_date,"DD.MM.YYYY",!0).isAfter(new Date))return d({message:"Das Leistungsdatum darf nicht in der Zukunft liegen.",position:"right",duration:"5000",classes:"alert-danger"}),!1;if(!this.activity_code_selected_obj||!this.activity_code_selected_obj.title)return d({message:"Es ist ein Fehler aufgetreten. Gebürenziffer wurde nicht korrekt ausgewählt.",position:"right",duration:"5000",classes:"alert-danger"}),!1;this.activity_code_selected_obj.title&&(a.patient.activityForm.activity_code=this.activity_code_selected_obj.title,a.patient.activityForm.activity_id=this.activity_code_selected_obj.originalObject.activity_id),a.patient.activityForm.patient_id=a.patient.patient_id,a.patient.activityForm.activity_date=this.$filter("amParse")(a.patient.activityForm.activity_date,"DD.MM.YYYY").format("YYYY-MM-DD");var b=this.activity_code_selected_obj.description;delete a.patient.activityForm.description;var f=function(c){if(a.patient.activityForm.active="j",a.patient.activityForm.status="C",a.patient.activityForm.activity_text=b,a.patient.activityForm.info&&(a.patient.activityForm.info=""),a.patient.activityForm.activitydata_id){if(a.patient.activity){var f=e("filter")(a.patient.activity,{activity_id:a.patient.activityForm.activity_id});a.patient.activity[a.patient.activity.indexOf(f[0])]=angular.copy(a.patient.activityForm)}}else a.patient.activityForm.activitydata_id=c.activitydata_id,a.patient.activity.push(angular.copy(a.patient.activityForm));a.patient.activityForm.activitydata_id=null,h.$rootScope.$broadcast("insertActivity");var g=a.patient.activityForm.contract_id;a.patient.activityForm={contract_id:g},angular.element("input[name=activity_code]").scope().searchStr="",h.activity_code_selected_obj.description="",d({message:"Die Leistungsdaten wurden gespeichert.",position:"right",duration:"5000",classes:"alert-success"}),a.activityForm.$setPristine(),a.submitStart=!1};a.patient.activityForm.active||(a.patient.activityForm.active="j"),a.patient.activityForm.info||(a.patient.activityForm.info=""),a.patient.activityForm.activitydata_id?c.update(a.patient.activityForm,f,function(a){d({message:"Fehler beim speichern der Leistungsdaten.",position:"right",duration:"5000",classes:"alert-danger"})}):c.save(a.patient.activityForm,f,function(b){a.patient.activityForm.activity_text="",a.patient.activityForm.activitydata_id=null,a.patient.activityForm.info="",h.$rootScope.$broadcast("insertActivity");var c=a.patient.activityForm.contract_id;a.patient.activityForm={contract_id:c},angular.element("input[name=activity_code]").scope().searchStr="",h.activity_code_selected_obj.description="",a.activityForm.$setPristine(),a.submitStart=!1})},this.editPatient=function(){if(a.activityForm.$dirty){f.openConfirm({controller:"diagnoseConfirmDialogCtrl",data:{patientId:a.patient.patient_id,ctrl:this},template:'                        <p>Das Diagnose-Formular wurde verändert.<br>Möchten Sie die Daten speichern? </p>                        <div class="ngdialog-buttons">                            <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="notSubmit()">Nein</button>                            <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="confirm()">Ja</button>                        </div>',plain:!0})}else g.path("/patient/"+a.patient.patient_id)}}]),angular.module("frontendApp").controller("ChangePwdCtrl",["$scope","$http","notify","ngDialog",function(a,b,c,d){a.pwdData={},a.change=function(){a.changePwdForm.$valid&&b.post("/de/api/index/changePwd",a.pwdData).then(function(b){b.data.error?a.error="Passwort konnte nicht geändert werden.<br>Bitte prüfen Sie ihre Eingaben.":(d.close(a.ngDialogId),c({message:"Das Passwort wurde erfolgreich geändert.",position:"right",duration:"5000",classes:"alert-success"}))})}}]),angular.module("frontendApp").controller("AccountingCtrl",["$rootScope","$scope","accountingResource","$filter","sendIvResource","notify","signCertData","activityResource","$http","ngDialog","config",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;this.availableCnt=[],this.accountingData=[],this.sendAccountingData=[],this.korr={},this.showKorr=0;var m=new Date,n=m.getFullYear();b.years=[],this.userData=sessionStorage.getObj("globals").userData;for(var o=2015;n>=o;o++)b.years.push(o);l.getAccountingData=function(){c.query({},function(a){l.accountingData=a.accountingData})},l.getAccountingData(),b.datepickerOptions={from:{startDate:"01.01.2015"},to:{startDate:"01.01.2015"}},this.activityCheck={},this.getStatusText=function(a){switch(a){case"C":return"offen";case"F":return"freigegeben";case"S":return"an Krankenkasse übertragen";case"E":return"fehlerhafte Daten";case"P":return"abgerechnet"}};new Date;l.dafilter={quartal:"",year:"",type:"1",timeRangeFrom:"",timeRangeTo:""},b.submit2=function(){j.openConfirm({template:"views/sendDataDialog.html",className:"ngdialog-theme-default",scope:b}).then(function(a){if(1===a){var b=[];angular.forEach($("input[type=checkbox]:checked"),function(a){b.push(a.value)}),h.update({updateSend:b,filter:l.dafilter},function(a){a.error?f({message:a.error,position:"right",duration:"5000",classes:"alert-danger"}):(f({message:"Ihre Daten wurden erfolgreich für die Abrechnung bereitgestellt.",position:"right",duration:"5000",classes:"alert-success"}),l.getAccountingData())})}})}}]),angular.module("kvdttoasvApp").controller("KvdtToAsvCtrl",["$scope","$rootScope","kvdt","asv","kks","$location","$timeout","WizardHandler","pfxToPem","signCertData","b64toBlob","gopStamm","lfdnrResource","providerResource","$q","sendAsvResource","localStorageService","AuthenticationService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a.reader=null,a.dataReady=!1,a.uploadedFileName=null,a.certData=null,a.certPwd="",a.certUpload="",a.kvdtUpload="",a.sendRes=[],a.docCirrusData=null,a.current=0,a.max=100,a.analyseDataStep=1,a.asvType="",a.calculateASVPrice=0,a.sendStatus="Die Daten werden Versand",a.sendStatusClass="alert-info";var s=!0;b.KVDTASV&&(a.docCirrusData=!0),q.get("certData")&&(a.certData=q.get("certData")),a.certLoaded=function(b,c,d){a.certData=b,a.certError=null,a.$digest()},a.startWizart=function(){angular.forEach(a.$$childHead.steps,function(a){a.completed=!1,a.selected=!1}),h.wizard().goTo(0),a.sendStatus="Die Daten werden Versand",a.sendStatusClass="alert-info",s=!0,a.sendRes=[]};var t=function(b){var c="btn-success";1===b.error&&(c="btn-danger"),a.sendRes.push({nutzerDaten:b.nutzerDaten,"class":c,message:b.message,sendKK:b.sendKK}),b.nutzerDaten.cancellation=!1,b.nutzerDaten.payed=!1,b.nutzerDaten.sum=b.nutzerDaten.summe,b.nutzerDaten.fileName=b.nutzerDaten.kksData.substring(19,27),d.storeSendData(b),s&&(a.sendStatus="Ihre Daten wurden erfolgreich Versand",a.sendStatusClass="alert-success",g(function(){h.wizard().next(),h.wizard().finish(),a.$$childHead.steps[a.$$childHead.steps.length-1].completed=!0,a.$$childHead.steps[a.$$childHead.steps.length-1].selected=!1},1e3),a.docCirrusData&&sessionStorage.removeItem("docCirrusCon"),s=!1)};a.setCertPwd=function(){var b=i.pfxtopem(a.certData,this.certPwd);401===b?(a.certError="Ihr Zertifikat ist nicht im richtigen Format(.PFX)",a.certData=null):403===b?a.certError="Das eingegebene Passwort passt nicht zum Zertifikat.":(a.certError=null,h.wizard().next(),a.cryptASV(),q.set("certData",a.certData))},a.resetCert=function(){q.remove("certData"),a.certData=null},a.kvdtLoaded=function(b,e,i){a.docCirrusData||h.wizard().next(),$("input[name=kvdt]").val(""),a.uploadedFileName=e;var j=(new Date).getFullYear(),k=r.checkDocCirrus(),p=l.setGopData(j-1+""),q=l.setGopData(j+""),s=Math.ceil(((new Date).getMonth()+1)/3),t=m.query({quartal:(new Date).getFullYear()+""+s},function(a){d.setLfdnr(a.lfdnrData)}).$promise;o.all([k,p,q,t]).then(function(e){return-1!==e.indexOf(void 0)?(r.ClearCredentials(),f.path("/asv/login"),!1):(a.cntLeistungen=0,a.cntAsvLeistungen=0,a.cntPatienten=0,a.cntAsvPatienten=0,void(c.setData(b)?n.query({"kkiks[]":Object.keys(c.getKKiks())},function(b){d.setProviderData(b.providerData),a.checkedSendKK=[],a.findAllKK=angular.copy(c.getKKdata()),angular.forEach(a.findAllKK,function(b,c){a.checkedSendKK.push(c)}),d.setKvdtData(c.getDataBlock(),c.getKKdata()),a.dataReady=!0,a.cntLeistungen=c.getCntLeistungen(),a.cntAsvLeistungen=d.getASVCnt(),a.cntPatienten=c.getCntPatienten(),a.cntAsvPatienten=c.getCntAsvPatienten(),g(function(){h.wizard().next()},1e3)}):(a.dataReady=!0,g(function(){h.wizard().next()},1e3),a.cntLeistungen=c.getCntLeistungen(),a.cntAsvLeistungen=d.getASVCnt(),a.cntPatienten=c.getCntPatienten(),a.cntAsvPatienten=c.getCntAsvPatienten())))})},a.createCsvData=function(){var b=new Blob([c.createCSVData()],{type:"text/plain;charset=iso-8859-15"});saveAs(b,a.uploadedFileName.replace(/\.con$/i,"")+".CSV")},a.downloadAllASV=function(){angular.forEach(d.getASVFileData(),function(b,c){b instanceof Object&&-1!==a.checkedSendKK.indexOf(c)&&a.downloadASV(c)})},a.downloadASV=function(a){var b=new Blob(k.b64toBlob(forge.util.encode64(d.getASVFileData()[a].asvData),"octect/stream"),{type:"application/octet-stream;charset=iso-8859-15",encoding:"iso-8859-15"});saveAs(b,d.getASVFileData()[a].fileName);var b=new Blob(k.b64toBlob(forge.util.encode64(d.getASVFileData()[a].kksData),"octect/stream"),{type:"application/octet-stream;charset=iso-8859-15",encoding:"iso-8859-15"});saveAs(b,d.getASVFileData()[a].fileName+".AUF")},a.cryptASV=function(){angular.forEach(d.getASVFileData(),function(b,c){-1!==a.checkedSendKK.indexOf(c)&&j.cryptASV(b,i.getCetifikat(),i.getPrivateKey()).then(function(a){p.post({asvData:a.cryptData,kksData:a.kksData,summe:a.summe},function(d){d.sendKK=c,d.nutzerDaten.asvDaten=forge.util.encode64(b.asvData),d.nutzerDaten.kksData=d.kksData,d.nutzerDaten.sendTime=d.sendTime,d.nutzerDaten.summe=a.summe,delete d.kksData,delete d.sendTime,t(d)})})})},a.analyseData=function(b){a.analyseDataStep+=1,3===a.analyseDataStep&&d.getGop(b).then(function(b){a.analyseDataStep+=1,g(function(){c.checkASVintoKVDT(b.data.gop_array,a.current,a.cntLeistungen)},500)})},b.$on("checkGopIsAsvData",function(b,c){a.current=c.current,a.calculateASVPrice=c.price}),a._init=function(){if(sessionStorage.getItem("docCirrusCon")&&sessionStorage.getItem("docCirrusUser")&&!b.KVDTASV){var c=r.checkDocCirrus();o.all([c]).then(function(){b.KVDTASV&&(a.kvdtLoaded(b.KVDTASV,"doc-cirrus.con","ISO-8859-15"),b.KVDTASV=null)})}else b.KVDTASV&&(a.kvdtLoaded(b.KVDTASV,"doc-cirrus.con","ISO-8859-15"),b.KVDTASV=null)},a.backToDocCirus=function(){r.ClearCredentials(),window.location.href=window.location.protocol+"//"+window.location.hostname+"/invoice#"}}]),angular.module("kvdttoasvApp").controller("ConsultancyContractCtrl",function(){}),angular.module("kvdttoasvApp").controller("ContactFormCtrl",["$scope","$window",function(a,b){a.authUserToken=sessionStorage.getObj("globals").authUserToken}]),angular.module("kvdttoasvApp").controller("ASVLoginCtrl",["$scope","$rootScope","$location","AuthenticationService","$routeParams","config",function(a,b,c,d,e,f){d.ClearCredentials(),sessionStorage.setItem("loginModul",1),a.isAsvExample=f.isAsvExample,e.docCirrusCon&&(b.KVDTASV=null,sessionStorage.setItem("docCirrusCon",e.docCirrusCon)),e.docCirrusUser&&sessionStorage.setItem("docCirrusUser",e.docCirrusUser),a.login=function(){a.dataLoading=!0,d.Login(a.username,a.password,parseInt(sessionStorage.getItem("loginModul")),function(b){sessionStorage.setItem("googleAuthQRCode",b.googleAuthQRCode),sessionStorage.setItem("googleAuthCode",b.googleAuthCode),sessionStorage.setItem("loginToken",b.token),sessionStorage.setItem("loginModul",1),c.path("/asv/rsa-login"),a.dataLoading=!1},function(b){d.ClearCredentials(),a.error=b.data.message,a.dataLoading=!1})}}]),angular.module("frontendApp").controller("AsvaccountingCtrl",["$scope","$filter","NgTableParams","asvAccoundingData","accoundingpdf","ngDialog","notify",function(a,b,c,d,e,f,g){var h=this;this.certPass=null;a.cols=d.generateColumns(d.getSampleData()),d.getData().then(function(a){return a}),a.changeCkeckbox=function(a){d.updateRow(a)},a.downloadAsvData=function(a){d.downloadAsvData(a)},a.downloadAsvPdf=function(a){e.printAsvData(a)},a.sendCancellation=function(b){f.openConfirm({template:"views/asv/sendStornoDialog.html",className:"ngdialog-theme-default",scope:a}).then(function(c){d.sendCancellation(b,h.certPass).then(function(){a.tableParams.reload()},function(a){g({message:a,position:"right",duration:"5000",classes:"alert-danger"})})})},a.tableParams=new c({page:1,count:10,sorting:{sendTime:"desc"}},{filterDelay:0,getData:function(a,c){return d.getData().then(function(a){var d=c.filter();return angular.isUndefined(d.cancellation)||""!==d.cancellation||(d={}),angular.isUndefined(d.payed)||""!==d.payed||(d={}),a=b("filter")(b("orderBy")(a,c.orderBy()),d),c.total(a.length),a.slice((c.page()-1)*c.count(),c.page()*c.count())})}})}]),angular.module("kvdttoasvApp").controller("ErrordecryptCtrl",["$scope","pfxToPem","signCertData","WizardHandler","localStorageService","$timeout","notify","asvAccoundingData",function(a,b,c,d,e,f,g,h){a.certData=null,a.errorFileLoaded=function(e,i,j){$("input[type=file]").val("");try{var k=c.descryptData(e,b.getCetifikat(),b.getPrivateKey()).trim()}catch(l){return g(-1!==l.message.indexOf("Encryption block is invalid")?{message:"Diese Daten wurden nicht mit Ihrem Zertifikat verschlüsselt.",position:"right",duration:"5000",classes:"alert-danger"}:-1!==l.message.indexOf("Cannot read PKCS#7 message.")?{message:"Diese Daten wurden nicht verschlüsselt. Oder sind im falschen Format.",position:"right",duration:"5000",classes:"alert-danger"}:{message:l.message,position:"right",duration:"5000",classes:"alert-danger"}),!1}var m=k.match(/UNA(.*)UNB/);if(m){m=m[1].split("");var n=k.split(m[5]),o=n[1];if(o){var p=o.split(m[1]);p&&"UNB"===p[0]&&h.sendStatus({aufFileName:p[5],cancellation:!0,paid:!1})}a.decyptData=n.join("\n"),a.decyptData=a.decyptData.split(m[1]).join("+"),a.decyptData=a.decyptData.split(m[0]).join(":")}else a.decyptData=k.replace(/'/g,"\n");a.$digest(),f(function(){d.wizard().next(),d.wizard().finish()})},a.certLoaded=function(b,c,e){a.certData=b,a.certError=null,a.$digest(),f(function(){d.wizard().next()})},a.setCertPwd=function(){var c=b.pfxtopem(a.certData,this.certPwd);401===c?(a.certError="Ihr Zertifikat ist nicht im richtigen Format(.PFX)",a.certData=null):403===c?a.certError="Das eingegebene Passwort passt nicht zum Zertifikat.":(a.certError=null,f(function(){d.wizard().next()}))},a._init=function(){e.get("certData")&&(a.certData=e.get("certData"),f(function(){d.wizard().next()}))}}]),angular.module("kvdttoasvApp").controller("ASVtestRegistryCtrl",["$scope","notify","zipResource","config","$http","ngDialog","$location",function(a,b,c,d,e,f,g){var h=this;this.changeZip=function(a){5===a.length&&c.query({zip:a},function(a){h.formData.city=a.city[0],h.responseZip=a.city},function(){h.formData.zip="",b({message:"Postleitzahl nicht gültig.",position:"right",duration:"5000",classes:"alert-danger"})})},this.setCity=function(a){h.formData.city=h.responseZip[a],h.responseZip=[]},a.submit=function(){a.submitStart=!0,a.userForm.$valid&&e.post(d.apiBase+"/de/api/index/testRegistry",h.formData).then(function(){var a=f.open({template:"views/test-registry-succ.html",className:"ngdialog-theme-flat"});a.closePromise.then(function(){g.path("/asv/login")})},function(a){b({message:a.data.message,position:"right",duration:"5000",classes:"alert-danger"})})}}]),angular.module("frontendApp").directive("myPopover",["renderHtmlContent",function(a){return{restrict:"A",link:function(b,c,d){b.label=d.popoverLabel;var e=$(c).click(function(){if(e.hasClass("btn-primary"))$("#verlauf").html("").removeClass("col-md-4").addClass("col-sm-0"),$("#patienten").removeClass("col-sm-8").addClass("col-sm-12"),e.removeClass("btn-primary");else{var c=e.offset(),f=c.top-174;$("#patienten").removeClass("col-sm-12").addClass("col-sm-8").find(".verlauf.btn-primary").removeClass("btn-primary"),e.addClass("btn-primary");var g=$('<div class="popover '+d.popoverClass+'"><h3 class="popover-title">'+d.popoverTitle+"</h3></div>"),h=$('<div class="popover-content" id="content"></div>');a.render(b,h,d.popoverTemplate),$("#verlauf").html("").removeClass("col-md-0").addClass("col-sm-4").append(g.append(h)).find(".popover").css({top:f+"px"}).show()}})}}}]),angular.module("frontendApp").directive("datepicker",function(){return $.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],
months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","MÃ¤r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"Löschen",weekStart:1,format:"dd.mm.yyyy"},{restrict:"A",require:"ngModel",scope:{datepickerOptions:"=",ngModel:"="},link:function(a,b,c){var d={format:"dd.mm.yyyy",language:"de",autoclose:!0,endDate:"0d",orientation:"bottom"};angular.extend(d,a.datepickerOptions),a.$watch("ngModel",function(a,c){$(b).datepicker("destroy"),$(b).datepicker(d)})}}}),angular.module("frontendApp").directive("tabs",function(){return{restrict:"E",transclude:!0,scope:{},link:function(a,b,c,d){a.tabsClass=c.tabsClass},controller:["$scope",function(a){var b=a.panes=[];a.select=function(a){angular.forEach(b,function(a){a.selected=!1}),a.selected=!0},this.addPane=function(c){0==b.length&&a.select(c),b.push(c)}}],template:'<div class="tabbable"><ul class="{{tabsClass}}"><li ng-repeat="pane in panes" ng-class="{active:pane.selected}"><a href="" ng-click="select(pane)">{{pane.title}}</a></li></ul><div class="tab-content" ng-transclude></div></div>',replace:!0}}).directive("pane",function(){return{require:"^tabs",restrict:"E",transclude:!0,scope:{title:"@"},link:function(a,b,c,d){d.addPane(a)},template:'<div class="tab-pane" ng-class="{active: selected}" ng-transclude></div>',replace:!0}}),angular.module("frontendApp").directive("headerTitle",["renderHtmlContent","$compile",function(a,b){return{restrict:"E",replace:!0,transclude:!0,scope:{mainPath:"=",linkPanel:"="},link:function(a,b,c){},templateUrl:"views/naviPanel/naviPanel.html"}}]),angular.module("frontendApp").directive("requiredSelect",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){if(d){c.requiredSelect=!0;var e=function(a){return c.requiredSelect&&(d.$isEmpty(a)||isNaN(a)||"0"===a)?(d.$setValidity("requiredSelect",!1),a):(d.$setValidity("requiredSelect",!0),a)};d.$formatters.push(e),d.$parsers.unshift(e),c.$observe("requiredSelect",function(){e(d.$viewValue)})}}}}),angular.module("frontendApp").directive("exactLength",function(){return{require:"ngModel",link:function(a,b,c,d){a.$watch(c.ngModel,function(a,e){var f=parseInt(c.exactLength),g=a?a.length:null,h=!1;g&&f===g&&(h=!0),null!==g||angular.element(b).hasClass("ng-dirty")||(h=!0),d.$setValidity("exactlength",h)})}}}),angular.module("frontendApp").directive("validNumber",function(){return{require:"?ngModel",link:function(a,b,c,d){d&&b.bind("keypress",function(a){var b=a.which||a.keyCode,c=String.fromCharCode(b);isNaN(c)&&[8,37,38,39,40].indexOf(b)<0&&a.preventDefault()})}}}),angular.module("frontendApp").directive("validPhone",function(){return{require:"?ngModel",link:function(a,b,c,d){d&&b.bind("keypress",function(a){var b=a.which||a.keyCode,c=String.fromCharCode(b);isNaN(c)&&"-"!==c&&"/"!==c&&-1===[8,37,38,39,40].indexOf(b)&&a.preventDefault()})}}}),angular.module("frontendApp").directive("validAlnum",function(){return{require:"?ngModel",link:function(a,b,c,d){d&&b.bind("keypress",function(a){var b=a.which||a.keyCode,c=String.fromCharCode(b);c.match(/[^\w+]/)&&[8,37,38,39,40].indexOf(b)<0&&a.preventDefault()})}}}),angular.module("frontendApp").directive("validLanr",function(){var a=function(a){if(a||(a=""),a=a.toUpperCase(a),9===a.length){for(var b=0,c=a.split(""),d=0;6>d;d++)b+=d%2?9*c[d]:4*c[d];return b=10-b%10,b=10===b?0:b,b===1*c[6]}return!1};return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){if(9===b.length){var c=a(b);return e.$setValidity("doctorNumber",c),c?b:void 0}}),e.$formatters.unshift(function(b){return e.$setValidity("doctorNumber",a(b)),b})}}}),angular.module("frontendApp").directive("pwCheck",function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.pwCheck;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(e).val();d.$setValidity("pwmatch",a)})})}}}),angular.module("frontendApp").directive("folderline",["$rootScope","$timeout",function(a,b){return{template:'<button tooltip title="Diagnose / Leistung erfassen" ng-click="toogleIsOpen()" class="btn btn-sm diagnose-icon" style="width:" ng-class="{\'btn-primary\' : isOpen, \'btn-default\' : !isOpen}"><i class="glyphicon" style="width:12px;height:12px;"></i></button>',restrict:"E",scope:{isOpen:"=",rowClass:"@"},replace:!0,transclude:!0,link:function(c,d,e){c.$on("toogleIsOpen",function(a,b){c.$id!==b.$id&&b.isOpen===!0&&(b.closeAll&&c.isOpen===!0&&$(d).parents(".patienten").find("a.verlauf").click(),c.isOpen=!1)}),c.toogleIsOpen=function(){c.isOpen=!c.isOpen,b(function(){$(d).parents(".patienten").find("a.verlauf").click()},600),a.$broadcast("toogleIsOpen",c)}}}}]),angular.module("frontendApp").directive("bootPopover",["$templateRequest","$sce","$compile",function(a,b,c){function d(d,e,f){var f=b.getTrustedResourceUrl(f);a(f).then(function(a){c(e.html(a).contents())(d)},function(){})}return{restrict:"A",link:function(a,b,c){a.label=c.popoverLabel;var e=angular.element(b);e.popover({trigger:c.popoverTrigger,html:!0,content:'<div class="popover-root"></div>',title:c.popoverTitle,placement:c.popoverPlacement,template:'<div class="popover '+c.popoverClass+'"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}).on("inserted.bs.popover",function(b,e){d(a,$("#"+this.getAttribute("aria-describedby")+" .popover-content"),c.popoverTemplate)})}}}]),angular.module("frontendApp").directive("compile",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compile)},function(d){c.html(d),a(c.contents())(b)})}}]),angular.module("frontendApp").directive("getInvoiceForm",function(){return{template:'<button ng-click="getFile()" class="{{buttonclass}}"></button>',restrict:"E",replace:!0,transclude:!0,controller:["$scope","$http",function(a,b){a.getFile=function(){var c=a.quartal?a.quartal.replace("/",""):"";a.url+="/lfdnr/"+a.lfdnr+"/quartal/"+c+"/contract_id/"+a.contract,b({method:"GET",url:a.url,responseType:"arraybuffer"}).then(function(a){header=a.headers();header["content-disposition"].split("=")[1];if(header["content-disposition"].indexOf(".pdf"))var b={type:"application/pdf"};else if(header["content-disposition"].indexOf(".csv"))var b={type:"text/csv"};else if(header["content-disposition"])var b={type:"application/octet-stream"};var c=new Blob([a.data],b);saveAs(c,header["content-disposition"])})}}],scope:{lfdnr:"=",quartal:"=",contract:"=",url:"@",buttonclass:"@",display_name:"="}}}),angular.module("frontendApp").directive("tooltip",function(){return{restrict:"A",link:function(a,b,c){var d={delay:{show:500,hide:100},html:!0,trigger:"hover"};d.placement="top",c.tooltipPlacement&&(d.placement=c.tooltipPlacement),c.$observe("title",function(a){b.tooltip("destroy"),jQuery.trim(a)&&b.tooltip(d)}),b.on("$destroy",function(){b.tooltip("destroy"),delete c.$$observers.title}),b.tooltip(d)}}}),angular.module("kvdttoasvApp").directive("onReadFile",function(){return{restrict:"A",scope:{onReadFile:"=",onReadLoaded:"=",encoding:"@"},link:function(a,b,c){a.onReadFile=new FileReader,b.on("change",function(b){var c=b,d=null,e=0;a.onReadFile.onload=function(b){b||(b=this);var f={$content:b.content||b.target.result,$fileName:(c.srcElement||c.target).files[0].name};return"string"==typeof f.$content&&200>e&&(f.$content.search("ï¿½")>0||f.$content.search("�")>0)?(e++,a.encoding||(a.encoding="ISO-8859-15"),void(a.onReadFile.isSimulated?a.onReadFile.readAsArrayBuffer((c.srcElement||c.target).files[0]):a.onReadFile.readAsBinaryString((c.srcElement||c.target).files[0],a.encoding))):(a.onReadFile.isSimulated&&"object"==typeof f.$content?a.$emit("file-loaded",forge.util.binary.raw.encode(new Uint8Array(f.$content)),f.$fileName,d):a.$emit("file-loaded",f.$content,f.$fileName,d),void(a.onReadLoaded&&(a.onReadFile.isSimulated&&"object"==typeof f.$content?a.onReadLoaded(forge.util.binary.raw.encode(new Uint8Array(f.$content)),f.$fileName,d):a.onReadLoaded(f.$content,f.$fileName,d))))},(b.srcElement||b.target).files.length&&(d="ISO-8859-15",a.onReadFile.readAsText((b.srcElement||b.target).files[0]))})}}}),angular.module("frontendApp").factory("accoundingpdf",["$ocLazyLoad","config","$q","asvAccoundingData","asv","$filter",function(a,b,c,d,e,f){function g(){return c(function(c,d){l?c(!0):a.load(b.apiBase+"/scripts/external/jspdf.min.js").then(function(){a.load(b.apiBase+"/scripts/external/jspdf.plugin.autotable.js").then(function(){c(!0),l=!0})})})}function h(a){var b=e.getSeperator(),c=null,a=forge.util.decode64(a);a=a.split(b.e),angular.forEach(a,function(d,e){if(a[e]=d.split(b.d),angular.forEach(a[e],function(c,d){-1!==c.indexOf(b.i)&&(a[e][d]=c.split(b.i))}),"UNH"===a[e][0])c=e;else if("UNB"!==a[e][0]){var f=a[e][0],g={};g[f]=a[e],a[c].push(g),delete a[e]}}),a=angular.extend({},a);var d=[];return angular.forEach(a,function(a,b){if("0"!==b){var c=f("filter")(a,{LEA:"LEA"}),e=f("filter")(a,{IVA:"IVA"}),g=f("filter")(a,{SAC:"SAC"}),h=f("filter")(a,{REA:"REA"}),i={person:e[0].IVA[2]+" - "+e[0].IVA[3][1]+" "+e[0].IVA[3][0],data:[]};angular.forEach(c,function(a,b){a=a.LEA[1],i.data.push({id:b+1,leistung:a[0],datum:a[1],anzahl:a[2],preis:a[3]+" €",preisGes:f("number")(a[3].replace(",",".")*a[2],2)+" €",text:a[4]||""}),delete a[b]}),g&&angular.forEach(g,function(a,b){a=a.SAC,i.data.push({id:b+1,leistung:"SAC",datum:"",anzahl:a[3],preis:a[1]+" €",preisGes:a[1]+" €",text:a[2]||""})}),i.summe=h[0].REA[1][0],i.data.push({id:"",leistung:"",datum:"",anzahl:"",preis:"",preisGes:h[0].REA[1][0]+" €",text:"Summe:"}),d.push(i)}}),d}function i(a,b){g().then(function(){j(a,b)})}function j(a,b){var c=new jsPDF("p","pt"),d=function(a,b){var d=c.getStringUnitWidth(a)*c.internal.getFontSize()/c.internal.scaleFactor,e=(c.internal.pageSize.width-d)/2;c.text(parseInt(e),b,a)},e=h(a),g=0,i="{total_pages_count_string}";angular.forEach(e,function(a,e){0!==e&&c.addPage();var h=function(e){c.setFontSize(10),c.text(20,20,b.kasse),d(b.sendTime,20),d(b.fileName,35),c.text(420,20,b.email),c.setFontSize(20),c.setTextColor(0),c.setFontStyle("normal"),d(a.person,60),c.setFontSize(10),d("Rechnungsbetrag: "+f("number")(b.sum,2)+" €",75)},j=function(a){g++;var b="Seite "+g;"function"==typeof c.putTotalPages&&(b=b+" von "+i),c.text(b,270,c.internal.pageSize.height-30)};c.autoTable(m(),a.data,{theme:"grid",startY:80,beforePageContent:h,afterPageContent:j,margin:{top:80},drawRow:function(a,b){c.setFontStyle("bold"),c.setFontSize(10)},drawCell:function(a,b){return"ids"===b.column.dataKey?(b.row.index%5===0&&(c.rect(a.x,a.y,b.table.width,5*a.height,"S"),c.autoTableText(b.row.index/5+1+"",a.x+a.width/2,a.y+5*a.height/2,{halign:"center",valign:"middle"})),!1):void 0},createdCell:function(a,b){("preis"===b.column.dataKey||"preisGes"===b.column.dataKey||"anzahl"===b.column.dataKey)&&(a.styles.halign="right")}})}),"function"==typeof c.putTotalPages&&c.putTotalPages(i),c.save("web.pdf")}function k(a){d.getAsvData(a).then(function(b){i(b.asvData,a)})}var l=!1,m=function(){return[{title:"ID",dataKey:"id"},{title:"Datum",dataKey:"datum"},{title:"GOP",dataKey:"leistung"},{title:"Text",dataKey:"text"},{title:"Preis",dataKey:"preis"},{title:"Anz.",dataKey:"anzahl"},{title:"Preis-Ges.",dataKey:"preisGes"}]};return{printAsvData:k}}]),angular.module("frontendApp.errorData.controller",["smart-table"]).config(["$routeProvider",function(a){a.when("/errorData",{templateUrl:"views/errorData.html",controller:"ErrordataCtrl",controllerAs:"error"})}]).controller("ErrordataCtrl",["$scope","$http","config","$filter","$location","ngDialog","errorSuccsessResource",function(a,b,c,d,e,f,g){a.itemsByPage=20,a.init=function(){b.get(c.apiBase+"/de/api/index/allErrorCodes").then(function(d){a.codes=d.data.errorCodes,b.get(c.apiBase+"/de/api/index/errorData").then(function(b){var c=null,d=null,f=[];angular.forEach(b.data.errorData,function(a,g){b.data.errorData[g].errorDetails=e(b.data.errorData[g].error_code,b.data.errorData[g].contract_id),b.data.errorData[g].active="j",d=b.data.errorData[g].patient_id,c===d&&"goToActivity"!==b.data.errorData[g].errorDetails.action||f.push(b.data.errorData[g]),c=d}),a.errorData=f})});var e=function(b,c){var e=d("filter")(a.codes,{errorcode:b,contract_id:c});return 1===e.length?e[0]:[]}},a.goToPatient=function(a){e.path("/patient/"+a.patient_id+"/"+a.activitydata_id)},a.goToStamm=function(a){e.path("/user/"+a.activitydata_id)},a.goToAcivity=function(a){f.open({templateUrl:"views/activityDataForm.html",controller:"ErroractivityCtrl",controllerAs:"patient",data:a,trapFocus:!1,preserveFocus:!1,width:750})},a.goToDiag=function(a){f.open({templateUrl:"views/diagnoseForm.html",controller:"ErrordiagnoseCtrl",controllerAs:"patient",data:a,trapFocus:!1,preserveFocus:!1,width:750})},a.setErrorSuccess=function(b,c){g.update({activityDataId:b.activitydata_id},function(){a.errorData.splice(c,1)})}}]),angular.module("frontendApp").controller("ForgotPasswordCtrl",["$scope","$http","config",function(a,b,c){a.formData={},a.success=!1,a.submit=function(){a.form.$valid&&b.post(c.apiBase+"/de/api/index/forgotPwd",a.formData).then(function(b){b.data.error||(a.success=!0)},function(b){a.error=b.data.message})}}]),angular.module("frontendApp.DocumentCtrl.controller",[]).config(["$routeProvider",function(a){a.when("/document",{templateUrl:"views/document.html",controller:"DocumentCtrl",controllerAs:"doc"})}]).controller("DocumentCtrl",["$scope","$http","config",function(a,b,c){a.documents=[],a.documentCat=[],b.get(c.apiBase+"/de/api/index/documentCat").then(function(b){a.documentCat=b.data.data}),b.get(c.apiBase+"/de/api/index/documents").then(function(b){a.documents=b.data.data})}]),angular.module("frontendApp").directive("validInsuredNumber",function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),b=function(a){a+="";for(var b=a.split(""),c=0,d=0;c<b.length;d+=b[c++]-0);return d},c=function(c){if(c||(c=""),c=c.toUpperCase(c),c.match(/^[a-zA-Z][0-9]{9}/)){var d=a.indexOf(c.substring(0,1))+1;10>d&&(d="0"+d);var e=c.substr(-1)-0;c=d+c.substr(1,8);for(var f=0,g=c.split(""),h=0;10>h;h++)f+=b(h%2?2*g[h]:1*g[h]);return f%10===e}return!1};return{require:"ngModel",link:function(a,b,d,e){e.$parsers.unshift(function(a){if(10===a.length){var b=c(a);return e.$setValidity("insuredNumber",b),b?a:void 0}}),e.$formatters.unshift(function(a){return e.$setValidity("insuredNumber",c(a)),a})}}}),angular.module("frontendApp").controller("ErrordiagnoseCtrl",["$scope","$rootScope","patientResource","errorSuccsessResource","$filter","$timeout","ngDialog",function(a,b,c,d,e,f,g){var h=this;this.diagnoseFormData={},this.autocompleteCodeChange=function(b){a.patient.diagnoseFormData.diagnose_code=b},b.$on("insertDiagnose",function(){g.close(),d.update({activityDataId:a.ngDialogData.activitydata_id,patientId:a.ngDialogData.patient_id,action:"goToDiag"},function(){a.ngDialogData.active="n"})}),c.query({patientId:a.ngDialogData.patient_id},function(b){f(function(){var c=b.patienten[0].diagnose[b.patienten[0].diagnose.length-1],d=$("form[name=diagnoseForm]"),f=d.scope();f.diag.diagnose_id=c.diagnose_id;var g=d.find("input[ng-model=searchStr]");h.diagnoseFormData=b.patienten[0].diagnose[b.patienten[0].diagnose.length-1],f.diag.proficiency_number_selected_obj.title=c.diagnose_code,f.diag.proficiency_number_selected_obj.description=c.diagnose_text,f.diag.proficiency_number_selected_obj.originalObject={},g.scope().searchStr=c.diagnose_code;var i={locale:c.locale,secure:c.secure,diagnose_datum:e("amParse")(c.diagnose_datum,"YYYY-MM-DD").format("DD.MM.YYYY"),description:c.diagnose_text,contract_id:c.contract_id,accident_flag:c.accident_flag,utilization:c.utilization,diagnose_id:c.diagnose_id,commentary:c.commentary,exclusion_portfolio:c.exclusion_portfolio};f.patient.diagnoseFormData=i,f.patient.patient_id=a.ngDialogData.patient_id,f.patient.errorActivityDataId=a.ngDialogData.activitydata_id})}),this.patientId=a.ngDialogData.patient_id}]),angular.module("frontendApp").controller("ErroractivityCtrl",["$rootScope","$scope","$timeout","$filter","$http","config","ngDialog","errorSuccsessResource",function(a,b,c,d,e,f,g,h){b.patient={},b.patient.activityForm={};var i=b.ngDialogData,j=this;j.patient_id=i.patient_id,a.$on("insertActivity",function(){g.close(),h.update({activityDataId:b.ngDialogData.activitydata_id},function(){b.ngDialogData.active="n"})}),a.$on("ngDialog.opened",function(a,b){var g=$("form[name=activityForm]"),h=g.scope();c(function(){e.get(f.apiBase+"/de/api/index/activity/contract/"+i.contract_id+"/patientId/"+i.patient_id+"/activityId/"+i.activity_id+"/find?s="+i.activity_code).then(function(b){h.acti.initialValue=b.data[0],h.acti.activity_code_selected_obj.title=i.activity_code,h.acti.activity_code_selected_obj.originalObject=b.data[0],a.scope().searchStr=i.activity_code,h.acti.activity_code_selected_obj.description=b.data[0].activity_text}),h.acti.activity_id=i.activity_id;var a=g.find("input[ng-model=searchStr]"),b={activity_code:i.activity_code,activity_id:i.activity_id,contract_id:i.contract_id,activity_date:d("amParse")(i.activity_date,"YYYY-MM-DD").format("DD.MM.YYYY"),activity_text:i.activity_text,activitydata_id:i.activitydata_id,info:i.info,patient_id:i.patient_id};h.patient.activityForm=b})})}]),angular.module("frontendApp").directive("masterSelectStatus",["$http","config",function(a,b){return{template:'<select class="form-control" ng-model="data.status" ng-change="sendChange()" style="width:100px;">                            <option value="">alle</option>                            <option value="C" selected>offen</option>                            <option value="F">freigegeben</option>                            <option value="S">an Krankenkasse übertragen</option>                            <option value="E">fehlerhafte Daten</option>                            <option value="P">abgerechnet</option>                        </select>',restrict:"E",scope:{data:"="},replace:!0,transclude:!0,link:function(c,d,e){c.sendChange=function(){a.put(b.apiBase+"/de/api/index/updateStatus",{activityDataId:c.data.activitydata_id,status:c.data.status})}}}}]),angular.module("frontendApp").run(["$templateCache",function(a){"use strict";a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/accounting.html",'<form name="activityForm" ng-submit="submit2()" autocomplete="off"> <div class="row"> <div class="col-md-12"> <fieldset> <legend>Datenfilter</legend> <table class="table accountingTable"> <tr> <td> <div class="form-group"><label>Abrechnungsjahr</label> <select class="form-control" ng-model="accountingCtrl.dafilter.year"> <option value=""></option> <option value="{{::year}}" ng-repeat="year in years">{{::year}}</option> </select> </div> </td> <td> <div class="form-group"><label>Quartal</label> <select class="form-control" ng-model="accountingCtrl.dafilter.quartal"> <option value=""></option> <option value="1">1. Quartal</option> <option value="2">2. Quartal</option> <option value="3">3. Quartal</option> <option value="4">4. Quartal</option> </select> </div> </td> <td> <div class="form-group"><label style="white-space: nowrap">Zeitraum von ...</label> <input type="text" datepicker datepicker-options="datepickerOptions.from" name="timeRangeFrom" ng-model="accountingCtrl.dafilter.timeRangeFrom" placeholder="TT.MM.JJJJ" class="form-control"> </div> </td> <td> <div class="form-group"><label>Zeitraum bis …</label> <input type="text" datepicker datepicker-options="datepickerOptions.to" name="timeRangeTo" ng-model="accountingCtrl.dafilter.timeRangeTo" placeholder="TT.MM.JJJJ" class="form-control"> </div> </td> </tr> </table> </fieldset> <h3 style="margin-top: 0px">Leistungen</h3> <div class="row"> <div class="col-md-12"> <input type="submit" style="padding:6px" class="btn btn-primary pull-right" value="Leistungen jetzt senden"> </div> </div> <table class="table table-hover accountingTable" st-table="saveData" st-safe-src="accountingCtrl.accountingData"> <thead> <tr> <th>#</th> <th st-sort="lastname" st-sort-default="true">Name</th> <th st-sort="activity_code">Ziffer</th> <th st-sort="activity_text">Leistung</th> <th st-sort="activity_date">Datum</th> <th st-sort="price">Euro</th> <th st-sort="status">Status</th> </tr> <tr> <th>&nbsp;</th> <th><input type="text" class="form-control" placeholder="Nachname ..." st-search="lastname"></th> <th> <select st-search="activity_code" st-input-event="change" class="form-control"> <option value="">alle</option> <option ng-repeat="row in accountingCtrl.accountingData | unique:\'activity_code\'" value="{{row.activity_code}}">{{row.activity_code}}</option> </select> </th> <th colspan="3"> <input type="text" class="form-control" placeholder="Leistung ..." st-search="activity_text"> </th> <th> <select st-search="status" class="form-control" st-input-event="change" style="width:100px"> <option value="">alle</option> <option value="C" selected>offen</option> <option value="F">freigegeben</option> <option value="S">an Krankenkasse übertragen</option> <option value="E">fehlerhafte Daten</option> <option value="P">abgerechnet</option> </select> </th> </tr> </thead> <tbody> <tr ng-repeat="acc in saveData | accFilter:accountingCtrl.dafilter"> <td><input type="checkbox" ng-init="accountingCtrl.activityCheck[acc.activitydata_id] = acc.activitydata_id" ng-disabled="::acc.can_send === \'j\'" ng-checked="::acc.can_send === \'n\'" ng-model="accountingCtrl.activityCheck[acc.activitydata_id]" ng-true-value="\'{{::acc.activitydata_id}}\'" value="{{::acc.activitydata_id}}" ng-false-value="\'0\'"></td> <td>{{::acc.lastname}}, {{::acc.firstname}}</td> <td>{{::acc.activity_code}}</td> <td>{{::acc.activity_text}}</td> <td>{{::acc.activity_date | amParse:\'YYYY-MM-DD\' | amDateFormat:\'DD.MM.YYYY\'}}</td> <td class="text-nowrap">{{::acc.price | number:2}} &euro;</td> <td class="text-right" ng-if="!accountingCtrl.userData.isMaster">{{accountingCtrl.getStatusText(acc.status)}}</td> <td class="text-right" ng-if="accountingCtrl.userData.isMaster"><master-select-status data="acc"></master-select-status></td> </tr> </tbody> </table> </div> </div> <div class="row"> <div class="col-md-12"> <input type="submit" style="padding:6px" class="btn btn-primary pull-right" value="Leistungen jetzt senden"> </div> </div> </form>'),a.put("views/activityDataForm.html",'<form name="activityForm" ng-submit="acti.submit()" ng-init="acti.init(patient)" ng-controller="ActivityCtrl as acti" autocomplete="off"> <div class="row"> <div class="form-group col-xs-2 diagnosecode"><label>Gebührenziffer</label> <angucomplete-alt id="activity_code{{::patient.patient_id}}" placeholder="Gebührenziffer" pause="400" input-name="activity_code" initial-value="acti.initialValue" selected-object="acti.activity_code_selected_obj" remote-url="/de/api/index/activity/contract/{{patient.diagnoseFormData.contract_id}}/activityId/0/patientId/{{::patient.activityForm.patient_id}}/find?s=" minlength="0" input-changed="patient.autocompleteactivityCodeChange" description-field="activity_text" title-field="activity_code" template-url="views/autocom.html" input-class="form-control form-control"> </div> <div class="form-group col-xs-3"><label>Datum</label> <input type="text" tabindex="{{$index}}2" name="activity_date" required datepicker ng-model="patient.activityForm.activity_date" placeholder="Datum" class="form-control"> </div> <div class="form-group col-xs-7"><label>Text</label> <input type="text" name="activity_text" tabindex="{{$index}}3" readonly ng-model="acti.activity_code_selected_obj.description" placeholder="Leistungstext" class="form-control"> </div> </div> <div class="row"> <div class="form-group col-xs-12"> <label>Hinweis</label> <textarea name="info" maxlength="70" ng-model="patient.activityForm.info" class="form-control"></textarea> </div> </div> <div style="height:30px"> <div class="pull-right"> <button type="submit" class="btn btn-primary" style="padding:6px 12px" role="button">Speichern</button> </div> </div> </form>'),a.put("views/asv/accounting.html",'<table ng-table-dynamic="tableParams with cols" show-filter="true" class="table table-bordered table-hover"> <tr ng-repeat="row in $data track by row.id"> <td ng-repeat="col in cols"> <div ng-switch="col.dataType"> <span ng-switch-when="boolean"> <div class="squaredOne"> <input type="checkbox" ng-change="changeCkeckbox(row)" ng-model="row[col.field]"> <label for="squaredOne"></label> </div> <!--<input type="checkbox" ng-model="row[col.field]"/> --> </span> <span ng-switch-when="price" class="td-span text-right">{{::row[col.field] | number:2}} &euro;</span> <span ng-switch-when="date" class="td-span">{{::row[col.field] | date:\'dd.MM.yyyy HH:mm:ss\'}}</span> <span ng-switch-when="asvDataLink" class="td-span"><a href="#" ng-click="downloadAsvData(row)">{{::row[col.field]}}</a></span> <span ng-switch-when="pdf" class="td-span"><a href="#" ng-click="downloadAsvPdf(row)">PDF</a></span> <span ng-switch-when="sendCancellation" class="td-span"><a ng-if="row.sum !== 0 && row.cancellation === false" href="#" ng-click="sendCancellation(row)">Storno-Senden</a></span> <span ng-switch-default>{{::row[col.field]}}</span> </div> </td> </tr> </table>'),a.put("views/asv/asv-login.html",'<div class="login-container"> <h3>ASV Login</h3> <div ng-show="error" class="alert alert-danger">{{error}}</div> <form name="form" ng-submit="login()" role="form" autocomplete="off"> <div class="form-group"> <i class="fa fa-key"></i> <input type="email" name="username" placeholder="E-Mail Adresse" id="username" class="form-control" ng-model="username" required> <span ng-show="form.username.$dirty && form.username.$error.required" class="help-block">Benutzername(E-Mail) ist Pflicht</span> </div> <div class="form-group"> <i class="fa fa-lock"></i> <input type="password" name="password" placeholder="Passwort" id="password" class="form-control" ng-model="password" required> <span ng-show="form.password.$dirty && form.password.$error.required" class="help-block">Passwort ist Pflicht</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || dataLoading" class="btn btn-danger btn-default">Login</button> <img ng-if="dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> <div class="form-actions text-center" ng-if="isAsvExample"> <br><br>Sie möchten eine ASV-Abrechnung testen?<br>Dann registrieren Sie sich einfach.<br>Auch wenn Sie noch kein ASV-Team Mitglied sind!<br><br> <a style="padding:12px" href="/asv/test-registry" class="btn btn-block btn-default">zur Registrierung</a> </div> </form> </div>'),a.put("views/asv/consultancycontract.html",'<div> <div class="cc_container"> <p> Hat Ihr ASV-Team bereits einen Beratungsvertrag mit der Sanakey Consult GmbH abgeschlossen? </p> <div class="ask_box"> <a ng-href="/asv/login" class="btn btn-default btn-lg">ja</a> <a ng-href="/asv/contactform" class="btn btn-default btn-lg">nein</a> <div class="clear_both"></div> </div> </div> </div>'),a.put("views/asv/contactform.html",'<div> <div class="cc_container"> <p> Sie möchten gerne das Abrechnungsportal nutzen um Ihre ASV Leistungen abzurechnen? Dann füllen Sie bitte das folgende Kontaktformular aus. Wir werden uns umgehend mit Ihnen in Verbindung setzen. </p> <div class="ask_box"> <a href="https://www.sanakey-contract.de/?page_id=81" class="btn btn-default btn-lg">zum Kontaktformular</a> </div> </div> </div>'),a.put("views/asv/errorDecrypt.html",'<div class="jumbotron"> <wizard on-finish="finishedWizard()" class="asv-wizard" ng-init="_init()"> <wz-step wz-title="Zertifikat auswählen"> <div class="asv-wizard-content"> <h3 class="alert alert-info">Bitte wählen Sie ihren Zertifikat aus. *.pfx,*.p12</h3> <div class="row marketing"> <div ng-show="certError" class="alert alert-danger">{{certError}}</div> <div class="col-xs-12 text-center"> <button class="btn btn-primary" style="position:relative;z-index:10">Datei auswählen</button> <input ng-if="!certData" name="zert" type="file" size="50" style="position: absolute;left: 32%;top: -22%;width: 300px;height: 89px;opacity: 0;cursor: pointer;z-index:11" ng-model="certUpload" encoding="x-user-defined" on-read-file="reader" on-read-loaded="certLoaded" accept=".pfx,.p12"> </div> </div> </div> </wz-step> <wz-step wz-title="Passwort eingeben"> <div class="asv-wizard-content"> <form ng-submit="setCertPwd()" ng-if="certData" style="display:inline-block;width:100%" autocomplete="off"> <h3 class="alert alert-info">Bitte Zertifikat - Passwort eingeben</h3> <div class="form-group col-xs-12"> <input type="password" name="certPwd" required ng-model="certPwd" placeholder="Passwort" class="form-control"><br> </div> <div class="form-group col-xs-12"> <input type="submit" class="btn btn-primary" value="Passwort senden"> </div> </form> </div> </wz-step> <wz-step wz-title="Fehlerdatei laden"> <div class="asv-wizard-content"> <h3 class="alert alert-info">Bitte nun die zu entschlüsselnde Datei auswählen</h3> <div class="row marketing" ng-if="certData && !certError"> <div class="col-xs-12 text-center"> <button class="btn btn-primary" style="position:relative;z-index:10">Datei auswählen</button> <input ng-if="certData" name="errorFile" type="file" style="position: absolute;left: 32%;top: -22%;width: 300px;height: 89px;opacity: 0;cursor: pointer;z-index:11" size="50" on-read-file="reader" on-read-loaded="errorFileLoaded" accept="*"> </div> </div> </div> </wz-step> <wz-step wz-title="Anzeige Fehlerdaten"> <div class="asv-wizard-content text-left"> <pre ng-if="decyptData">\n                {{decyptData}}\n                </pre> </div> </wz-step> </wizard> </div>'),a.put("views/asv/kvdttoasv.html",'<div class="jumbotron"> <wizard on-finish="finishedWizard()" class="asv-wizard" ng-init="_init()"> <wz-step wz-title="KVDT - Upload" wz-disabled="{{docCirrusData}}"> <div class="asv-wizard-content"> <h3 class="alert alert-info">Bitte wählen Sie ihren KVDT Datensatz aus. (*).con</h3> <div class="row marketing"> <div class="col-xs-12 text-center"> <button class="btn btn-primary" style="position:relative;z-index:10">Datei auswählen</button> <input name="kvdt" type="file" style="position: absolute;left: 32%;top: -22%;width: 300px;height: 89px;opacity: 0;cursor: pointer;z-index:11" size="50" encoding="iso-8859-15" on-read-file="reader" on-read-loaded="kvdtLoaded" accept=".con"> </div> </div> </div> </wz-step> <wz-step wz-title="Verarbeitung"> <div class="asv-wizard-content"> <h3 class="alert alert-info">KVDT - Daten werden analysiert und verarbeitet</h3> <div class="text-center"><img src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="></div> </div> </wz-step> <wz-step wz-title="ASV - Daten"> <div class="asv-wizard-content"> <div class="row alert alert-info" ng-if="dataReady"> <div class="col-xs-6 text-left"> <div class="row"> <div class="col-xs-10" style="white-space: nowrap">gefundenen Leistungen :</div> <div class="col-xs-2">{{cntLeistungen}}</div> </div> <div class="row"> <div class="col-xs-10" style="white-space: nowrap">gefundenen ASV-Leistungen :</div> <div class="col-xs-2">{{cntAsvLeistungen}}</div> </div> </div> <div class="col-xs-6 text-left"> <div class="row"> <div class="col-xs-10" style="white-space: nowrap">gefundenen Patienten :</div> <div class="col-xs-2">{{cntPatienten}}</div> </div> <div class="row"> <div class="col-xs-10" style="white-space: nowrap">gefundenen ASV-Patienten :</div> <div class="col-xs-2">{{cntAsvPatienten}}</div> </div> </div> </div> <br> <div class="row _checkbox" ng-if="dataReady"> <div ng-if="cntAsvLeistungen"> <h4 class="col-md-12 text-center">Es wurden folgende Krankenkassen gefunden</h4> <div title="{{::value}}" class="wrapper col-md-4" ng-repeat="(key, value) in findAllKK"> <div class="squaredTwo"> <input type="checkbox" checklist-model="checkedSendKK" checklist-value="key"> <label for="squaredTwo"></label> </div> </div> </div> <div class="col-xs-12 animate-switch-container" style="margin-bottom:25px;position:relative" ng-if="!cntAsvLeistungen"> <round-progress ng-if="analyseDataStep > 2" max="max" current="current" color="#45ccce" bgcolor="#e6e6e6" radius="100" stroke="20" semi="false" rounded="true" clockwise="false" responsive="false" duration="800" animation="easeInOutQuart" animation-delay="0"> </round-progress> <div ng-switch on="analyseDataStep"> <div class="animate-switch" ng-switch-when="3">Daten werden gesammelt</div> <div class="animate-switch" ng-switch-when="4" style="font-size: 38px; line-height: 32px; font-weight: bold;color: #a4a4a4"><span style="font-size: 19px">ASV Vergütung</span><br><span count-to="{{calculateASVPrice}}" value="0" duration="1"></span>&nbsp;&euro;</div> <div class="animate-switch form-group" ng-switch-when="2"> <label>Erkrankungs- und Leistungsbereichs-Schlüssel</label> <select ng-model="asvType" class="form-control" ng-change="analyseData(asvType)"> <option value="">Bitte wählen</option> <option value="1A0100">1A0100 - onko. Tumorgruppe 1: gastrointestinale Tumoren und Tumoren der Bauchhöhle</option> <option value="1A0200">1A0200 - onko. Tumorgruppe 2: gynäkologische Tumoren (ohne Subspezialisierung)</option> <option value="1A0201">1A0201 - onko. Tumorgruppe 2: gynäkologische Tumoren (Subspezialisierung Mammakarzinom)</option> <option value="1A0201">1A0202 - onko. Tumorgruppe 2: gynäkologische Tumoren (Subspezialisierung andere gynäkologische Tumoren)</option> <option value="1A0201">2A0100 - Tuberkulose und atypische Mykobakteriose</option> <option value="1A0201">2K0100 - Marfan-Syndrom</option> <option value="2L0100">2L0100 - Pulmonale Hypertonie</option> </select> </div> <button class="btn btn-default animate-switch" ng-click="analyseData()" ng-switch-when="1">Auf ASV-Leitungen jetzt prüfen</button> </div> </div> <div class="col-xs-12" class="text-center"> <button class="btn btn-lg btn-success" ng-click="createCsvData()">Leistungsübersicht&nbsp;<span class="glyphicon glyphicon-save"></span></button> <!--<a class="btn btn-lg btn-success"  ng-href="#" ng-click="cryptASV()">ASV-Crypt<span class="glyphicon glyphicon-ok"></span></a>--> </div> </div> <div class="row" style="margin-top:20px" ng-if="cntAsvLeistungen"> <div class="col-xs-12"> <input type="submit" class="btn btn-primary" wz-next value="ASV-Daten jetzt verschlüsseln und an die Krankenkasse übertragen"> </div> </div> </div> </wz-step> <wz-step wz-title="Verschlüsseln"> <div class="asv-wizard-content"> <h3 ng-if="!certData" class="alert alert-info">Bitte laden Sie nun ihr Zertifikat</h3> <h3 ng-if="certData" class="alert alert-info">Bitte geben Sie ihr Zertifikat-Passwort ein.</h3> <div class="row marketing"> <div class="col-xs-12 text-center"> <div ng-show="certError" class="alert alert-danger">{{certError}}</div> <input ng-if="!certData" name="zert" type="file" size="50" ng-model="certUpload" encoding="x-user-defined" on-read-file="reader" on-read-loaded="certLoaded" accept=".pfx,.p12"> <form ng-submit="setCertPwd()" ng-if="certData" autocomplete="off"> <div class="form-group col-xs-12"><label>Zertifikat - Passwort</label> <input type="password" name="certPwd" required ng-model="certPwd" placeholder="Passwort" class="form-control"><br> </div> <div class="form-group col-xs-6"> <input type="submit" class="btn btn-primary" value="Passwort senden"> </div> <div class="form-group col-xs-6"> <button class="btn btn-default" ng-click="resetCert()">Zertifikat zurücksetzen</button> </div> </form> </div> </div> </div> </wz-step> <wz-step wz-title="Versand"> <div class="asv-wizard-content"> <h3 class="alert" ng-class="sendStatusClass">{{sendStatus}}</h3> <div class="row text-left"> <div class="col-xs-6" ng-repeat="sendSt in sendRes"><a class="btn-sm {{sendSt.class}}" style="display:inline-block;width:100%;margin-bottom:8px">{{sendSt.nutzerDaten.kasse}} {{sendSt.message}}</a></div> </div> <!--<button class="btn btn-lg btn-success" ng-click="cryptASV()">ASV-Download<span class="glyphicon glyphicon-ok"></span></button>--> </div> </wz-step> <wz-step wz-title="Fertig"> <div class="asv-wizard-content"> <h3 class="alert alert-info">Datenverarbeitung und Datenversand abgeschlossen</h3> <div class="row marketing"> <div class="row text-left"> <div class="col-xs-6" ng-repeat="sendSt in sendRes"><a href="#" ng-click="downloadASV(sendSt.sendKK)" class="btn-sm {{sendSt.class}}" style="display:inline-block;width:100%;margin-bottom:8px">{{sendSt.nutzerDaten.kasse}} {{sendSt.message}}<i class="glyphicon glyphicon-download-alt pull-right"></i></a></div> </div> <div class="form-group col-xs-12" ng-if="!docCirrusData"> <button type="submit" class="btn btn-primary" ng-click="startWizart()">Weitere Daten verarbeiten</button> </div> <div class="form-group col-xs-12" ng-if="docCirrusData"> <button type="submit" class="btn btn-primary" ng-click="backToDocCirus()">Zurück zu Doc Cirrus inSuite</button> </div> </div> </div> </wz-step> </wizard> </div>'),
a.put("views/asv/sendStornoDialog.html",'<h4>Möchten Sie die Daten als Storno versenden?</h4> <div class="row"> <div class="col-md-12"> <div class="form-group"><label>Zertifikat-Passwort</label> <input type="password" ng-model="asvAccCtrl.certPass" class="form-control"> </div> </div> </div> <div class="ngdialog-buttons"> <button type="button" class="btn btn-default pull-right" style="margin-left:10px" ng-click="closeThisDialog(0)">Abbrechen</button> <button type="button" class="btn btn-primary pull-right" ng-disabled="!asvAccCtrl.certPass" ng-click="confirm(1)">Jetzt senden</button> </div>'),a.put("views/asv/test-registry.html",'<h3 class="text-center">Registrierung für ASV-Testzugang</h3> <form ng-submit="submit()" name="userForm" autocomplete="off"> <ng-include src="\'views/user-person.html\'"></ng-include> <div class="row"> <div class="col-sm-6"> <ng-include src="\'views/user-address.html\'"></ng-include> </div> <div class="col-sm-6"> <ng-include src="\'views/user-contact.html\'"></ng-include> </div> </div> <div class="row"> <div class="col-md-12"> <button type="submit" class="btn btn-primary pull-right" style="padding:12px">Registrierung jetzt senden</button> </div> </div> </form>'),a.put("views/autocom.html",'<div class="angucomplete-holder" ng-class="{\'angucomplete-dropdown-visible\': showDropdown}"> <input id="{{id}}_value" name="{{inputName}}" ng-class="{\'angucomplete-input-not-empty\': notEmpty}" ng-model="searchStr" ng-disabled="disableInput" type="{{inputType}}" placeholder="{{placeholder}}" maxlength="{{maxlength}}" ng-focus="onFocusHandler()" required class="{{inputClass}}" ng-focus="resetHideResults()" ng-blur="hideResults($event)" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="inputChangeHandler(searchStr)"> <div id="{{id}}_dropdown" class="angucomplete-dropdown" ng-show="showDropdown"> <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching"></div> <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div> <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'angucomplete-selected-row\': $index === currentIndex}"> <div ng-if="imageField" class="angucomplete-image-holder"> <img ng-if="result.image && result.image !== \'\'" ng-src="{{result.image}}" class="angucomplete-image"> <div ng-if="!result.image && result.image !== \'\'" class="angucomplete-image-default"></div> </div> <div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div> <div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div> <div ng-if="matchClass && result.description && result.description !== \'\'" class="angucomplete-description" ng-bind-html="result.description"></div> <div ng-if="!matchClass && result.description && result.description !== \'\'" class="angucomplete-description">{{result.description}}</div> </div> </div> </div>'),a.put("views/bussi.html",'<script src="scripts/services/tween-max.js"></script> <div ng-controller="MainCtrl"> <div ng-click="clickMe()" style="position: absolute;\r\n  top: 42px;\r\n  left: 420px;\r\n  z-index: 10000; cursor: pointer;\r\n  font-size: xx-large">!KLICK MICH und warte ....!</div> <div class="kiss-me" style="width: 460px; height: 345px; z-index: 10000; position: absolute; top: 26px; right: 0px" ng-if="showMe"> <svg version="1.1" id="Layer_1" x="0px" y="0px" width="100%" height="100%" style="text-align: center; stroke-width: 1px; stroke: #000; fill:#121418"> <path id="template" d="M 131.26,0.60\r\n           C 132.75,-0.07 135.36,0.01 137.00,0.00\r\n             140.65,-0.02 156.45,-0.41 158.79,0.60\r\n             162.13,2.04 163.08,6.93 165.79,6.38\r\n             168.09,5.91 167.94,1.71 168.00,0.00\r\n             180.94,0.42 173.63,10.98 178.00,22.00\r\n             178.00,22.00 181.54,10.83 181.54,10.83\r\n             181.54,10.83 183.90,1.74 183.90,1.74\r\n             183.90,1.74 191.00,0.00 191.00,0.00\r\n             191.00,0.00 209.00,0.00 209.00,0.00\r\n             209.00,0.00 218.78,0.74 218.78,0.74\r\n             218.78,0.74 222.00,4.00 222.00,4.00\r\n             222.00,4.00 228.91,0.44 228.91,0.44\r\n             228.91,0.44 234.51,2.63 234.51,2.63\r\n             234.51,2.63 242.00,4.00 242.00,4.00\r\n             242.00,4.00 241.00,11.00 241.00,11.00\r\n             241.00,11.00 248.00,7.00 248.00,7.00\r\n             250.71,15.92 255.26,11.07 259.43,13.99\r\n             261.75,15.62 261.82,18.47 262.00,21.00\r\n             270.09,19.97 267.00,25.01 270.57,28.50\r\n             273.10,30.97 276.10,29.41 279.61,32.57\r\n             282.72,35.38 283.67,40.69 288.04,43.13\r\n             290.39,44.44 293.34,44.11 295.96,44.44\r\n             295.96,44.44 308.00,46.26 308.00,46.26\r\n             308.00,46.26 316.00,46.26 316.00,46.26\r\n             316.00,46.26 329.83,49.47 329.83,49.47\r\n             329.83,49.47 347.04,60.96 347.04,60.96\r\n             350.01,62.28 352.00,60.98 355.00,61.79\r\n             357.88,62.57 362.42,66.18 365.00,68.00\r\n             365.00,68.00 362.00,78.00 362.00,78.00\r\n             365.76,76.36 368.85,74.80 372.96,76.40\r\n             376.18,77.65 377.69,80.38 381.00,81.00\r\n             381.00,81.00 387.64,90.16 387.64,90.16\r\n             387.64,90.16 393.59,105.00 393.59,105.00\r\n             393.59,105.00 401.09,121.00 401.09,121.00\r\n             401.09,121.00 403.00,131.00 403.00,131.00\r\n             403.00,131.00 409.00,132.00 409.00,132.00\r\n             409.00,132.00 409.81,138.01 409.81,138.01\r\n             411.53,151.97 413.23,157.15 421.73,169.00\r\n             421.73,169.00 429.45,177.80 429.45,177.80\r\n             433.59,183.11 437.29,192.29 436.00,199.00\r\n             436.00,199.00 430.00,196.00 430.00,196.00\r\n             430.00,196.00 433.00,200.00 433.00,200.00\r\n             431.87,208.05 431.43,213.15 442.00,214.00\r\n             442.00,214.00 440.98,226.95 440.98,226.95\r\n             440.98,226.95 433.00,236.00 433.00,236.00\r\n             433.00,236.00 443.53,236.86 443.53,236.86\r\n             450.86,240.22 450.04,254.33 450.00,261.00\r\n             449.92,273.43 444.06,267.81 436.83,265.44\r\n             436.83,265.44 420.00,260.38 420.00,260.38\r\n             415.86,258.64 408.86,254.52 405.00,254.00\r\n             405.00,254.00 379.00,237.00 379.00,237.00\r\n             379.00,237.00 395.00,230.00 395.00,230.00\r\n             395.00,230.00 384.99,228.13 384.99,228.13\r\n             384.99,228.13 377.00,228.13 377.00,228.13\r\n             369.36,228.00 365.93,227.17 358.71,225.69\r\n             353.99,224.72 347.53,220.92 353.00,216.00\r\n             352.77,210.95 354.36,209.20 356.95,205.04\r\n             358.35,202.78 360.65,199.35 362.61,197.60\r\n             362.61,197.60 386.00,185.13 386.00,185.13\r\n             389.21,183.59 391.12,183.34 394.00,181.00\r\n             394.00,181.00 403.00,180.00 403.00,180.00\r\n             403.00,180.00 399.00,177.00 399.00,177.00\r\n             399.00,177.00 399.00,179.00 399.00,179.00\r\n             392.83,178.00 390.58,179.60 384.97,181.68\r\n             374.39,185.60 365.31,191.85 355.58,197.32\r\n             350.68,200.07 347.09,199.94 342.00,201.44\r\n             333.28,204.00 334.03,205.11 324.00,206.00\r\n             324.84,197.94 332.18,185.70 337.33,179.51\r\n             340.39,175.84 346.10,170.67 348.00,167.00\r\n             345.50,167.35 344.26,167.45 342.04,168.89\r\n             338.83,170.97 326.95,186.10 325.21,190.01\r\n             323.13,194.68 321.40,202.38 316.89,205.33\r\n             314.45,206.93 310.84,206.60 308.00,206.62\r\n             297.78,206.71 297.87,205.69 290.84,199.28\r\n             288.70,197.33 286.08,195.70 284.88,192.95\r\n             284.05,191.02 284.09,186.27 284.00,184.00\r\n             278.54,186.15 274.04,189.14 268.00,186.58\r\n             268.00,186.58 261.29,182.51 261.29,182.51\r\n             257.53,180.46 255.88,180.51 253.82,175.99\r\n             251.36,170.62 252.88,165.58 253.00,160.00\r\n             246.98,162.21 246.60,162.73 240.00,162.58\r\n             236.19,162.49 230.39,162.02 227.26,159.69\r\n             225.51,158.39 224.73,156.83 223.49,154.96\r\n             218.65,145.51 220.96,140.58 223.49,131.00\r\n             223.49,131.00 224.56,123.17 224.56,123.17\r\n             225.54,120.35 228.03,118.71 230.31,112.00\r\n             231.43,108.69 234.56,97.48 232.85,94.54\r\n             232.16,93.34 231.59,93.42 231.00,93.00\r\n             231.09,99.27 228.10,102.66 225.55,108.01\r\n             225.55,108.01 218.03,128.00 218.03,128.00\r\n             216.63,132.43 216.20,138.25 212.66,141.43\r\n             206.13,147.28 201.45,142.81 196.00,139.74\r\n             193.17,138.14 190.23,137.91 188.73,134.79\r\n             186.11,130.62 188.81,126.57 188.73,123.00\r\n             189.38,119.12 187.44,117.43 188.73,111.00\r\n             189.99,103.66 193.53,99.61 194.00,91.00\r\n             194.00,91.00 190.38,95.58 190.38,95.58\r\n             190.38,95.58 181.97,119.00 181.97,119.00\r\n             181.97,119.00 176.00,131.00 176.00,131.00\r\n             169.61,133.63 168.91,132.53 163.00,129.42\r\n             144.10,119.47 151.00,103.37 151.00,86.00\r\n             145.69,89.29 146.28,95.37 141.99,95.37\r\n             136.41,95.37 134.46,83.13 134.07,79.00\r\n             132.57,63.06 128.65,60.60 123.15,47.00\r\n             120.60,40.68 120.42,35.51 115.00,31.00\r\n             114.16,39.24 119.42,46.74 122.69,54.00\r\n             128.17,66.19 131.61,80.04 124.00,92.00\r\n             116.74,89.92 117.71,88.16 113.45,83.18\r\n             113.45,83.18 108.82,78.49 108.82,78.49\r\n             105.88,74.55 103.88,65.72 105.00,61.00\r\n             101.11,61.95 97.44,65.50 98.70,69.91\r\n             99.47,72.59 102.23,73.84 103.75,77.04\r\n             103.75,77.04 105.03,81.00 105.03,81.00\r\n             106.05,83.58 111.23,92.88 113.00,95.00\r\n             112.43,96.69 112.01,98.69 110.48,99.81\r\n             106.16,102.99 95.78,98.27 92.18,95.43\r\n             87.63,91.83 87.08,88.06 85.15,87.68\r\n             82.46,87.16 81.63,91.46 75.42,90.90\r\n             68.61,90.28 58.83,84.07 52.00,81.46\r\n             46.31,79.28 44.98,80.02 40.00,78.75\r\n             40.00,78.75 24.00,73.06 24.00,73.06\r\n             19.59,71.35 3.21,65.02 1.02,61.61\r\n             -1.33,57.95 0.66,53.50 4.06,51.42\r\n             9.22,48.25 14.24,50.01 17.23,48.64\r\n             17.23,48.64 23.61,44.18 23.61,44.18\r\n             23.61,44.18 32.00,40.48 32.00,40.48\r\n             34.97,38.78 39.53,35.60 43.00,35.48\r\n             46.93,35.35 53.22,41.60 57.00,44.00\r\n             55.81,36.71 51.38,31.67 53.12,28.28\r\n             55.05,24.53 59.90,26.25 61.96,25.82\r\n             65.75,25.04 66.74,21.13 68.00,18.00\r\n             75.75,21.88 74.16,27.30 80.05,31.11\r\n             86.16,35.05 90.68,29.75 89.00,22.00\r\n             89.00,22.00 83.00,28.00 83.00,28.00\r\n             83.00,28.00 79.00,28.00 79.00,28.00\r\n             79.00,28.00 76.00,12.00 76.00,12.00\r\n             78.92,12.72 81.97,13.35 85.00,13.05\r\n             93.75,12.17 99.41,3.96 110.00,3.00\r\n             111.23,9.08 112.49,14.48 117.00,19.00\r\n             118.07,10.92 118.48,11.27 117.00,3.00\r\n             122.12,1.34 123.03,2.73 127.00,6.00\r\n             128.08,3.93 128.99,1.62 131.26,0.60 Z\r\n           M 144.60,14.29\r\n           C 139.69,20.43 148.81,25.02 148.59,16.00\r\n             148.59,16.00 148.00,12.00 148.00,12.00\r\n             146.56,12.74 145.72,12.89 144.60,14.29 Z\r\n           M 317.00,11.00\r\n           C 317.00,11.00 316.00,12.00 316.00,12.00\r\n             316.00,12.00 316.00,11.00 316.00,11.00\r\n             316.00,11.00 317.00,11.00 317.00,11.00 Z\r\n           M 312.00,12.00\r\n           C 312.00,12.00 311.00,13.00 311.00,13.00\r\n             311.00,13.00 311.00,12.00 311.00,12.00\r\n             311.00,12.00 312.00,12.00 312.00,12.00 Z\r\n           M 229.00,15.00\r\n           C 229.00,15.00 222.00,49.00 222.00,49.00\r\n             225.67,46.61 225.79,43.97 227.02,40.00\r\n             228.94,33.83 232.61,21.15 232.00,15.00\r\n             232.00,15.00 229.00,15.00 229.00,15.00 Z\r\n           M 163.00,20.00\r\n           C 157.26,34.92 152.05,58.08 152.00,74.00\r\n             156.23,70.76 156.41,63.92 157.40,59.00\r\n             157.40,59.00 160.72,45.00 160.72,45.00\r\n             160.72,45.00 163.09,30.00 163.09,30.00\r\n             163.09,30.00 165.00,20.00 165.00,20.00\r\n             165.00,20.00 163.00,20.00 163.00,20.00 Z\r\n           M 317.00,37.00\r\n           C 317.00,37.00 316.00,38.00 316.00,38.00\r\n             316.00,38.00 316.00,37.00 316.00,37.00\r\n             316.00,37.00 317.00,37.00 317.00,37.00 Z\r\n           M 401.00,40.00\r\n           C 401.00,40.00 400.00,41.00 400.00,41.00\r\n             400.00,41.00 400.00,40.00 400.00,40.00\r\n             400.00,40.00 401.00,40.00 401.00,40.00 Z\r\n           M 182.44,62.59\r\n           C 182.44,62.59 168.00,99.00 168.00,99.00\r\n             174.65,93.96 176.66,88.23 179.60,80.83\r\n             182.68,73.11 189.82,51.67 191.00,44.00\r\n             191.00,44.00 182.44,62.59 182.44,62.59 Z\r\n           M 350.00,44.00\r\n           C 350.00,44.00 349.00,45.00 349.00,45.00\r\n             349.00,45.00 349.00,44.00 349.00,44.00\r\n             349.00,44.00 350.00,44.00 350.00,44.00 Z\r\n           M 239.00,48.00\r\n           C 235.73,53.92 233.15,60.16 234.00,67.00\r\n             240.42,64.74 240.95,53.93 241.00,48.00\r\n             241.00,48.00 239.00,48.00 239.00,48.00 Z\r\n           M 70.13,61.82\r\n           C 68.49,60.36 64.13,56.41 61.82,58.74\r\n             59.84,60.74 63.85,64.39 65.18,65.58\r\n             65.18,65.58 83.00,79.00 83.00,79.00\r\n             82.34,70.69 76.01,67.02 70.13,61.82 Z\r\n           M 305.00,82.00\r\n           C 311.40,78.47 316.51,68.18 317.00,61.00\r\n             309.83,65.05 305.83,74.00 305.00,82.00 Z\r\n           M 268.00,63.00\r\n           C 264.33,70.16 262.12,78.04 261.00,86.00\r\n             266.34,82.66 268.98,70.05 271.00,64.00\r\n             271.00,64.00 268.00,63.00 268.00,63.00 Z\r\n           M 209.00,83.00\r\n           C 215.85,80.82 216.93,71.32 217.00,65.00\r\n             212.32,69.80 209.69,76.36 209.00,83.00 Z\r\n           M 23.00,79.44\r\n           C 27.86,81.93 35.77,89.39 41.00,91.47\r\n             45.72,93.35 51.00,90.04 56.99,93.17\r\n             61.33,95.44 62.83,99.90 66.30,101.10\r\n             66.30,101.10 77.00,101.10 77.00,101.10\r\n             79.83,101.37 96.65,106.00 98.83,107.30\r\n             98.83,107.30 112.36,118.13 112.36,118.13\r\n             114.75,121.10 116.66,127.70 121.73,131.19\r\n             124.45,133.05 127.83,132.75 133.00,135.98\r\n             133.00,135.98 151.00,150.02 151.00,150.02\r\n             154.37,152.36 161.46,156.73 161.97,161.03\r\n             162.45,165.06 158.51,169.10 156.21,172.01\r\n             151.13,178.41 146.31,185.06 142.00,192.00\r\n             148.33,187.74 155.37,180.97 160.11,174.99\r\n             162.16,172.41 165.65,166.68 169.18,166.39\r\n             173.72,166.01 182.98,174.57 183.11,179.01\r\n             183.22,182.54 180.52,188.27 182.11,190.54\r\n             184.10,193.38 187.65,189.46 189.00,188.00\r\n             198.64,191.91 196.57,194.91 202.24,200.39\r\n             205.78,203.81 211.55,205.56 216.00,207.80\r\n             219.27,209.46 221.90,211.76 225.72,211.18\r\n             227.40,210.92 227.98,210.35 230.09,210.36\r\n             230.09,210.36 253.99,214.77 253.99,214.77\r\n             257.66,214.48 270.99,208.58 276.00,214.77\r\n             276.00,214.77 289.83,216.99 289.83,216.99\r\n             289.83,216.99 295.08,220.89 295.08,220.89\r\n             295.08,220.89 300.26,224.30 300.26,224.30\r\n             300.26,224.30 304.00,234.00 304.00,234.00\r\n             304.93,231.66 306.95,225.35 308.70,223.96\r\n             313.97,219.75 328.63,227.49 330.18,232.18\r\n             331.05,234.04 330.11,239.57 330.18,242.00\r\n             330.18,242.00 334.91,241.07 334.91,241.07\r\n             337.38,240.94 338.93,242.33 340.49,241.07\r\n             342.43,239.66 342.24,232.78 349.04,232.86\r\n             355.84,232.94 361.33,239.22 367.00,241.70\r\n             369.97,243.00 373.84,242.41 380.00,245.70\r\n             389.59,250.84 397.05,258.69 405.56,265.31\r\n             409.37,268.27 419.28,276.11 420.98,280.07\r\n             421.90,282.23 421.77,284.70 422.00,287.00\r\n             422.00,287.00 407.83,297.45 407.83,297.45\r\n             407.83,297.45 399.00,300.53 399.00,300.53\r\n             399.00,300.53 390.00,305.00 390.00,305.00\r\n             389.32,303.70 388.73,302.35 387.75,301.23\r\n             382.08,294.71 379.00,306.99 379.00,311.00\r\n             373.90,314.93 372.50,317.09 365.84,319.00\r\n             365.84,319.00 365.84,301.00 365.84,301.00\r\n             365.84,301.00 365.10,290.00 365.10,290.00\r\n             365.10,290.00 367.00,266.00 367.00,266.00\r\n             361.78,271.48 362.81,278.95 362.09,286.00\r\n             361.48,291.99 360.15,295.37 358.41,300.99\r\n             356.78,306.27 356.88,308.85 352.00,312.00\r\n             352.89,315.66 354.53,323.70 349.85,325.54\r\n             344.45,327.67 340.65,318.84 339.18,315.00\r\n             334.91,301.79 342.72,291.57 339.18,278.00\r\n             339.18,278.00 337.00,278.00 337.00,278.00\r\n             337.00,278.00 335.32,289.17 335.32,289.17\r\n             335.32,289.17 328.03,311.08 328.03,311.08\r\n             328.03,311.08 318.00,323.00 318.00,323.00\r\n             322.98,323.83 325.97,327.75 323.02,332.55\r\n             322.15,333.96 320.22,334.86 319.00,336.00\r\n             319.00,336.00 307.00,335.00 307.00,335.00\r\n             307.00,335.00 307.00,316.00 307.00,316.00\r\n             307.00,316.00 304.00,317.00 304.00,317.00\r\n             304.34,320.35 303.90,332.20 301.32,334.45\r\n             299.59,335.96 297.43,335.29 295.00,335.98\r\n             290.95,337.12 285.77,343.15 285.06,334.98\r\n             284.06,323.50 287.41,320.30 291.39,311.00\r\n             295.29,301.87 298.77,292.72 300.94,283.00\r\n             302.32,276.87 304.67,269.98 302.00,264.00\r\n             302.00,264.00 297.29,278.00 297.29,278.00\r\n             297.29,278.00 293.20,289.00 293.20,289.00\r\n             288.73,303.48 286.96,312.72 277.86,325.83\r\n             271.87,334.46 275.47,334.89 271.00,338.00\r\n             271.05,339.64 271.39,340.98 270.17,342.40\r\n             267.01,346.08 252.58,343.98 249.51,340.61\r\n             245.63,336.35 248.59,332.49 243.00,327.00\r\n             242.23,331.23 241.41,333.13 239.60,337.00\r\n             236.19,344.25 233.99,345.27 226.00,343.00\r\n             226.00,343.00 226.00,341.00 226.00,341.00\r\n             226.00,341.00 229.00,340.00 229.00,340.00\r\n             229.00,340.00 226.00,333.00 226.00,333.00\r\n             223.94,335.69 221.79,340.11 218.89,341.49\r\n             214.16,343.73 211.19,341.57 207.00,340.35\r\n             200.67,338.51 194.55,341.32 193.00,332.00\r\n             191.45,332.60 188.49,334.04 187.00,334.19\r\n             180.41,334.84 178.45,327.82 173.91,325.14\r\n             170.00,322.82 164.89,323.61 162.99,321.26\r\n             162.20,320.28 161.48,315.66 161.00,314.00\r\n             160.48,315.48 160.34,316.32 159.37,317.66\r\n             153.65,325.58 150.68,313.72 151.83,309.00\r\n             151.83,309.00 159.22,293.00 159.22,293.00\r\n             159.22,293.00 164.46,279.00 164.46,279.00\r\n             166.64,273.76 167.57,274.09 168.00,268.00\r\n             158.24,279.63 149.46,297.18 146.00,312.00\r\n             142.16,311.99 138.49,312.23 135.13,309.99\r\n             129.75,306.42 130.56,301.66 122.00,302.00\r\n             120.76,298.05 117.01,297.11 118.33,289.00\r\n             118.33,289.00 127.15,266.00 127.15,266.00\r\n             129.74,261.05 132.19,261.31 132.00,255.00\r\n             123.35,260.36 119.93,271.98 112.83,278.70\r\n             107.49,283.75 103.34,285.35 97.67,279.87\r\n             95.91,278.16 95.23,277.07 94.00,275.00\r\n             100.54,270.89 97.88,270.26 99.91,264.00\r\n             99.91,264.00 105.70,251.00 105.70,251.00\r\n             110.88,240.55 122.23,233.64 125.00,222.00\r\n             125.00,222.00 106.79,244.00 106.79,244.00\r\n             106.79,244.00 88.00,266.00 88.00,266.00\r\n             83.53,263.67 74.15,251.35 75.27,246.04\r\n             76.22,241.53 84.78,235.00 87.35,230.83\r\n             89.33,227.62 88.54,225.94 91.03,222.00\r\n             91.03,222.00 99.94,210.58 99.94,210.58\r\n             99.94,210.58 113.00,192.00 113.00,192.00\r\n             109.45,193.23 107.02,194.41 104.09,196.84\r\n             99.91,200.32 85.03,219.80 81.63,225.00\r\n             79.12,228.83 76.74,240.78 70.92,240.43\r\n             68.07,240.26 65.51,236.10 64.00,234.00\r\n             64.00,234.00 50.36,215.09 50.36,215.09\r\n             48.69,212.96 44.31,208.81 43.80,206.71\r\n             42.67,203.94 44.49,201.53 43.80,196.00\r\n             43.80,196.00 38.00,200.00 38.00,200.00\r\n             33.27,193.71 33.30,191.20 36.00,184.00\r\n             36.00,184.00 30.00,184.00 30.00,184.00\r\n             31.71,176.00 38.08,174.12 44.00,169.47\r\n             49.50,165.16 50.80,162.89 54.00,157.00\r\n             51.46,158.08 50.20,158.74 48.00,160.48\r\n             41.43,165.65 25.14,183.19 20.00,166.00\r\n             20.00,166.00 28.00,160.00 28.00,160.00\r\n             24.70,159.42 23.88,159.13 21.00,161.00\r\n             14.01,158.28 17.37,152.06 20.17,147.00\r\n             27.55,133.67 34.49,132.59 42.00,117.00\r\n             34.18,119.67 33.28,123.91 28.10,129.34\r\n             28.10,129.34 21.22,135.61 21.22,135.61\r\n             17.48,139.35 17.61,142.71 13.90,143.23\r\n             8.40,144.01 7.96,138.93 7.42,135.00\r\n             6.37,127.26 7.58,126.38 11.22,120.00\r\n             13.49,116.02 12.89,115.56 17.00,113.00\r\n             17.00,113.00 17.00,111.00 17.00,111.00\r\n             7.34,107.09 1.74,96.00 0.15,86.00\r\n             0.15,86.00 0.15,74.00 0.15,74.00\r\n             7.21,74.74 16.46,76.08 23.00,79.44 Z\r\n           M 181.00,74.00\r\n           C 181.00,74.00 180.00,75.00 180.00,75.00\r\n             180.00,75.00 180.00,74.00 180.00,74.00\r\n             180.00,74.00 181.00,74.00 181.00,74.00 Z\r\n           M 208.00,103.00\r\n           C 208.00,103.00 201.33,124.00 201.33,124.00\r\n             201.03,125.72 200.52,130.62 202.52,131.51\r\n             205.52,132.86 206.49,127.32 206.82,125.58\r\n             208.29,117.73 210.92,111.25 210.00,103.00\r\n             210.00,103.00 208.00,103.00 208.00,103.00 Z\r\n           M 65.00,119.00\r\n           C 65.00,119.00 74.96,119.00 74.96,119.00\r\n             74.96,119.00 83.00,123.00 83.00,123.00\r\n             82.21,111.62 68.02,111.42 65.00,119.00 Z\r\n           M 290.00,138.96\r\n           C 285.41,147.68 276.65,161.85 275.00,171.00\r\n             281.06,169.99 282.62,166.27 285.11,161.00\r\n             285.11,161.00 299.75,130.99 299.75,130.99\r\n             300.59,128.69 300.75,127.39 301.00,125.00\r\n             294.33,128.23 293.23,132.82 290.00,138.96 Z\r\n           M 267.00,134.00\r\n           C 263.92,135.98 258.99,145.37 257.83,149.00\r\n             256.69,152.58 258.23,154.98 260.71,153.85\r\n             262.65,152.95 263.87,149.69 264.71,147.83\r\n             266.50,143.89 272.06,129.53 272.00,126.00\r\n             268.45,128.71 267.26,129.42 267.00,134.00 Z\r\n           M 90.00,149.00\r\n           C 93.62,147.29 105.01,138.24 105.30,134.17\r\n             105.41,132.52 104.72,132.14 104.00,131.00\r\n             97.39,136.68 93.08,140.61 90.00,149.00 Z\r\n           M 312.88,147.61\r\n           C 312.88,147.61 289.00,176.00 289.00,176.00\r\n             289.00,176.00 289.00,178.00 289.00,178.00\r\n             297.68,179.14 302.95,166.92 307.66,161.09\r\n             310.09,158.09 312.47,156.98 313.00,153.00\r\n             317.35,150.50 326.63,139.48 329.00,135.00\r\n             321.37,136.16 317.41,141.87 312.88,147.61 Z\r\n           M 325.00,157.00\r\n           C 333.54,154.22 344.49,144.80 347.00,136.00\r\n             339.78,138.06 328.63,150.44 325.00,157.00 Z\r\n           M 379.00,150.00\r\n           C 385.75,147.80 390.57,145.06 393.00,138.00\r\n             387.37,139.40 381.05,144.51 379.00,150.00 Z\r\n           M 196.00,146.00\r\n           C 196.00,146.00 195.00,147.00 195.00,147.00\r\n             195.00,147.00 195.00,146.00 195.00,146.00\r\n             195.00,146.00 196.00,146.00 196.00,146.00 Z\r\n           M 423.00,150.00\r\n           C 423.00,150.00 422.00,151.00 422.00,151.00\r\n             422.00,151.00 422.00,150.00 422.00,150.00\r\n             422.00,150.00 423.00,150.00 423.00,150.00 Z\r\n           M 324.00,157.00\r\n           C 324.00,157.00 325.00,158.00 325.00,158.00\r\n             325.00,158.00 325.00,157.00 325.00,157.00\r\n             325.00,157.00 324.00,157.00 324.00,157.00 Z\r\n           M 65.00,209.00\r\n           C 65.00,209.00 70.00,210.00 70.00,210.00\r\n             74.21,194.42 81.77,195.64 83.00,185.00\r\n             75.69,187.63 67.19,201.74 65.00,209.00 Z\r\n           M 258.00,206.00\r\n           C 258.00,206.00 257.00,207.00 257.00,207.00\r\n             257.00,207.00 257.00,206.00 257.00,206.00\r\n             257.00,206.00 258.00,206.00 258.00,206.00 Z\r\n           M 356.00,215.00\r\n           C 367.15,214.49 367.30,212.12 372.41,211.83\r\n             381.47,211.31 390.11,216.34 399.00,214.00\r\n             399.00,214.00 399.00,212.00 399.00,212.00\r\n             388.13,208.86 363.23,203.24 356.00,215.00 Z\r\n           M 374.00,209.00\r\n           C 374.00,209.00 373.00,210.00 373.00,210.00\r\n             373.00,210.00 373.00,209.00 373.00,209.00\r\n             373.00,209.00 374.00,209.00 374.00,209.00 Z\r\n           M 164.45,222.00\r\n           C 160.44,229.05 152.18,244.49 151.00,252.00\r\n             156.07,249.38 157.74,245.74 160.60,241.00\r\n             165.23,233.32 173.51,220.81 174.00,212.00\r\n             167.82,213.86 167.40,216.79 164.45,222.00 Z\r\n           M 214.00,235.53\r\n           C 198.80,233.17 184.02,246.63 185.18,262.00\r\n             185.93,271.96 191.11,279.94 196.34,288.00\r\n             196.34,288.00 217.00,319.00 217.00,319.00\r\n             217.00,319.00 239.17,309.27 239.17,309.27\r\n             239.17,309.27 249.00,305.67 249.00,305.67\r\n             259.95,301.01 265.56,296.91 275.00,290.00\r\n             276.08,285.56 281.98,278.38 279.19,267.99\r\n             276.17,256.73 265.08,247.09 253.00,248.84\r\n             249.83,249.30 247.13,249.53 245.00,252.00\r\n             245.00,252.00 235.00,256.00 235.00,256.00\r\n             232.47,244.93 225.56,237.32 214.00,235.53 Z\r\n           M 322.00,254.00\r\n           C 321.42,259.72 318.66,261.81 320.00,274.00\r\n             325.93,270.15 326.00,260.39 326.00,254.00\r\n             326.00,254.00 322.00,254.00 322.00,254.00 Z\r\n           M 5.00,261.00\r\n           C 5.00,261.00 4.00,262.00 4.00,262.00\r\n             4.00,262.00 4.00,261.00 4.00,261.00\r\n             4.00,261.00 5.00,261.00 5.00,261.00 Z\r\n           M 23.00,271.00\r\n           C 23.00,271.00 22.00,272.00 22.00,272.00\r\n             22.00,272.00 22.00,271.00 22.00,271.00\r\n             22.00,271.00 23.00,271.00 23.00,271.00 Z\r\n           M 31.00,275.00\r\n           C 31.00,275.00 30.00,276.00 30.00,276.00\r\n             30.00,276.00 30.00,275.00 30.00,275.00\r\n             30.00,275.00 31.00,275.00 31.00,275.00 Z\r\n           M 244.00,279.00\r\n           C 244.00,279.00 243.00,280.00 243.00,280.00\r\n             243.00,280.00 243.00,279.00 243.00,279.00\r\n             243.00,279.00 244.00,279.00 244.00,279.00 Z\r\n           M 81.00,305.00\r\n           C 81.00,305.00 80.00,306.00 80.00,306.00\r\n             80.00,306.00 80.00,305.00 80.00,305.00\r\n             80.00,305.00 81.00,305.00 81.00,305.00 Z\r\n           M 289.00,312.00\r\n           C 289.00,312.00 288.00,313.00 288.00,313.00\r\n             288.00,313.00 288.00,312.00 288.00,312.00\r\n             288.00,312.00 289.00,312.00 289.00,312.00 Z\r\n           M 89.00,327.00\r\n           C 89.00,327.00 88.00,328.00 88.00,328.00\r\n             88.00,328.00 88.00,327.00 88.00,327.00\r\n             88.00,327.00 89.00,327.00 89.00,327.00 Z"> </svg> <!-- <svg version="1.1" id="Layer_1" x="0px" y="0px" width="100%" height="100%"\r\n        style="text-align: center; stroke-width: 1px; stroke: white; fill:#121418; display:block;">\r\n         <path id="template" d="M 399.89285,586.94915 C 398.74862,586.26689 398.12501,584.6248 398.09132,582.20538 L 398.03979,578.50507 L 396.48437,582.25507 C 393.70196,588.96321 387.79599,586.18918 388.27503,578.39916 C 388.42145,576.01819 388.22661,573.75549 387.84205,573.37093 C 387.45749,572.98638 387.13596,574.65924 387.12754,577.0884 C 387.11912,579.51757 386.71742,582.12848 386.23487,582.89042 C 385.10546,584.67376 380.79747,583.65969 378.11741,580.97963 C 377.0314,579.89362 375.2205,579.00507 374.09319,579.00507 C 370.92421,579.00507 367.00651,576.60057 362.85254,572.10608 C 360.76788,569.85053 358.21304,568.00507 357.17512,568.00507 C 354.72099,568.00507 351.17488,563.45735 351.02685,560.12021 C 350.9517,558.42601 350.7498,558.12134 350.45352,559.25507 C 349.57747,562.6074 346.29553,561.2858 345.17651,557.13007 C 344.31192,553.91924 343.69714,553.25507 341.58961,553.25507 C 338.98191,553.25507 337.84596,552.19598 333.66057,545.86254 C 332.33665,543.85915 329.87856,541.24101 328.19815,540.04445 C 326.16461,538.59644 325.14285,537.01982 325.14285,535.32999 C 325.14285,533.48553 324.73311,532.94832 323.64484,533.36593 C 322.74182,533.71245 321.54469,533.02179 320.63082,531.62705 C 319.79701,530.3545 317.94361,528.77969 316.51216,528.12748 C 312.98971,526.52254 305.21632,519.79197 305.17564,518.31177 C 305.15761,517.65546 306.07848,516.46313 307.22204,515.66216 C 309.01131,514.4089 309.67362,514.40013 311.97204,515.59929 C 313.44098,516.36569 315.20535,516.99552 315.89285,516.99891 C 316.58035,517.0023 317.14285,517.45507 317.14285,518.00507 C 317.14285,518.55507 318.04285,519.00507 319.14285,519.00507 C 320.24285,519.00507 321.99785,519.86007 323.04285,520.90507 C 324.41409,522.27631 325.24619,522.50173 326.03284,521.71508 C 326.81949,520.92843 328.13336,521.10699 330.75399,522.35668 C 334.28116,524.03867 334.36636,524.2088 333.72856,528.29667 L 333.07196,532.50507 L 335.64346,528.75507 C 337.90317,525.45974 338.70721,525.00507 342.27499,525.00507 C 344.50802,525.00507 348.81178,524.28506 351.83892,523.40505 C 358.45518,521.48165 360.94731,522.6894 357.05293,525.93188 C 355.04728,527.6018 354.93651,527.94411 356.39285,527.9718 C 357.35535,527.9901 358.14285,527.59909 358.14285,527.1029 C 358.14285,525.82683 363.81733,524.00507 367.79207,524.00507 C 370.24334,524.00507 371.14285,524.44935 371.14285,525.66006 C 371.14285,527.20004 371.26993,527.20004 372.97159,525.66006 C 375.00325,523.82143 380.77782,523.40999 381.32935,525.06457 C 381.52359,525.6473 383.69859,526.15158 386.16268,526.18519 C 391.7396,526.26127 395.14285,527.49851 395.14285,529.4499 C 395.14285,530.27179 394.24285,532.54661 393.14285,534.50507 C 391.05023,538.23081 390.5551,541.00507 391.98279,541.00507 C 392.44476,541.00507 393.41486,539.21089 394.13858,537.018 C 395.65942,532.4098 399.09536,529.74909 402.95054,530.19421 C 405.07224,530.43919 405.62263,531.01347 405.54746,532.90387 C 405.45796,535.15456 405.53515,535.18905 406.79765,533.46248 C 407.53772,532.45037 408.76251,531.5314 409.5194,531.42031 C 410.27629,531.30922 411.77602,530.93888 412.85214,530.59734 C 415.58121,529.73116 417.14285,533.56661 417.14285,541.13546 C 417.14285,545.53299 417.4822,547.05202 418.39285,546.73077 C 419.08035,546.48825 419.54119,545.43825 419.41694,544.39744 C 419.29269,543.35664 418.89323,540.14257 418.52926,537.25507 L 417.86749,532.00507 L 421.92762,532.00507 C 426.208,532.00507 426.32526,532.1557 428.544,540.50507 C 429.01834,542.29005 428.6703,537.8156 427.92295,532.5206 C 427.52053,529.66953 434.29971,527.94218 436.87425,530.23978 C 438.4476,531.64389 438.79538,531.65196 440.02446,530.31293 C 440.92232,529.33474 442.39081,529.00466 444.21855,529.37021 C 446.42448,529.8114 447.16547,529.50918 447.65433,527.96889 C 448.37772,525.68971 449.22153,525.51326 451.06785,527.25507 C 452.12785,528.25507 452.48452,528.25507 452.85118,527.25507 C 453.35336,525.88549 456.14285,525.51166 456.14285,526.81394 C 456.14285,527.25882 456.83963,528.49632 457.69126,529.56394 C 459.09009,531.31756 459.09078,531.19724 457.69834,528.31842 C 455.5155,523.80548 456.48838,522.25851 461.77374,521.83815 C 465.11687,521.57226 466.67091,521.93109 467.85823,523.24306 C 469.89619,525.49498 471.31371,525.50051 470.93669,523.25507 C 470.57204,521.08337 475.943,520.29256 479.204,522.0378 C 480.76144,522.87131 481.66002,522.8879 482.45021,522.09771 C 483.86931,520.67861 488.42884,520.69106 489.85572,522.11794 C 490.50882,522.77104 491.521,522.88194 492.30572,522.38636 C 494.50645,520.99651 499.45967,521.11852 502.39285,522.63482 C 504.54744,523.74863 505.14603,523.78023 505.15753,522.78075 C 505.17477,521.28231 516.4245,516.72168 518.92712,517.19856 C 522.27286,517.83611 521.51335,521.8115 517.2904,525.76535 C 509.5422,533.01982 506.87644,534.41005 505.80513,531.75507 C 505.52772,531.06757 505.25833,531.63007 505.20648,533.00507 C 505.15464,534.38007 504.78162,535.97886 504.37754,536.55793 C 502.982,538.55784 496.44915,543.00507 494.90687,543.00507 C 494.05591,543.00507 493.07874,544.12438 492.73538,545.49242 C 492.39202,546.86046 490.88089,548.77296 489.3773,549.74242 C 487.87372,550.71188 483.77348,554.33519 480.26566,557.79422 C 476.75785,561.25325 473.65017,563.84572 473.35971,563.55526 C 473.06925,563.2648 472.50338,561.33469 472.10223,559.26611 L 471.37285,555.50507 L 471.25785,560.03637 C 471.153,564.16776 470.63281,565.07239 465.36385,570.28637 C 462.1854,573.43166 459.2604,576.00507 458.86385,576.00507 C 458.4673,576.00507 458.09867,574.76757 458.04467,573.25507 C 457.9625,570.95336 457.75874,571.18362 456.79467,574.66761 C 454.8959,581.52953 449.63961,585.62068 448.46976,581.14717 C 448.04042,579.50536 447.56506,579.68431 444.38266,582.68569 C 439.02249,587.74098 437.75238,586.92605 437.07301,577.99565 L 436.50317,570.50507 L 436.32301,577.03256 C 436.08941,585.49637 434.42744,588.00507 429.05392,588.00507 C 425.93589,588.00507 424.91181,587.55473 424.30603,585.91716 C 423.61148,584.03961 423.40088,583.98923 422.21581,585.41716 C 421.43552,586.35736 419.34966,587.00507 417.10219,587.00507 C 411.27514,587.00507 410.15532,586.23487 410.04049,582.14808 L 409.93813,578.50507 L 409.14784,581.84772 C 408.71318,583.68618 407.97174,585.56683 407.5002,586.02696 C 405.98591,587.50457 401.69644,588.02456 399.89285,586.94915 z M 425.14285,574.50507 C 425.14285,570.17174 424.72063,567.00507 424.14285,567.00507 C 423.06395,567.00507 422.74745,577.81109 423.74984,580.42328 C 424.8553,583.30407 425.14285,582.08242 425.14285,574.50507 z M 372.60015,560.93597 C 371.74291,559.54893 371.14285,559.80756 371.14285,561.56409 C 371.14285,562.42155 371.60019,562.84045 372.15916,562.49499 C 372.71813,562.14953 372.91658,561.44797 372.60015,560.93597 z M 441.96529,537.35895 C 438.95321,531.32128 438.3872,534.07198 441.30847,540.55102 C 442.77956,543.81374 443.66942,544.90918 443.91494,543.75965 C 444.11998,542.79967 443.24263,539.91935 441.96529,537.35895 z M 407.79308,512.57267 C 406.43086,511.10281 404.31784,510.00507 402.85076,510.00507 C 398.70275,510.00507 396.17092,505.80811 395.98281,498.62021 C 395.89058,495.09579 395.6703,493.98787 395.46287,496.00507 C 394.60038,504.39261 392.81469,506.23005 389.76178,501.87141 C 388.42104,499.95723 388.1101,499.89496 386.73895,501.26611 C 385.37968,502.62538 384.73662,502.63106 380.92672,501.31746 C 377.58912,500.16671 375.8441,500.07952 373.02683,500.92276 C 367.32866,502.62828 366.39691,502.31472 365.0996,498.25507 C 363.18097,492.25113 362.21196,492.27456 362.83485,498.30982 C 363.39317,503.71934 363.32644,503.92089 360.76432,504.56394 C 357.57545,505.3643 355.14285,503.63761 355.14285,500.57375 C 355.14285,499.37122 354.56577,497.59812 353.86045,496.63354 C 352.75267,495.11857 352.62937,495.41789 352.95492,498.83163 C 353.57557,505.33975 349.84751,509.30973 346.37563,505.83785 C 345.48601,504.94823 345.05626,505.06714 344.56864,506.33785 C 343.54679,509.00077 341.6618,508.2892 339.05123,504.25507 C 336.20328,499.85412 334.64285,500.1196 334.64285,505.00507 L 334.64285,508.50507 L 329.43309,508.80593 C 325.1029,509.056 324.01131,508.76731 322.96756,507.096 C 321.81058,505.24338 321.57289,505.2109 319.94608,506.68314 C 318.63605,507.8687 317.83961,507.99829 316.85997,507.18527 C 315.88234,506.37391 314.03843,506.64243 309.75679,508.21967 C 304.85447,510.02555 303.83619,510.13332 303.06893,508.92748 C 301.99481,507.23939 302.49687,505.62149 305.44769,501.2619 C 307.13506,498.76895 308.36557,498.01716 310.76716,498.0119 C 313.99962,498.00483 321.14285,492.59865 321.14285,490.15931 C 321.14285,488.5535 325.7047,486.78776 330.64285,486.48219 C 333.83654,486.28456 334.70672,485.8125 334.95972,484.14035 C 335.34564,481.58961 339.88175,478.20729 344.0291,477.37782 C 345.77683,477.02828 347.33907,475.96219 347.68065,474.88599 C 348.00898,473.85148 348.9223,473.00507 349.71024,473.00507 C 350.49817,473.00507 351.14285,472.55507 351.14285,472.00507 C 351.14285,469.55509 354.9728,471.27412 356.71278,474.50507 C 358.61212,478.03193 360.17294,479.06646 360.10742,476.75507 C 360.08793,476.06757 359.42887,474.38007 358.64285,473.00507 C 356.4831,469.22699 356.75093,468.59246 361.89285,465.30517 C 369.00085,460.76094 370.84191,459.95236 372.57041,460.61565 C 373.43525,460.94752 374.14285,460.7209 374.14285,460.11206 C 374.14285,458.23253 375.77718,458.88811 376.99231,461.25507 C 378.04484,463.30531 378.0971,463.2227 377.58094,460.3246 C 377.13399,457.81513 377.43577,456.91867 379.01135,456.07545 C 383.90101,453.45858 385.87213,453.15198 388.62487,454.58012 C 392.03388,456.34874 392.14285,456.34641 392.14285,454.50507 C 392.14285,452.79675 394.69439,452.47044 395.67286,454.05363 C 396.1219,454.78018 396.72287,454.76858 397.62985,454.01586 C 401.84181,450.52024 407.36563,452.8129 408.92839,458.70533 C 409.81324,462.04165 409.94875,462.16968 410.0395,459.75507 C 410.16092,456.52434 412.68852,455.99825 413.64285,459.00507 C 413.99198,460.10507 415.1473,461.00507 416.21024,461.00507 C 417.37568,461.00507 418.15168,461.69975 418.16509,462.75507 C 418.18321,464.18149 418.56138,464.04281 420.21026,462.00507 C 421.32288,460.63007 422.66964,458.44548 423.20306,457.15044 C 423.96538,455.29966 424.68695,454.92482 426.57512,455.39872 C 427.89634,455.73032 429.12707,455.5626 429.31009,455.026 C 429.49311,454.4894 431.10535,453.75892 432.89285,453.40272 C 435.71977,452.83938 436.14285,453.02402 436.14285,454.82105 C 436.14285,455.95734 435.69285,457.16515 435.14285,457.50507 C 433.89698,458.27506 433.82928,460.00507 435.04502,460.00507 C 435.54122,460.00507 436.41781,458.65507 436.99301,457.00507 C 438.26063,453.36875 441.79193,452.88223 443.01039,456.17604 C 443.48571,457.46094 444.08456,457.9084 444.47766,457.27236 C 445.34263,455.8728 455.11915,459.01581 455.13302,460.69791 C 455.13843,461.35397 454.1984,463.49147 453.04407,465.44791 C 451.88975,467.40435 451.40942,469.00507 451.97669,469.00507 C 452.54395,469.00507 453.27489,468.16442 453.60099,467.13695 C 453.9271,466.10949 455.07573,464.4708 456.15351,463.49542 C 458.01779,461.80828 458.33277,461.80588 462.62798,463.44624 C 465.88538,464.69025 467.14285,465.72325 467.14285,467.15517 C 467.14285,468.71176 467.59259,468.99711 469.22793,468.47807 C 470.60858,468.03987 472.0444,468.47584 473.47793,469.76854 C 474.66863,470.84227 478.27235,472.9831 481.48618,474.52594 C 484.70001,476.06877 487.84576,478.15774 488.47673,479.16808 C 489.1077,480.17843 490.3257,481.00507 491.1834,481.00507 C 493.22182,481.00507 495.14285,482.97553 495.14285,485.0664 C 495.14285,486.30966 495.78709,486.60457 497.70298,486.23833 C 499.6977,485.85701 500.38601,486.21891 500.81961,487.877 C 501.12569,489.04744 502.04076,490.00507 502.8531,490.00507 C 503.66544,490.00507 504.56673,490.90999 504.85596,492.01601 C 505.14862,493.13513 506.54842,494.30097 508.01234,494.64482 C 509.45912,494.98465 511.76785,496.24777 513.14285,497.45174 C 514.51785,498.65572 516.87099,500.40199 518.37204,501.33235 C 521.50291,503.27287 524.54473,508.51541 523.74659,510.59533 C 522.93969,512.69808 514.21749,512.4894 512.63817,510.32956 C 511.64245,508.96782 509.88954,508.69153 503.27793,508.85421 C 496.70714,509.01589 495.14285,508.77255 495.14285,507.58874 C 495.14285,506.78264 495.59285,505.84499 496.14285,505.50507 C 496.69285,505.16515 497.1407,504.35109 497.13807,503.69605 C 497.13544,503.04101 495.58339,504.19257 493.68906,506.25507 C 490.09732,510.16566 487.51857,510.83263 483.82711,508.80577 C 482.62577,508.14615 480.63035,507.72835 479.39285,507.87733 C 477.6521,508.08689 477.14285,507.64426 477.14285,505.92165 C 477.14285,503.82794 477.03374,503.79384 475.31411,505.35008 C 473.19263,507.26999 469.75023,507.46137 465.29207,505.90724 C 461.51481,504.59048 461.22587,502.22656 464.14285,496.50507 C 466.73115,491.42826 466.66471,491.14993 463.64285,494.41057 C 462.26785,495.89422 461.14285,497.71008 461.14285,498.44581 C 461.14285,501.38783 457.6126,504.01649 452.80095,504.65729 L 447.95905,505.30211 L 448.30095,498.65149 C 448.48899,494.99365 448.39538,492.00182 448.09293,492.00297 C 447.79047,492.00413 446.99541,494.65624 446.32614,497.89656 C 444.91723,504.71782 444.039,505.67823 438.38335,506.5826 L 434.22307,507.24786 L 434.65164,498.37646 C 434.98285,491.52034 434.87324,490.41373 434.16916,493.50507 C 433.66808,495.70507 433.23218,500.00257 433.20048,503.05507 C 433.13542,509.32104 431.83325,511.44493 428.98965,509.92308 C 427.8252,509.29989 427.10503,507.7469 427.04049,505.71989 L 426.93813,502.50507 L 426.17191,505.73002 C 424.96099,510.82671 422.33632,514.17314 419.82965,513.81634 C 417.81954,513.53022 417.62997,512.89909 417.48349,506.00507 C 417.25291,495.15296 417.23537,495.00507 416.17906,495.00507 C 415.64615,495.00507 415.08732,499.36394 414.92906,504.75507 C 414.65813,513.98443 414.5235,514.52203 412.40775,514.82267 C 411.00259,515.02234 409.28906,514.18686 407.79308,512.57267 z M 405.79879,496.73604 C 405.52486,496.05901 405.31742,496.85507 405.3378,498.50507 C 405.35818,500.15507 405.5823,500.70901 405.83584,499.73604 C 406.08938,498.76307 406.07271,497.41307 405.79879,496.73604 z M 350.68397,491.0716 C 350.32144,490.48501 349.54627,490.00507 348.96139,490.00507 C 348.2983,490.00507 348.37416,490.57885 349.16291,491.52924 C 350.53445,493.18184 351.76024,492.81304 350.68397,491.0716 z M 394.74702,461.2759 C 394.41472,460.94361 394.17838,461.53424 394.2218,462.5884 C 394.26978,463.75335 394.50674,463.9903 394.82596,463.19257 C 395.11483,462.4707 395.07931,461.6082 394.74702,461.2759 z"/>\r\n        </svg>\r\n        --> </div> </div>'),
a.put("views/changepwd.html",'<div class="changePwdDialog" ng-controller="ChangePwdCtrl"> <div ng-show="error" class="alert alert-danger">{{error}}</div> <form name="changePwdForm" ng-submit="change()" role="form" autocomplete="off"> <div class="form-group"> <i class="fa fa-key"></i> <input type="password" name="oldPwd" placeholder="aktuelles Passwort" id="oldPwd" class="form-control" ng-model="pwdData.oldPwd" required> <span ng-show="changePwdForm.oldPwd.$dirty && changePwdForm.oldPwd.$error.required" class="help-block">Bitte das aktuelle Passwort eingeben.</span> </div> <div class="form-group"> <i class="fa fa-lock"></i> <input type="password" name="newPwd1" placeholder="neues Passwort" id="newPwd1" ng-pattern="/(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z])/" minlength="8" class="form-control" ng-model="pwdData.newPwd1" required> <span ng-show="changePwdForm.newPwd1.$dirty && (changePwdForm.newPwd1.$error.required || changePwdForm.newPwd1.$error.minlength || changePwdForm.newPwd1.$error.pattern)" class="help-block">Ihr Passwort muss aus mindestens acht Zeichen bestehen und ein Großbuchstaben, eine Zahl und ein Sonderzeichen enthalten.</span> </div> <div class="form-group"> <i class="fa fa-lock"></i> <input type="password" name="newPwd2" placeholder="Passwort wiederholen" id="newPwd2" minlength="8" class="form-control" ng-model="pwdData.newPwd2" required pw-check="newPwd1"> <span ng-show="changePwdForm.newPwd1.$dirty && (changePwdForm.newPwd1.$error.required || changePwdForm.newPwd2.$error.pwmatch)" class="help-block">Passwort ist nicht identisch</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || dataLoading" class="btn btn-danger btn-default">Passwort ändern</button> <img ng-if="dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> </form> </div>'),a.put("views/diagnoseForm.html",'<form ng-submit="diag.submit()" name="diagnoseForm" ng-controller="DiagnoseCtrl as diag" autocomplete="off"> <div class="row"> <div class="form-group col-xs-2 diagnosecode"><label>Code</label> <angucomplete-alt id="code{{::patient.patient_id}}" placeholder="Code" pause="400" input-name="proficiency_number" selected-object="diag.proficiency_number_selected_obj" remote-url="/de/api/index/icd10/contract/{{patient.diagnoseFormData.contract_id}}/patientId/{{::patient.patient_id}}/diagnoseId/{{diag.diagnose_id}}/find?s=" minlength="0" initial-value="diag.initialValue" input-changed="patient.autocompleteCodeChange" description-field="diagnose_text" field-required="diag.requireCode" title-field="diagnose_code" template-url="views/autocom.html" input-class="form-control form-control"> </div> <div class="form-group col-xs-3"><label>Datum</label> <input type="text" tabindex="{{$index}}2" name="proficiency_date" required datepicker ng-model="patient.diagnoseFormData.diagnose_datum" placeholder="Datum" class="form-control"> </div> <div class="form-group col-xs-7"><label>Text</label> <input type="text" name="proficiency_text" tabindex="{{$index}}3" readonly ng-model="diag.proficiency_number_selected_obj.description" placeholder="Diagnosetext" class="form-control"> </div> </div> <div class="row"> <div class="form-group col-xs-6"><label>Unfallkennzeichen</label> <select name="accident_flag" ng-model="patient.diagnoseFormData.accident_flag" class="form-control"> <option value="0">kein</option> <option value="2">Unfall/ -folgen</option> <option value="3">Versorgungsleiden</option> </select> </div> <div class="form-group col-xs-6"><label>Art der Inanspruchnahme</label> <select name="accident_flag" ng-model="patient.diagnoseFormData.utilization" class="form-control"> <option value="0">Direkt</option> <option value="1">Orginalschein (Überweisung)</option> <option value="2">Vertreterschein</option> <option value="3">Notfallschein</option> <option value="4">Zielauftrag</option> <option value="5">Konsiliarauftrag</option> <option value="6">Mit-/Weiterbehandlung</option> <option value="7">Abrechnung Verträge nach §§ 73b,c SGB V</option> <option value="8">Abrechnung Verträge nach § 140a SGB V</option> </select> </div> </div> <div class="row"> <div class="col-xs-6"> <fieldset> <legend>Sicherheit (FK6003)</legend> <div class="radio"> <label> <input type="radio" name="secure" ng-model="patient.diagnoseFormData.secure" value="G" checked> Gesichert </label> </div> <div class="radio"> <label> <input type="radio" name="secure" ng-model="patient.diagnoseFormData.secure" value="A"> Ausgeschlossen </label> </div> <div class="radio"> <label> <input type="radio" name="secure" ng-model="patient.diagnoseFormData.secure" value="V"> Verdacht </label> </div> <div class="radio"> <label> <input type="radio" name="secure" ng-model="patient.diagnoseFormData.secure" value="Z"> Zustand nach </label> </div> </fieldset> </div> <div class="col-xs-6"> <fieldset> <legend>Lokalisation (FK6004)</legend> <div class="radio"> <label> <input type="radio" name="locale" ng-model="patient.diagnoseFormData.locale" value="" checked> Unbestimmt </label> </div> <div class="radio"> <label> <input type="radio" name="locale" ng-model="patient.diagnoseFormData.locale" value="L"> Links </label> </div> <div class="radio"> <label> <input type="radio" name="locale" ng-model="patient.diagnoseFormData.locale" value="R"> Rechts </label> </div> <div class="radio"> <label> <input type="radio" name="locale" ng-model="patient.diagnoseFormData.locale" value="B"> Beidseitig </label> </div> </fieldset> </div> </div> <div class="row"> <div class="col-xs-6"> <fieldset> <legend>Erläuterungen (FK6006)</legend> <textarea style="width:100%" ng-model="patient.diagnoseFormData.commentary"></textarea> </fieldset> </div> <div class="col-xs-6"> <fieldset> <legend>Ausnahmebestand (FK6008)</legend> <textarea style="width:100%" ng-model="patient.diagnoseFormData.exclusion_portfolio"></textarea> </fieldset> </div> </div> <div style="height:30px"> <div class="pull-right"> <button type="submit" style="padding:6px 12px" class="btn btn-primary">Speichern</button> </div> </div> </form>'),a.put("views/document.html",'<div class="row"> <div class="col-md-6" ng-repeat="cat in documentCat"> <table class="table documentTable"> <tr> <th colspan="2"> {{cat.category}} </th> </tr> <tr ng-repeat="doc in documents[cat.category_id]"> <td colspan="1"> <get-invoice-form url="/de/api/index/doc" quartal="" buttonclass="download{{doc.type | uppercase}}" lfdnr="doc.document_id" category="doc.category"></get-invoice-form> </td> <td colspan="1" align="left"> {{doc.display_name}} </td> </tr> </table> </div> </div>'),a.put("views/errorData.html",'<div ng-init="init()"> <h3 ng-if="!errorData.length">Keine fehlerhaften Leistungen vorhanden</h3> <table ng-if="errorData.length" class="table table-striped" st-table="saveData" st-safe-src="errorData"> <thead> <tr> <th st-sort="error_code">Fehler-Code</th> <th st-sort="activity_code">Leistung-Code</th> <th st-sort="legend">Fehler-Text</th> <th st-sort="lastname">Patient</th> <th st-sort="action">Benutzer-Aktion</th> </tr> <tr> <th colspan="5"> <input st-search placeholder="Suche..." class="input-sm form-control" type="search"> </th> </tr> </thead> <tbody> <tr ng-repeat="data in saveData | filter:{active:\'j\'}"> <!--<td><button class="btn btn-primary" ng-click="editData(data)"><i class="glyphicon glyphicon-pencil"></i></button></td>--> <td>{{data.error_code}}</td> <td>{{data.activity_code}}</td> <td>{{data.errorDetails.legend}}</td> <td>{{data.firstname}} {{data.lastname}}</td> <td> <div ng-switch="data.errorDetails.action"> <button ng-switch-when="goToPatient" class="btn btn-primary" ng-click="goToPatient(data)">Patient bearbeiten</button> <button ng-switch-when="goToAcivity" class="btn btn-primary" ng-click="goToAcivity(data)">Leistung bearbeiten</button> <button ng-switch-when="goToDiag" class="btn btn-primary" ng-click="goToDiag(data)">Diagnose bearbeiten</button> <button ng-switch-when="goToStamm" class="btn btn-primary" ng-click="goToStamm(data)">Stammdaten bearbeiten</button> <button ng-switch-default class="btn btn-primary" ng-click="setErrorSuccess(data, $index)">Datensatz freigeben</button> </div> </td> </tr> </tbody> <tfoot> <tr> <td colspan="5" class="text-center"> <div st-pagination="" st-items-by-page="itemsByPage" st-displayed-pages="7"></div> </td> </tr> </tfoot> </table> </div>'),a.put("views/forgetPassword.html",'<div class="popupContainer" ng-hide="success"> <h4>Passwort vergessen</h4> <div ng-show="error" class="alert alert-danger">{{error}}</div> <form name="form" ng-submit="submit()" role="form" autocomplete="off"> <div class="form-group"> <i class="fa fa-key"></i> <input type="text" name="doctor_number" placeholder="LANR 9-stellig" class="form-control" minlength="9" maxlength="9" valid-number ng-model="formData.doctor_number" required> <span ng-show="form.doctor_number.$dirty && form.doctor_number.$error.required" class="help-block">LANR ist Pflicht</span> </div> <div class="form-group"> <i class="fa fa-key"></i> <input type="text" name="business_number" placeholder="BSNR 9-stellig" valid-number minlength="9" maxlength="9" class="form-control" ng-model="formData.business_number" required> <span ng-show="form.business_number.$dirty && form.business_number.$error.required" class="help-block">BSNR ist Pflicht</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || dataLoading" class="btn btn-danger btn-default btn-block">Passwort anfordern</button> <img ng-if="dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> </form> </div> <div class="popupContainer" ng-show="success"> <h4>"Vielen Dank für Ihre Anfrage!</h4> <p>Wir werden Ihnen in Kürze ein neues Kennwort an die hinterlegte E-Mail-Adresse senden.</p> <p>Falls Sie Fragen haben, melden Sie sich gern bei uns:</p> <p> Sanakey Contract GmbH<br> Kantstraße 44/45<br> 10625 Berlin<br></p> <p><a href="tel:030310078903"> 030 - 3100 78 903</a><br> <a href="mailto:abrechnung@sanakey-contract.de">abrechnung@sanakey-contract.de</a><br></p> </div>'),a.put("views/goae-login.html",'<div class="login-container"> <h3>GOÄ Login</h3> <form name="form" ng-submit="login()" role="form" autocomplete="off"> <div class="form-group"> <i class="fa fa-key"></i> <input type="text" name="username" placeholder="Benutzername" id="username" class="form-control" ng-model="username" required> <span ng-show="form.username.$dirty && form.username.$error.required" class="help-block">Benutzername ist pflicht</span> </div> <div class="form-group"> <i class="fa fa-lock"></i> <input type="password" name="password" placeholder="Passwort" id="password" class="form-control" ng-model="password" required> <span ng-show="form.password.$dirty && form.password.$error.required" class="help-block">Passwort ist pflicht</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || dataLoading" class="btn btn-danger btn-default">Login</button> <img ng-if="dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> </form> </div>'),a.put("views/googleAuthQRCode.html",'<div> <h3 class="text-center">Google Authenticator installieren</h3> <div class="row"> <div class="col-xs-6"> <div class="logo-android"></div> <ol> <li><small>Rufen Sie Google Play auf.</small></li> <li><small>Suchen Sie nach<br><strong>Google Authenticator</strong>.</small></li> <li><small>Laden Sie die App herunter und installieren Sie sie.</small></li> </ol> </div> <div class="col-xs-6"> <div class="logo-apple"></div> <ol> <li><small>Rufen Sie den App Store auf.</small></li> <li><small>Suchen Sie nach<br><strong>Google Authenticator</strong>.</small></li> <li><small>Laden Sie die App herunter und installieren Sie sie.</small></li> </ol> </div> </div> <div class="row"> <div class="col-xs-12 text-center"> <img src="{{googleAuthQRCode}}"><br> <span class="googleCode">{{googleAuthCode}}</span> </div> </div> <div class="row"> <div class="col-xs-12 text-center"> <small>Scanen Sie den QR-Code mit Ihrer APP und tragen sie den Code in das Textfeld ein.</small> </div> </div> </div>'),a.put("views/init.html",'<div align="center"> <div> <a href="/asv/consultancycontract" class="init_button">ASV</a> </div> <div> <a href="/login" class="init_button">Versorgungsverträge</a> </div> <div> <a href="/goae/login" class="init_button">GOÄ</a> </div> <div style="margin-top:30px"> <a class="init_button" ng-href="{{helpLink}}" target="_blank">Hilfe / häufige Fragen</a> </div> </div>'),a.put("views/kontakt.html",'<div class="row"> <div class="col-md-12 contact_logo"></div> </div> <hr> <div class="row"> <div class="col-md-2"><i class="glyphicon glyphicon-home"></i></div> <div class="col-md-10"><p>Kantstr. 44/45<br>10625 Berlin</p></div> </div> <div class="row"> <div class="col-md-2"><i class="glyphicon glyphicon-phone"></i></div> <div class="col-md-10"><p>030/310078903</p></div> </div> <div class="row"> <div class="col-md-2"><i class="glyphicon glyphicon-envelope"></i></div> <div class="col-md-10"><a ng-href="mailto:abrechnung@sanakey-contract.de">abrechnung@sanakey-contract.de</a></div> </div> <div ng-if="main.authUserToken"> <hr> <div class="row"> <div class="col-md-12">Technische-Hotline</div> </div> <div class="row"> <div class="col-md-2"><i class="glyphicon glyphicon-phone"></i></div> <div class="col-md-10"><p>03381/7940591</p></div> </div> </div>'),a.put("views/login.html",'<div class="login-container"> <h3>Versorgungsverträge Login</h3> <div ng-show="error" class="alert alert-danger">{{error}}</div> <form name="form" ng-submit="login()" role="form" autocomplete="off"> <div class="form-group"> <i class="fa fa-key"></i> <input type="email" name="username" placeholder="Benutzername" id="username" class="form-control" ng-model="username" required> <span ng-show="form.username.$dirty && form.username.$error.required" class="help-block">Benutzername ist Pflicht</span> </div> <div class="form-group"> <i class="fa fa-lock"></i> <input type="password" name="password" placeholder="Passwort" id="password" class="form-control" ng-model="password" required> <span ng-show="form.password.$dirty && form.password.$error.required" class="help-block">Passwort ist Pflicht</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || dataLoading" class="btn btn-danger btn-default">Login</button> <img ng-if="dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> <div class="row" style="margin-top:10px"> <div class="col-md-6"> <a href ng-click="openPlain()">Passwort vergessen</a> </div> <div class="col-md-6"> <a ng-href="{{helpLink}}" class="pull-right" target="_blank">Hilfe / häufige Fragen</a> </div> </div> </form></div>'),a.put("views/main.html",'<div class="row container-main" ng-init="main.init()"> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkStammdaten.html\'"></ng-include> </div> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkAddPatient.html\'"></ng-include> </div> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkPatienten.html\'"></ng-include> </div> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkAccounting.html\'"></ng-include> </div> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkErrorData.html\'"></ng-include> </div> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkDocuments.html\'"></ng-include> </div> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkHelp.html\'"></ng-include> </div> <div class="col-sm-3"> <ng-include src="\'views/naviPanel/linkLogout.html\'"></ng-include> </div> </div>'),a.put("views/naviPanel/contactform.html",""),a.put("views/naviPanel/init.html",""),a.put("views/naviPanel/linkAccounting.html",'<a ng-href="/accounting" class="img-thumbnail panel accounting" ng-class="{\'active\': main.path === \'/accounting\'}"> <div> <span class="glyphicon glyphicon-euro" aria-hidden="true"></span> <span class="glyphicon-class title">Abrechnung</span> </div> </a>'),a.put("views/naviPanel/linkAddPatient.html",'<a ng-href="/addpatient" class="img-thumbnail panel" ng-class="{\'active\': main.path === \'/addpatient\'}"> <div> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> <span class="glyphicon-class title">Patient erfassen</span> </div> </a>'),a.put("views/naviPanel/linkDocuments.html",'<a href="/document" class="img-thumbnail panel" ng-class="{\'active\': main.path === \'/document\'}"> <div> <span class="glyphicon glyphicon-file" aria-hidden="true"></span> <span class="glyphicon-class title">Dokumente</span> </div> </a>'),a.put("views/naviPanel/linkErrorData.html",'<a ng-href="/errorData" class="img-thumbnail panel accounting" ng-class="{\'active\': main.path === \'/errorData\'}"> <div> <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> <span class="glyphicon-class title">Fehlerhafte Leistungen</span> </div> </a>'),a.put("views/naviPanel/linkHelp.html",'<a ng-href="{{main.helpLink}}" target="_blank" class="img-thumbnail panel"> <div> <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> <span class="glyphicon-class title">Hilfe</span> </div> </a>'),a.put("views/naviPanel/linkLogout.html",'<a href ng-click="main.logout()" class="img-thumbnail panel"> <div> <span class="glyphicon glyphicon-lock" aria-hidden="true"></span> <span class="glyphicon-class title">Logout</span> </div> </a>'),a.put("views/naviPanel/linkPatienten.html",'<a ng-href="/patient" class="img-thumbnail panel" ng-class="{\'active\': main.path === \'/patient\'}"> <div> <span class="glyphicon diagnose-icon" aria-hidden="true"></span> <span class="glyphicon-class title">Patientenübersicht</span> </div> </a>'),a.put("views/naviPanel/linkStammdaten.html",'<a ng-href="/user" class="img-thumbnail panel" ng-class="{\'active\': main.path === \'/user\'}"> <div> <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <span class="glyphicon-class title">Meine<br>Stammdaten</span> </div> </a>'),a.put("views/naviPanel/naviPanel.html",'<div class="container" style="width:60%"> <div class="animate-if" ng-if="mainPath !== \'/\' && mainPath !== \'/main\'  && mainPath !== \'/login\' && mainPath !== \'/rsa-login\' && mainPath.indexOf(\'/asv/\') === -1 && mainPath.indexOf(\'/goae/\') === -1"> <a ng-href="{{::link.href}}" ng-click="link.func()" ng-class="{\'active\': mainPath === link.href}" title="{{link.title}}" class="img-thumbnail panel" tooltip="" tooltip-placement="bottom" ng-repeat="link in linkPanel.portal"> <div ng-if="link.href !== \'/patient\'"> <span class="glyphicon {{::link.icon}}" aria-hidden="true"></span> <span class="glyphicon-class title" ng-bind-html="link.title"></span> </div> <div ng-if="link.href === \'/patient\'"> <span class="glyphicon {{::link.icon}}" aria-hidden="true">&nbsp;</span> <span class="glyphicon-class title" ng-bind-html="link.title"></span> </div> </a> </div> <div class="animate-if" ng-if="mainPath !== \'/\' && mainPath !== \'/main\'  && mainPath !== \'/asv/login\' && mainPath !== \'/asv/consultancycontract\' && mainPath !== \'/asv/test-registry\' && mainPath !== \'/asv/contactform\' && mainPath !== \'/asv/rsa-login\' && mainPath.indexOf(\'/asv/\') !== -1 && mainPath.indexOf(\'/goae/\') === -1"> <a ng-href="{{::link.href}}" ng-click="link.func()" tooltip="" title="{{link.title}}" tooltip-placement="bottom" class="img-thumbnail panel" ng-class="{\'active\': mainPath === link.href}" ng-repeat="link in linkPanel.asv"> <div> <span class="glyphicon {{::link.icon}}" aria-hidden="true"></span> <span class="glyphicon-class title" ng-bind-html="link.title"></span> </div> </a> </div> <div ng-if="mainPath === link.href" ng-repeat="link in linkPanel.portal"><h4>{{link.headerTitle}}</h4></div> <div ng-if="mainPath === link.href" ng-repeat="link in linkPanel.asv"><h4>{{link.headerTitle}}</h4></div> </div>'),a.put("views/patient.html",'<div ng-init="patCtrl.init()"> <div class="row"> <div class="col-sm-12" id="patienten"> <div class="row patienten active" ng-repeat="patient in patCtrl.patienten | filter:{active:\'j\'} | filter:patCtrl.rootData.searchText"> <div class="col-md-12 animate"> <div class="thumbnail patient-panel" style="box-shadow: 0px 0px 5px"> <div class="caption"> <div class="row"> <div class="col-sm-3 col-md-3"> <h3>{{::patient.lastname}}</h3> <h3>{{::patient.firstname}}</h3> </div> <div class="col-sm-3 col-md-3"> <div><strong>Info</strong></div> <div>Geb.: {{::patient.date_of_birth | amParse:\'YYYY-MM-DD\' | amDateFormat:\'DD.MM.YYYY\'}}</div> <div>{{::patient.institution_short}}: {{::patient.institution_number}}</div> </div> <div class="col-sm-3 col-md-3"> <div><strong>Anschrift</strong>&nbsp;<a ng-href="#" class="btn pull-right btn-default verlauf" role="button" style="visibility: hidden" my-popover popover-class="popover-timeline" popover-title="<small>Verlauf</small><br>{{::patient.firstname}} {{::patient.lastname}}" popover-placement="right" popover-trigger="click" popover-template="views/patientTimeline.html">Verlauf</a></div> <div class="truncate">{{::patient.street}} {{::patient.number}}</div> <div class="truncate">{{::patient.zip}} {{::patient.city}}</div> </div> <div class="col-sm-3 col-md-3 text-right"> <folderline is-open="patient.isOpen" row-class="folderToogle"></folderline> <button tooltip title="Patient bearbeiten" ng-click="patCtrl.editPatient(patient.patient_id)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-pencil"></i></button>&nbsp;<button tooltip title="Patient löschen" ng-click="patCtrl.removePatient(patient)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-trash"></i></button> </div> </div> <div class="row"> <div class="col-sm-12 col-md-12 animate-slide-down" ng-if="patient.isOpen"> <p></p> <div> <select name="contract" class="form-control" ng-model="patient.diagnoseFormData.contract_id"> <option value="0" ng-if="patCtrl.contractData.length > 1" selected>Bitte einen Vertrag wählen</option> <option ng-repeat="contract in patCtrl.contractData | filter:{institution_number:patient.institution_number}" value="{{::contract.contract_id}}">Vertrag: {{::contract.contract_desc}}</option> </select> <p></p> </div> <tabs tabs-class="nav nav-tabs nav-justified"> <pane title="Diagnosen erfassen"> <div ng-if="patient.diagnoseFormData.contract_id === \'0\'"> <p></p> <div class="alert alert-warning" role="alert">Bitte wählen Sie oben einen Vertrag aus</div> <p></p> </div> <div ng-include="\'views/diagnoseForm.html\'" ng-if="patient.diagnoseFormData.contract_id !== \'0\'"></div> </pane> <pane title="Leistungen erfassen"> <div ng-if="patient.diagnose.length === 0"> <p></p> <div class="alert alert-warning" role="alert">Bitte erfassen Sie eine Diagnose</div> <p></p> </div> <div ng-if="patient.diagnoseFormData.contract_id === \'0\' && patient.diagnose.length > 0"> <p></p> <div class="alert alert-warning" role="alert">Bitte wählen Sie oben einen Vertrag aus</div> <p></p> </div> <div ng-if="patient.diagnose.length > 0 && patient.diagnoseFormData.contract_id !== \'0\'" ng-include="\'views/activityDataForm.html\'"></div> </pane> </tabs> </div> </div> </div> </div> </div> </div> </div> <div class="col-sm-0 animate" id="verlauf"></div> </div> </div>'),a.put("views/patientTimeline.html",'<div ng-controller="TimelineCtrl"> <div ng-if="!patient.diagnose.length && !patient.activity.length">Keine Daten erfasst</div> <div class="row" style="border-bottom:2px solid #ddd"> <div class="col-xs-12" style="padding: 7px 15px"><strong>Diagnosen</strong></div> </div> <div class="row" style="padding: 8px 0px;border-bottom:1px solid #ddd" ng-repeat="diag in patient.diagnose | filter:{active:\'j\'}"> <div class="col-xs-4" style="white-space: nowrap">{{diag.diagnose_code}}<br><button ng-click="change_diagnose(diag)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-pencil"></i></button>&nbsp;<button ng-click="removeDiagnose(diag, $index)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-trash"></i></button></div> <div class="col-xs-4">{{diag.diagnose_text}}</div> <div class="col-xs-4">{{diag.diagnose_datum | date:\'dd.MM.yy\'}}</div> </div> <!--\n    <table class="table table-hover" ng-if="patient.diagnose.length">\n        <thead>\n            <tr>\n                <th colspan="3">Diagnosen</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr ng-repeat="diag in patient.diagnose | filter:{active:\'j\'}">\n                <td style="white-space:nowrap;">{{diag.diagnose_code}}<br><button ng-click="change_diagnose(diag)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-pencil"></i></button>&nbsp;<button ng-click="removeDiagnose(diag, $index)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-trash"></i></button></td>\n                <td>{{diag.diagnose_text}}</td>\n                <td>{{diag.diagnose_datum | date:\'dd.MM.yy\'}}</td>\n            </tr>\n        </tbody>\n    </table>\n    --> <div class="row" style="border-bottom:2px solid #ddd"> <div class="col-xs-12" style="padding: 7px 15px"><strong>Leistungen</strong></div> </div> <div class="row" style="padding: 8px 0px;border-bottom:1px solid #ddd" ng-repeat="act in patient.activity | filter:{active:\'j\'}"> <div class="col-xs-4" style="white-space: nowrap">{{act.activity_code}}<br><span ng-if="act.status === \'C\' || act.status === \'E\'"><button ng-click="change_activity(act)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-pencil"></i></button>&nbsp;<button ng-click="removeActivity(act, $index)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-trash"></i></button></span></div> <div class="col-xs-4">{{act.activity_text}}</div> <div class="col-xs-4">{{act.activity_date | date:\'dd.MM.yy\'}}</div> </div> <!--\n    <table class="table table-hover" ng-if="patient.activity.length">\n        <thead>\n            <tr>\n                <th colspan="3">Leistungen</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr ng-repeat="act in patient.activity | filter:{active:\'j\'}">\n                <td style="white-space:nowrap;">{{act.activity_code}}<br><span ng-if="act.status === \'C\' || act.status === \'E\'"><button ng-click="change_activity(act)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-pencil"></i></button>&nbsp;<button ng-click="removeActivity(act, $index)" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-trash"></i></button></span></td>\n                <td>{{act.activity_text}}</td>\n                <td>{{act.activity_date | date:\'dd.MM.yy\'}}</td>\n            </tr>\n        </tbody>\n    </table>\n    --> </div>'),a.put("views/patientform.html",'<!-- <form ng-submit="patientForm.submit()" ng-controller="PatientformCtrl" ng-init="patientForm.init()" novalidate> --> <form ng-submit="patientForm.submit()" ng-controller="PatientformCtrl" ng-init="patientForm.init()" name="pForm" autocomplete="off"> <fieldset> <legend ng-if="patientForm.patientId">Patienten-Daten bearbeiten</legend> <legend ng-if="!patientForm.patientId">Neuanlage eines Patienten</legend> <div class="error-container bg-danger text-danger" ng-show="!pForm.$valid && submitStart"> <ul class="error-container-exactlength"> <li class="error" ng-show="pForm.insured_number.$error.maxlength || pForm.insured_number.$error.minlength"><i class="glyphicon glyphicon glyphicon-remove"></i>Versichertennummer muss 10 Zeichen lang sein.</li> <li class="error" ng-show="pForm.insured_number.$error.insuredNumber"><i class="glyphicon glyphicon glyphicon-remove"></i>Versichertennummer ist nicht korrekt. Bitte Eingabe überprüfen.</li> <li class="error" ng-show="pForm.institution_number.$error.exactlength"><i class="glyphicon glyphicon glyphicon-remove"></i>Institutionskennzeichen muss 9 Zeichen lang sein.</li> <li class="error" ng-show="pForm.cart_livetime.$error.exactlength"><i class="glyphicon glyphicon glyphicon-remove"></i>Gültigkeit der Karte muss 4 Zeichen lang sein.</li> </ul> </div> <div class="row"> <div class="form-group col-sm-3"><label>Vorname</label> <input type="text" required name="firstname" ng-model="patientForm.formData[0].firstname" placeholder="Vorname" class="form-control"> </div> <div class="form-group col-sm-3"><label>Nachname</label><input type="text" required name="lastname" ng-model="patientForm.formData[0].lastname" placeholder="Nachname" class="form-control"></div> <div class="form-group col-sm-3"><label>Geschlecht</label> <select class="form-control" required-select required ng-model="patientForm.formData[0].gender"> <option value="0">Bitte wählen</option> <option value="1">weiblich</option> <option value="2">männlich</option> <option value="3">unbekannt</option> </select> </div> <div class="form-group col-sm-3"><label>Geburtstag</label> <input type="text" datepicker datepicker-options="patientForm.datepickerOptions" required name="date_of_birth" ng-model="patientForm.formData[0].date_of_birth" placeholder="TT.MM.JJJJ" class="form-control"> </div> </div> <div class="row"> <div class="form-group col-sm-3"><label>Versichertennummer</label><input type="text" maxlength="10" minlength="10" valid-alnum required name="insured_number" valid-insured-number ng-model="patientForm.formData[0].insured_number" placeholder="A123456789" class="form-control"></div> <div class="form-group col-sm-3"><label>Versichertenart</label><select required ng-model="patientForm.formData[0].insured_type" class="form-control"> <option value="0">Bitte wählen</option> <option value="1">Mitglied</option> <option value="3">Familienversicherter</option> <option value="5">Rentner</option> </select> </div> <div class="form-group col-sm-3"> <label>Bes. Personengrp.</label> <select ng-model="patientForm.formData[0].person_grp" required class="form-control"> <option value="0">Bitte wählen</option> <option value="4">Sozialhilfeempfänger § 264 SGB V</option> <option value="6">BVG - Opfer des Krieges</option> <option value="7">SVA Abrechnung nach Aufwand</option> <option value="8">SVA Abrechnung pauschal</option> </select> </div> <div class="form-group col-sm-3"> <label>DMP Kennzeichnung</label> <select ng-model="patientForm.formData[0].dpm_flag" class="form-control"> <option value="0">Bitte wählen</option> <option value="1">Diabetes mellitus Typ 2</option> <option value="2">Brustkrebs</option> <option value="3">Koronare Herzkrankheit</option> <option value="4">Diabetes mellitus Typ 1</option> <option value="5">Asthma bronchiale</option> <option value="6">COPD</option> </select> </div> </div> <div class="row"> <div class="form-group col-sm-3"><label>Krankenkasse</label> <select name="institution_number" ng-model="patientForm.formData[0].institution_number" required-select required class="form-control"> <option value="{{::contract.institution_number}}" ng-repeat="contract in patientForm.contractData | unique:\'institution_number\' ">{{::contract.institution_name}}</option> </select> <!--<input type="text" required maxlength="9" exact-length="9" valid-number name="institution_number" ng-model="patientForm.formData[0].institution_number" placeholder="Institutionskennzeichen" class="form-control">--></div> <div class="form-group col-sm-3"><label>Gültigkeit der Karte</label><input type="text" exact-length="4" maxlength="4" valid-number name="cart_livetime" ng-model="patientForm.formData[0].cart_livetime" placeholder="Gültigkeit der Karte JJMM" class="form-control"></div> <div class="form-group col-sm-3"> <label>Zahlungsstatus</label> <select ng-model="patientForm.formData[0].payment_status" required class="form-control"> <option value="0">Bitte wählen</option> <option value="1">zuzahlungspflichtig</option> <option value="2">zuzahlungsbefreit</option> </select> </div> </div> </fieldset> <div class="row"> <div class="col-sm-12"> <fieldset> <legend>Anschrift</legend> <div class="error-container bg-danger text-danger" ng-show="!pForm.$valid && submitStart"> <ul class="error-container-exactlength" ng-show="pForm.$error.exactlength.length>0"> <li class="error" ng-show="pForm.zip.$error.exactlength">Postleizahl muss 5 Zeichen lang sein.</li> </ul> </div> <div class="row"> <div class="col-sm-4"> <div class="form-group"><label>Straße</label><input type="text" name="street" ng-model="patientForm.formData[0].street" placeholder="Straße" class="form-control"></div> </div> <div class="col-sm-2"> <div class="form-group"><label>Hausnummer</label><input type="text" name="number" ng-maxlength="5" ng-model="patientForm.formData[0].number" placeholder="Hausnummer" class="form-control"></div> </div> <div class="col-sm-2"> <div class="form-group"><label>Postleizahl</label><input type="text" name="zip" valid-number ng-change="patientForm.changeZip(patientForm.formData[0].zip)" maxlength="5" exact-length="5" ng-model="patientForm.formData[0].zip" placeholder="Postleitzahl" class="form-control"></div> </div> <div class="col-sm-4"> <div class="form-group" style="position:relative"> <label>Ort</label><input type="text" name="city" disabled ng-model="patientForm.formData[0].city" placeholder="Ort" class="form-control"> <ul class="dropdown-menu" style="display:inline" ng-if="patientForm.responseZip.length > 1"> <li ng-repeat="(key, value) in patientForm.responseZip" class="dropdown-header"><a href ng-click="patientForm.setCity(key)">{{value}}</a></li> </ul> </div> </div> </div> </fieldset> </div> </div> <br><br> <fieldset> <legend>Überweiser</legend> <div class="error-container bg-danger text-danger" ng-show="!pForm.$valid && submitStart"> <ul class="error-container-exactlength" ng-show="pForm.$error.exactlength.length>0"> <li class="error" ng-show="pForm.from_business_number.$error.exactlength">Betriebsstätte BSNR muss 9 Zeichen lang sein.</li> <li class="error" ng-show="pForm.from_doctor_number.$error.exactlength">Arztnummer-LANR muss 9 Zeichen lang sein.</li> <li class="error" ng-show="pForm.from_institution_number.$error.exactlength">Institutionskennzeichen muss 9 Zeichen lang sein.</li> </ul> </div> <div class="row"> <div class="form-group col-sm-4"><label>Betriebsstätte BSNR</label><input type="text" valid-number exact-length="9" maxlength="9" name="from_business_number" ng-model="patientForm.formData[0].from_business_number" placeholder="Betriebsstätte BSNR" class="form-control"></div> <div class="form-group col-sm-4"><label>Arztnummer-LANR</label><input type="text" valid-number exact-length="9" maxlength="9" name="from_doctor_number" ng-model="patientForm.formData[0].from_doctor_number" placeholder="Arztnummer-LANR" class="form-control"></div> <div class="form-group col-sm-4"><label>Institutionskennzeichen</label><input type="text" valid-number exact-length="9" maxlength="9" name="from_institution_number" ng-model="patientForm.formData[0].from_institution_number" placeholder="Institutionskennzeichen" class="form-control"></div> </div> </fieldset> <div class="row formButtonRow"> <div class="col-sm-12"> <hr> <div class="pull-right"> <a ng-if="!patientForm.formData[0].patient_id" ng-href="/main" class="btn btn-default btn-lg"><span><i class="glyphicon glyphicon-remove"></i></span><span>Abbrechen</span></a> <a ng-if="patientForm.formData[0].patient_id" ng-click="patientForm.cleanForm()" class="btn btn-default btn-lg"><span><i class="glyphicon glyphicon-user"></i></span><span>Neuer Patient</span></a> <a ng-if="patientForm.formData[0].patient_id" ng-href="/patient" class="btn btn-default btn-lg"><span><i class="glyphicon glyphicon-remove"></i></span><span>Abbrechen</span></a> <button class="btn btn-primary btn-lg" type="submit"><span><i class="glyphicon glyphicon-ok"></i></span><span>Speichern</span></button> </div> </div> </div> </form>'),
a.put("views/require-stamm.html",'<p>Bitte füllen Sie ihre Stammdaten vollständig aus.</p> <div class="ngdialog-buttons"> <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="closeThisDialog(0)">zu den Stammdaten</button> </div>'),a.put("views/rsa-login.html",'<div class="login-container"> <ng-include ng-if="googleAuthQRCode" src="\'views/googleAuthQRCode.html\'"></ng-include> <div ng-if="!googleAuthQRCode"> <h4 class="text-center">Starten Sie ihre Google Authenticator App und geben Sie den Code ein.</h4> </div> <div ng-show="error" class="alert alert-danger">{{error}}</div> <form name="form" ng-submit="login()" role="form"> <div class="form-group"> <i class="fa fa-lock"></i> <input type="tel" name="rsaKey" placeholder="RSA-Code" id="rsaKey" class="form-control" ng-model="rsaKey" required> <span ng-show="form.rsaKey.$dirty && form.rsaKey.$error.required" class="help-block">Bitte den RSA-Code von ihrem Handy eintragen</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="form.$invalid || dataLoading" class="btn btn-danger btn-default">RSA-Code senden</button> <img ng-if="dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> </form> </div>'),a.put("views/sendDataDialog.html",'<div class="row"> <div class="col-md-12">Bitte wählen Sie den Abrechnungszeitraum</div> <div class="col-md-6"> <div class="form-group"><label>Abrechnungsjahr</label> <select class="form-control" ng-model="accountingCtrl.dafilter.year"> <option value="{{::year}}" ng-repeat="year in years">{{::year}}</option> </select> </div> </div> <div class="col-md-6"> <div class="form-group"><label>Quartal</label> <select class="form-control" ng-model="accountingCtrl.dafilter.quartal"> <option value="1">1. Quartal</option> <option value="2">2. Quartal</option> <option value="3">3. Quartal</option> <option value="4">4. Quartal</option> </select> </div> </div> </div> <div class="row" ng-if="accountingCtrl.dafilter.year && accountingCtrl.dafilter.quartal"> <div class="col-md-12"> <h4 class="text-center"><strong>Hiermit bestätige ich, dass die Abrechnungsdaten korrekt erfasst wurden.</strong></h4> <p>Die entsprechenden Teilnahmeerklärungen wurden fristgerecht an die Krankenkasse(n) geschickt.</p> <p class="text-info alert-info">Andernfalls können die übermittelten Daten nicht korrekt abgerechnet werden.</p> </div> </div> <div class="ngdialog-buttons"> <button type="button" class="btn btn-default pull-right" style="margin-left:10px" ng-click="closeThisDialog(0)">Abbrechen</button> <button type="button" class="btn btn-primary pull-right" ng-disabled="!accountingCtrl.dafilter.year || !accountingCtrl.dafilter.quartal" ng-click="confirm(1)">Bestätigen und jetzt senden</button> </div>'),a.put("views/test-registry-succ.html",'<p>Registrierung erfolgreich gesendet.</p> <p>Danke das sie Sie für den Test der ASV-Abrechnung Registriert haben.</p> <p>Sie erhalten nach Prüfung ihrer Angaben eine EMail mit Ihren Zugangsdaten.</p> <p>Bei fragen senden Sie eine EMail an <a href="mailto:abrechnung@sanakey-contract.de">abrechnung@sanakey-contract.de</a></p> <div class="ngdialog-buttons"> <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="closeThisDialog(0)">zurück zum Login</button> </div>'),a.put("views/user-address.html",'<fieldset> <legend>Anschrift</legend> <div class="error-container bg-danger text-danger" ng-show="!userForm.$valid && submitStart"> <ul class="error-container-exactlength" ng-show="userForm.$error.exactlength.length>0"> <li class="error" ng-show="userForm.zip.$error.exactlength">Postleizahl muss 5 Zeichen lang sein.</li> </ul> </div> <div class="row"> <div class="col-sm-9"> <div class="form-group"><label>Straße</label><input type="text" name="street" required ng-model="user.formData.street" placeholder="Straße" class="form-control"></div> </div> <div class="col-sm-3"> <div class="form-group"><label>Nr.</label><input type="tel" name="number" required ng-model="user.formData.number" placeholder="Hausnummer" class="form-control"></div> </div> </div> <div class="row"> <div class="col-sm-3"> <div class="form-group"><label>Postleitzahl</label><input type="tel" maxlength="5" exact-length="5" valid-number ng-model-options="{ debounce: 500 }" ng-change="user.changeZip(user.formData.zip)" name="zip" required ng-model="user.formData.zip" placeholder="Postleitzahl" class="form-control"> </div> </div> <div class="col-sm-9"> <div class="form-group" style="position:relative"><label>Ort</label><input type="text" name="city" required ng-model="user.formData.city" placeholder="Ort" disabled class="form-control"> <ul class="dropdown-menu" style="display:inline" ng-if="user.responseZip.length > 1"> <li ng-repeat="(key, value) in user.responseZip" class="dropdown-header"><a href ng-click="user.setCity(key)">{{value}}</a></li> </ul> </div> </div> </div> </fieldset>'),a.put("views/user-contact.html",'<fieldset> <legend>Kontakt</legend> <div class="row"> <div class="col-sm-6"> <div class="form-group"><label>Telefon</label><input type="tel" valid-phone name="phone" ng-model="user.formData.phone" placeholder="Telefonnummer" class="form-control"></div> </div> <div class="col-sm-6"> <div class="form-group"><label>Mobil</label><input type="tel" valid-phone name="mobile" ng-model="user.formData.mobile" placeholder="Handynummer" class="form-control"></div> </div> </div> <div class="row"> <div class="col-sm-6"> <div class="form-group"><label>Fax</label><input type="tel" valid-phone name="fax" ng-model="user.formData.fax" placeholder="Faxnummer" class="form-control"></div> </div> <div class="col-sm-6"> <div class="form-group"><label>E-Mail</label><input type="email" name="mail" required ng-model="user.formData.mail" placeholder="E-Mail" class="form-control"></div> </div> </div> </fieldset>'),a.put("views/user-person.html",'<fieldset> <legend>Person</legend> <div class="error-container bg-danger text-danger" ng-show="!userForm.$valid && submitStart"> <ul class="error-container-exactlength" ng-show="userForm.$error.exactlength.length > 0 || userForm.doctor_number.$error.doctorNumber"> <li class="error" ng-show="userForm.doctor_number.$error.exactlength"><i class="glyphicon glyphicon glyphicon-remove"></i>Lebenslange&nbsp;Arztnummer muss 9 Zeichen lang sein.</li> <li class="error" ng-show="userForm.doctor_number.$error.doctorNumber"><i class="glyphicon glyphicon glyphicon-remove"></i>Lebenslange&nbsp;Arztnummer ist nicht gültig.</li> <li class="error" ng-show="userForm.business_number.$error.exactlength"><i class="glyphicon glyphicon glyphicon-remove"></i>Betriebsstättennummer muss 9 Zeichen lang sein.</li> <li class="error" ng-show="userForm.institution_number.$error.exactlength"><i class="glyphicon glyphicon glyphicon-remove"></i>Institutionskennzeichen muss 9 Zeichen lang sein.</li> </ul> </div> <div class="row"> <div class="form-group col-sm-4"> <div class="row"> <div class="col-sm-6"> <label>Anrede</label> <select class="form-control" select-required ng-model="user.formData.title"> <option value="Herr">Herr</option> <option value="Frau">Frau</option> </select> </div> <div class="col-sm-6"> <label>Titel</label> <select class="form-control" ng-model="user.formData.type"> <option value=""></option> <option value="Dr.">Dr.</option> <option value="Prof. Dr.">Prof. Dr.</option> <option value="Dipl.-Med.">Dipl.-Med.</option> </select> </div> </div> </div> <div class="form-group col-sm-4"><label>Vorname</label><input required type="text" tabindex="1" name="firstname" ng-model="user.formData.firstname" placeholder="Vorname" class="form-control"></div> <div class="form-group col-sm-4"><label>Nachname</label><input required type="text" tabindex="2" name="lastname" ng-model="user.formData.lastname" placeholder="Nachname" class="form-control"></div> <div class="form-group col-sm-4"><label>Lebenslange&nbsp;Arztnummer&nbsp;(LANR)</label> <div class="input-group"> <input type="text" tabindex="3" exact-length="9" required minlengh="9" maxlength="9" valid-number valid-lanr name="doctor_number" ng-model="user.formData.doctor_number" placeholder="9-stellig" class="form-control"> <span class="input-group-addon" tooltip title="Wo finde ich meine LANR bzw. BSNR? » Diese finden Sie z.B. auf dem Geschäftsbesorgungsvertrag oder auf der Kooperationsvereinbarung"><i class="glyphicon glyphicon-info-sign"></i></span> </div> </div> <div class="form-group col-sm-4"><label>Betriebsstättennummer&nbsp;(BSNR)</label> <div class="input-group"> <input type="text" required tabindex="4" exact-length="9" minlengh="9" maxlength="9" name="business_number" ng-model="user.formData.business_number" placeholder="9-stellig" class="form-control"> <span class="input-group-addon" tooltip title="Wo finde ich meine LANR bzw. BSNR? » Diese finden Sie z.B. auf dem Geschäftsbesorgungsvertrag oder auf der Kooperationsvereinbarung"><i class="glyphicon glyphicon-info-sign"></i></span> </div> </div> <div class="form-group col-sm-4"><label>Institutionskennzeichen</label><input type="text" tabindex="5" exact-length="9" minlengh="9" maxlength="9" valid-number name="institution_number" ng-model="user.formData.institution_number" placeholder="Institutionskennzeichen" class="form-control"></div> </div> </fieldset>'),a.put("views/user.html",'<form ng-submit="user.submit()" ng-controller="UserCtrl" ng-init="user.init()" name="userForm" autocomplete="off"> <ng-include src="\'views/user-person.html\'"></ng-include> <div class="row"> <div class="col-sm-6"> <ng-include src="\'views/user-address.html\'"></ng-include> </div> <div class="col-sm-6"> <ng-include src="\'views/user-contact.html\'"></ng-include> </div> </div> <div class="row"> <div class="col-sm-12"> <fieldset> <legend>Bankdaten</legend> <div class="error-container bg-danger text-danger" ng-show="!userForm.$valid && submitStart"> <ul class="error-container-exactlength" ng-show="userForm.$error.ngIban.length"> <li class="error">Die eingegebene IBAN ist nicht korrekt.</li> </ul> </div> <div class="row"> <div class="col-sm-4"> <div class="form-group"><label>Kontoinhaber</label><input type="text" required name="account_owner" ng-model="user.formData.account_owner" placeholder="Vor- & Nachname" class="form-control"></div> </div> <div class="col-sm-4"> <div class="form-group"><label>IBAN</label><input type="text" name="iban" required maxlength="34" ng-model="user.formData.iban" ng-iban placeholder="IBAN" class="form-control"></div> </div> <div class="col-sm-4"> <div class="form-group"><label>BIC</label><input type="text" name="bic" ng-model="user.formData.bic" placeholder="BIC" class="form-control"></div> </div> </div> </fieldset> </div> <div class="col-sm-12" ng-if="!user.loginModul || user.loginModul === 1"> <fieldset> <legend>ASV-Splitter Einstellungen</legend> <div class="col-sm-4"> <div class="form-group"><label>Datenversand</label> <select ng-model="user.formData.asv_live" class="form-control"> <option value="y">Echt-Datenversand</option> <option value="n">Test-Datenversand</option> </select> </div> </div> <div class="col-sm-4"> <div class="form-group"><label>ASV-Team</label><select class="form-control" ng-model="user.formData.asv_role"> <option value="1">Teamleiter</option> <option value="2">Mitglied Kernteam</option> <option value="3">Hinzugezogene(r)</option> </select></div> </div> <div class="col-sm-4"> <div class="form-group"><label>ASV-Erkrankung-Type</label><select class="form-control" ng-model="user.formData.asv_type"> <option value="1A0100">1A0100</option> <option value="1A0200">1A0200</option> <option value="1A0201">1A0201</option> <option value="1A0201">1A0202</option> <option value="1A0201">2A0100</option> <option value="1A0201">2K0100</option> <option value="2L0100">2L0100</option> </select></div> </div> </fieldset> </div> </div> <div class="row formButtonRow"> <div class="col-sm-12"> <hr> <div class="pull-right"> <a ng-href="#" class="btn btn-info" style="padding: 10px 16px" ng-click="user.showGoogleAuth()">Google Code anzeigen</a> <a ng-href="#" class="btn btn-info" style="padding: 10px 16px" ng-click="user.changePWD()">Passwort ändern</a> <a ng-href="/main" class="btn btn-default btn-lg"><span><i class="glyphicon glyphicon-remove"></i></span><span>Abbrechen</span></a> <button class="btn btn-primary btn-lg" type="submit"><span><i class="glyphicon glyphicon-ok"></i></span><span>Speichern</span></button> </div> </div> </div> </form>')}]);